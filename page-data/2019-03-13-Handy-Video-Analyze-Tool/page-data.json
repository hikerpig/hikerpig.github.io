{"componentChunkName":"component---src-templates-page-js","path":"/2019-03-13-Handy-Video-Analyze-Tool/","result":{"data":{"site":{"siteMetadata":{"title":"HP goes FE","author":"@hikerpig"}},"markdownRemark":{"id":"56efbcfd-fa1a-59da-8b4a-07c5e7c995cc","html":"<p>最近在写一些跟视频解码相关的简单程序，学习 avcodec 技术时有一些强大的分析工具，分享一下。</p>\n<h1 id=\"码流与封装容器相关\" style=\"position:relative;\"><a href=\"#%E7%A0%81%E6%B5%81%E4%B8%8E%E5%B0%81%E8%A3%85%E5%AE%B9%E5%99%A8%E7%9B%B8%E5%85%B3\" aria-label=\"码流与封装容器相关 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>码流与封装容器相关</h1>\n<h2 id=\"iso-viewer\" style=\"position:relative;\"><a href=\"#iso-viewer\" aria-label=\"iso viewer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ISO Viewer</h2>\n<p><a href=\"https://github.com/sannies/isoviewer\">isoviewer</a> 是 Mac 下一个检查 mp4 文件构成的 GUI 程序，能直观地看到各个 box 的数据。</p>\n<img src=\"//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/iso-viewer.png\" alt=\"undefined\" title=\"undefined\">\n<h2 id=\"bento4\" style=\"position:relative;\"><a href=\"#bento4\" aria-label=\"bento4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>bento4</h2>\n<p><a href=\"https://www.bento4.com/\">bento4</a> 是一套专用于 mp4 格式文件分析和编辑的 SDK，支持的功能非常多。</p>\n<table>\n<thead>\n<tr>\n<th>工具</th>\n<th>用途</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>mp4info</td>\n<td>displays high level info about an MP4 file, including all tracks and codec details</td>\n</tr>\n<tr>\n<td>mp4dump</td>\n<td>displays the entire atom/box structure of an MP4 file</td>\n</tr>\n<tr>\n<td>mp4edit</td>\n<td>add/insert/remove/replace atom/box items of an MP4 file</td>\n</tr>\n<tr>\n<td>mp4extract</td>\n<td>extracts an atom/box from an MP4 file</td>\n</tr>\n<tr>\n<td>mp4encrypt</td>\n<td>encrypts an MP4 file (multiple encryption schemes are supported)</td>\n</tr>\n<tr>\n<td>mp4decrypt</td>\n<td>decrypts an MP4 file (multiple encryption schemes are supported)</td>\n</tr>\n<tr>\n<td>mp4dcfpackager</td>\n<td>encrypts a media file into an OMA DCF file</td>\n</tr>\n<tr>\n<td>mp4compact</td>\n<td>converts 'stsz' tables into 'stz2' tables to create more compact MP4 files</td>\n</tr>\n<tr>\n<td>mp4fragment</td>\n<td>creates a fragmented MP4 file from a non-fragmented one.</td>\n</tr>\n<tr>\n<td>mp4split</td>\n<td>splits a fragmented MP4 file into discrete files</td>\n</tr>\n<tr>\n<td>mp4tag</td>\n<td>show/edit MP4 metadata (iTunes-style and others)</td>\n</tr>\n<tr>\n<td>mp4mux</td>\n<td>multiplexes one or more elementary streams (H264/AVC, H265/HEVC, AAC) into an MP4 file</td>\n</tr>\n<tr>\n<td>mp42aac</td>\n<td>extract a raw AAC elementary stream from an MP4 file</td>\n</tr>\n<tr>\n<td>mp42avc</td>\n<td>extract a raw AVC/H.264 elementary stream from an MP4 file</td>\n</tr>\n<tr>\n<td>mp42hls</td>\n<td>converts an MP4 file to an HLS (HTTP Live Streaming) presentation, including the generation of the segments and .m3u8 playlist as well as AES-128 and SAMPLE-AES (for Fairplay) encryption. This can be used as a replacement for Apple's mediafilesegmenter tool.</td>\n</tr>\n<tr>\n<td>mp42ts</td>\n<td>converts an MP4 file to an MPEG2-TS file.</td>\n</tr>\n<tr>\n<td>mp4dash</td>\n<td>creates an MPEG DASH output from one or more MP4 files, including encryption. This is a full-featured MPEG DASH packager.</td>\n</tr>\n<tr>\n<td>mp4dashclone</td>\n<td>creates a local clone of a remote or local MPEG DASH presentation, optionally encrypting the segments as they are cloned.</td>\n</tr>\n<tr>\n<td>mp4hls</td>\n<td>creates a multi-bitrate HLS master playlist from one or more MP4 files, including support for encryption and I-frame-only playlists. This tool uses the 'mp42hls' low level tool internally, so all the options supported by that low level tool are also available. This can be used as a replacement for Apple's variantplaylistcreator tool.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"gpac\" style=\"position:relative;\"><a href=\"#gpac\" aria-label=\"gpac permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GPAC</h2>\n<p><a href=\"https://gpac.wp.imt.fr/\">GPAC</a> 是一个为科研和学术领域开发的多媒体的框架，包括几个视频分析和码流编辑的 CLI 工具。官网主要 feature 如下:</p>\n<blockquote>\n<p>GPAC features encoders and multiplexers, publishing and content distribution tools for MP4 and 3GPP or 3GPP2 files and many tools for scene descriptions (BIFS/VRML/X3D converters, SWF/BIFS, SVG/BIFS, etc…). MP4Box provides all these tools in a single command-line application. An exhaustive list of packaging features is available here but a good summary of what MP4Box can do for you is the following:</p>\n<ul>\n<li>MP4/3GP Conversion from MP3, AVI, MEPG-2 TS, MPEG-PS, AAC, H263, H264, AMR, and many others,</li>\n<li>3GPP DIMS Packaging from SVG files,</li>\n<li>File layout: fragmentation or interleaving, and cleaning,</li>\n<li>File hinting for RTP/RTSP and QTSS/DSS servers (MPEG-4 / ISMA / 3GP / 3GP2 files),</li>\n<li>File splitting by size or time, extraction from file and file concatenation,</li>\n<li>XML information dumping for MP4 and RTP hint tracks,</li>\n<li>Media Track extractions,</li>\n<li>ISMA E&#x26;A encryption and decryption,</li>\n<li>3GPP timed text tools (SUB/SRT/TTXT/TeXML), VobSub import/export,</li>\n<li>BIFS codec and scene conversion between MP4, BT and XMT-A,</li>\n<li>LASeR codec and scene conversion between MP4, SAF, SVG and XSR (XML LASeR),</li>\n<li>XML scene statistics for BIFS scene (BT, XMT-A and MP4),</li>\n<li>Conversion to and from BT, XMT-A, WRL, X3D and X3DV with support for gzip.</li>\n<li>Preparing MP4,3GP and MPEG-2 TS files for DASH streaming</li>\n</ul>\n</blockquote>\n<p>主要使用的可能是 <code>MP4Box</code> 工具，功能很多，几个例子:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">MP4Box -add file.av1 file_av1.mp4 <span class=\"token comment\"># 将 av1 码流封装写入 mp4 文件</span></code></pre></div>\n<h2 id=\"ffprobe\" style=\"position:relative;\"><a href=\"#ffprobe\" aria-label=\"ffprobe permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ffprobe</h2>\n<p>大名鼎鼎的 ffmpeg 项目一员，一身<a href=\"https://ffmpeg.org/ffprobe.html\">技能和 API 参数</a>。</p>\n<p>其中一个用法是 dump 出所有的 frame:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ffprobe -show_frames some.mp4 &gt; probe-mp4.txt</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[FRAME]\nmedia_type=video\nstream_index=0\nkey_frame=1\npkt_pts=0\npkt_pts_time=0.000000\npkt_dts=0\npkt_dts_time=0.000000\nbest_effort_timestamp=0\nbest_effort_timestamp_time=0.000000\npkt_duration=512\npkt_duration_time=0.040000\npkt_pos=48\npkt_size=27979\nwidth=320\nheight=564\npix_fmt=yuv420p\nsample_aspect_ratio=N/A\npict_type=I\ncoded_picture_number=0\ndisplay_picture_number=0\ninterlaced_frame=0\ntop_field_first=0\nrepeat_pict=0\ncolor_range=unknown\ncolor_space=unknown\ncolor_primaries=unknown\ncolor_transfer=unknown\nchroma_location=left\n[/FRAME]\n[FRAME]\nmedia_type=audio\nstream_index=1\nkey_frame=1\npkt_pts=0\npkt_pts_time=0.000000\npkt_dts=0\npkt_dts_time=0.000000\nbest_effort_timestamp=0\nbest_effort_timestamp_time=0.000000\npkt_duration=1024\npkt_duration_time=0.021333\npkt_pos=28243\npkt_size=6\nsample_fmt=fltp\nnb_samples=1024\nchannels=2\nchannel_layout=stereo\n[/FRAME]</code></pre></div>\n<h1 id=\"二进制显示编辑\" style=\"position:relative;\"><a href=\"#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%98%BE%E7%A4%BA%E7%BC%96%E8%BE%91\" aria-label=\"二进制显示编辑 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>二进制显示/编辑</h1>\n<h2 id=\"hex-fiend\" style=\"position:relative;\"><a href=\"#hex-fiend\" aria-label=\"hex fiend permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hex Fiend</h2>\n<p><a href=\"https://github.com/ridiculousfish/HexFiend\">Hex Fiend</a>, Mac 下的 hex 编辑 GUI 工具，支持按文本或hex搜索/编辑/diff，功能强大。</p>\n<p><img src=\"https://raw.githubusercontent.com/ridiculousfish/HexFiend/master/docs/screenshot.png\" alt=\"HexFiend\"></p>\n<h2 id=\"hexyl\" style=\"position:relative;\"><a href=\"#hexyl\" aria-label=\"hexyl permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>hexyl</h2>\n<p><a href=\"https://github.com/sharkdp/hexyl\">hexyl</a> ，一个轻量 CLI 查看二进制数据的工具，用 rust 编写。优点是快速，好看。</p>\n<p><img src=\"https://camo.githubusercontent.com/1f71ee7031e1962b23f21c8cc89cb837e1201238/68747470733a2f2f692e696d6775722e636f6d2f4d574f3975534c2e706e67\" alt=\"hexyl 效果图\"></p>","excerpt":"最近在写一些跟视频解码相关的简单程序，学习 avcodec 技术时有一些强大的分析工具，分享一下。 码流与封装容器相关 ISO Viewer isoviewer 是 Mac 下一个检查 mp4 文件构成的 GUI 程序，能直观地看到各个 box 的数据。 bento4 bento…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#%E7%A0%81%E6%B5%81%E4%B8%8E%E5%B0%81%E8%A3%85%E5%AE%B9%E5%99%A8%E7%9B%B8%E5%85%B3\">码流与封装容器相关</a></p>\n<ul>\n<li><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#iso-viewer\">ISO Viewer</a></li>\n<li><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#bento4\">bento4</a></li>\n<li><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#gpac\">GPAC</a></li>\n<li><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#ffprobe\">ffprobe</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%98%BE%E7%A4%BA%E7%BC%96%E8%BE%91\">二进制显示/编辑</a></p>\n<ul>\n<li><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#hex-fiend\">Hex Fiend</a></li>\n<li><a href=\"/2019-03-13-Handy-Video-Analyze-Tool/#hexyl\">hexyl</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/2019-03-13-Handy-Video-Analyze-Tool/","featureImageSrc":"//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/iso-viewer.png"},"frontmatter":{"title":"Handy Video Analyze Tool","date":"2019-03-14","author":null,"tags":["video"],"use_toc":true,"coverImage":null}}},"pageContext":{"type":"posts","next":{"fields":{"slug":"/2019-03-06-Decode-Video-Using-FFMpeg-In-Browser/"},"frontmatter":{"title":"Decode Video Using ffmpeg In Browser","tags":["Webassembly","Avtech","Emscripten","ffmpeg"]},"fileAbsolutePath":"/Users/bytedance/mydemos/gatsby-hello-friend/content/posts/2019-03-06-Decode-Video-Using-FFMpeg-In-Browser.md"},"previous":{"fields":{"slug":"/2019-05-05-Benchmark-WASM-with-d8/"},"frontmatter":{"title":"使用 d8 快速测试 WebAssembly 模块性能","tags":["Benchmark","V8","WebAssembly"]},"fileAbsolutePath":"/Users/bytedance/mydemos/gatsby-hello-friend/content/posts/2019-05-05-Benchmark-WASM-with-d8.md"},"slug":"/2019-03-13-Handy-Video-Analyze-Tool/"}},"staticQueryHashes":["1425477374","3128451518"]}
{"componentChunkName":"component---src-templates-page-js","path":"/2020-02-05-Awesome-UltiSnips/","result":{"data":{"site":{"siteMetadata":{"title":"HP goes FE","author":"@hikerpig"}},"markdownRemark":{"id":"1c3d79fc-578d-59ce-bbd6-6f1ad8aff914","html":"<p>UltiSnips 不愧为 vim （或乃至所有编辑器）生态下的最佳代码片段解决方案。支持多种常见语法、snippet 添加和管理符合直觉（此处应 cue 一下隔壁对多行文本支持令人垂泪的 vscode）、还有眼花缭乱的 python 脚本插值供 <a href=\"https://github.com/honza/vim-snippets\">高级玩家</a> 使用。</p>\n<p>UltiSnips 项目已有十年的历史，功能为其模仿和致敬的 SnipMate 的超集，SnipMate 模仿了 TextMate 的语法。</p>\n<p>vscode 也模仿了 TextMate snippet 的语法，从而使得在 ultisnips 和 vscode snippet 语法之间 <a href=\"http://unisnips.netlify.com/\">转换</a> 变得相对容易。</p>\n<p>仔细阅读文档以后，发现了一些以前遗漏了的功能。</p>\n<h2 id=\"snippets-文件组织方式\" style=\"position:relative;\"><a href=\"#snippets-%E6%96%87%E4%BB%B6%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F\" aria-label=\"snippets 文件组织方式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>snippets 文件组织方式</h2>\n<p>引自官方文档：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Using a strategy similar to how Vim detects |ftplugins|, UltiSnips iterates\nover the snippet definition directories looking for files with names of the\nfollowing patterns: ft.snippets, ft_*.snippets, or ft/*, where &quot;ft&quot; is the\n&#39;filetype&#39; of the current document and &quot;*&quot; is a shell-like wildcard matching\nany string including the empty string. The following table shows some typical\nsnippet filenames and their associated filetype.\n\n    snippet filename         filetype ~\n    ruby.snippets            ruby\n    perl.snippets            perl\n    c.snippets               c\n    c_my.snippets            c\n    c/a                      c\n    c/b.snippets             c\n    all.snippets             all\n    all/a.snippets           all</code></pre></div>\n<p>同一语言的 snippet 不用都塞到一个文件里，可以按照主题组织。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">-- javascript\n   |-- jest.snippets\n   |-- vue.snippets\n   |-- class.snippets</code></pre></div>\n<h2 id=\"trigger-不用费脑记\" style=\"position:relative;\"><a href=\"#trigger-%E4%B8%8D%E7%94%A8%E8%B4%B9%E8%84%91%E8%AE%B0\" aria-label=\"trigger 不用费脑记 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>trigger 不用费脑记</h2>\n<h3 id=\"列出当前可展开的-snippets\" style=\"position:relative;\"><a href=\"#%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E5%8F%AF%E5%B1%95%E5%BC%80%E7%9A%84-snippets\" aria-label=\"列出当前可展开的 snippets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>列出当前可展开的 snippets</h3>\n<p>在 Normal 模式下，可以使用 <code>:call UltiSnips#ListSnippets()</code>，该函数会列出当前 cursor 处所有支持的 snippet （如果当前 cursor 处没有字符，列出的是此文件所有支持的 snippet），且可以通过数字选择直接展开 snippet 。</p>\n<p>在 Insert 模式下，可设置 <code>g:UltiSnipsListSnippets</code> 绑定按键触发以上函数，默认是 <code>&#x3C;c-tab></code>，在一些 terminal 软件里可能会有按键冲突，可以改成别的键，例如：</p>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre class=\"language-vim\"><code class=\"language-vim\">g<span class=\"token punctuation\">:</span>UltiSnipsListSnippets<span class=\"token operator\">=</span><span class=\"token string\">'&lt;c-u>&lt;c-l>'</span></code></pre></div>\n<p>效果如下：</p>\n<p><img src=\"https://i.loli.net/2020/02/05/zL9IbrTyBgfQXEo.gif\" alt=\"list snippets usage\"></p>\n<p>不过这个函数调用的是 vim 的 <a href=\"https://vim-jp.org/vimdoc-en/eval.html\">inputlist</a> 接口，稍显原始，同时列出的数据太过详尽，有点干扰正常输入流。如果不介意多安装一些东西，可以看下一节。</p>\n<h3 id=\"与-vim-的自动补全插件配合\" style=\"position:relative;\"><a href=\"#%E4%B8%8E-vim-%E7%9A%84%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8%E6%8F%92%E4%BB%B6%E9%85%8D%E5%90%88\" aria-label=\"与 vim 的自动补全插件配合 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>与 vim 的自动补全插件配合</h3>\n<p>文档的 <em>UltiSnips and Other Plugins</em> 一节列出了一些支持的自动补全插件。</p>\n<blockquote>\n<p>YouCompleteMe - comes with out of the box completion support for UltiSnips. It\noffers a really nice completion dialogue for snippets.</p>\n<p>neocomplete - UltiSnips ships with a source for neocomplete and therefore\noffers out of the box completion dialogue support for it too.</p>\n<p>deoplete - The successor of neocomplete is also supported.</p>\n<p>unite - UltiSnips has a source for unite.</p>\n</blockquote>\n<p>我试过 deoplete ，开箱即用，体验良好。不过由于其他的一些原因，同类型插件我只使用了 <a href=\"https://github.com/neoclide/coc.nvim\">coc.nvim</a> ，它其实也有对 ultisnips 很好的支持（翻源码才发现它甚至还 port 了一个 vscode 的 snippet 引擎）。</p>\n<p><img src=\"https://i.loli.net/2020/02/05/58nsKTQmfAGNVpJ.gif\" alt=\"ultisnips with coc.nvim\"></p>\n<h2 id=\"以前端项目为例子，可以使用的进阶功能\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E4%B8%BA%E4%BE%8B%E5%AD%90%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E7%9A%84%E8%BF%9B%E9%98%B6%E5%8A%9F%E8%83%BD\" aria-label=\"以前端项目为例子，可以使用的进阶功能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以前端项目为例子，可以使用的进阶功能</h2>\n<h3 id=\"vim-script-code--transformation\" style=\"position:relative;\"><a href=\"#vim-script-code--transformation\" aria-label=\"vim script code  transformation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vim script code + Transformation</h3>\n<p>形式为 <code>${&#x3C;tab_stop_no/regular_expression/replacement/options}</code> 的 Transformation 需要依赖于一个 tabstop。是在强大的 python script 之外，稍微简单和通用一点的转换形式。</p>\n<p>例如在 <code>test-component.vue</code> 文件里，快速起草一个 Vue SFC 文件结构。</p>\n<div class=\"gatsby-highlight\" data-language=\"vim-snippets\"><pre class=\"language-vim-snippets\"><code class=\"language-vim-snippets\">snippet sfc_component &quot;setup sfc component&quot;\n&lt;template&gt;\n  &lt;div class=&quot;${1:`!v expand(&quot;%:r&quot;)`}&quot;&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nexport default {\n  name: &#39;${1/[-_]?([a-z]+)/\\u$1/g}&#39;,\n}\n&lt;/script&gt;\nendsnippet</code></pre></div>\n<p>展开后内容为：</p>\n<div class=\"gatsby-highlight\" data-language=\"vue\"><pre class=\"language-vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div class=&quot;test-component&quot;&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nexport default {\n  name: &#39;TestComponent&#39;,\n}\n&lt;/script&gt;</code></pre></div>","excerpt":"UltiSnips 不愧为 vim （或乃至所有编辑器）生态下的最佳代码片段解决方案。支持多种常见语法、snippet 添加和管理符合直觉（此处应 cue 一下隔壁对多行文本支持令人垂泪的 vscode）、还有眼花缭乱的 python…","tableOfContents":"<ul>\n<li><a href=\"/2020-02-05-Awesome-UltiSnips/#snippets-%E6%96%87%E4%BB%B6%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F\">snippets 文件组织方式</a></li>\n<li>\n<p><a href=\"/2020-02-05-Awesome-UltiSnips/#trigger-%E4%B8%8D%E7%94%A8%E8%B4%B9%E8%84%91%E8%AE%B0\">trigger 不用费脑记</a></p>\n<ul>\n<li><a href=\"/2020-02-05-Awesome-UltiSnips/#%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E5%8F%AF%E5%B1%95%E5%BC%80%E7%9A%84-snippets\">列出当前可展开的 snippets</a></li>\n<li><a href=\"/2020-02-05-Awesome-UltiSnips/#%E4%B8%8E-vim-%E7%9A%84%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8%E6%8F%92%E4%BB%B6%E9%85%8D%E5%90%88\">与 vim 的自动补全插件配合</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/2020-02-05-Awesome-UltiSnips/#%E4%BB%A5%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E4%B8%BA%E4%BE%8B%E5%AD%90%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E7%9A%84%E8%BF%9B%E9%98%B6%E5%8A%9F%E8%83%BD\">以前端项目为例子，可以使用的进阶功能</a></p>\n<ul>\n<li><a href=\"/2020-02-05-Awesome-UltiSnips/#vim-script-code--transformation\">Vim script code + Transformation</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/2020-02-05-Awesome-UltiSnips/","featureImageSrc":null},"frontmatter":{"title":"Awesome UltiSnips","date":"2020-02-05","author":null,"tags":["Vim","UltiSnips"],"use_toc":true,"coverImage":null}}},"pageContext":{"type":"posts","next":{"fields":{"slug":"/2019-12-11-Browser-Storage-Limit/"},"frontmatter":{"title":"浏览器 IndexedDB 存储限制","tags":["IndexedDB","WebStorage","Browser"]},"fileAbsolutePath":"/Users/bytedance/mydemos/gatsby-hello-friend/content/posts/2019-12-11-Browser-Storage-Limit.md"},"previous":{"fields":{"slug":"/2020-02-19-Regex-Collection/"},"frontmatter":{"title":"我的常用正则表达式清单","tags":["工具","正则"]},"fileAbsolutePath":"/Users/bytedance/mydemos/gatsby-hello-friend/content/posts/2020-02-19-Regex-Collection.md"},"slug":"/2020-02-05-Awesome-UltiSnips/"}},"staticQueryHashes":["1425477374","3128451518"]}
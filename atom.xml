<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HP goes FE</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://hikerpig.github.io/"/>
  <updated>2018-12-30T04:23:40.503Z</updated>
  <id>http://hikerpig.github.io/</id>
  
  <author>
    <name>Hikerpig</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CSS ä¸­çš„ä¸¤ç§æ¨¡ç³ŠåŠå¾„</title>
    <link href="http://hikerpig.github.io/2018/12/22/2018-12-22-svg-blur-and-css-text-shadow/"/>
    <id>http://hikerpig.github.io/2018/12/22/2018-12-22-svg-blur-and-css-text-shadow/</id>
    <published>2018-12-22T05:52:02.288Z</published>
    <updated>2018-12-30T04:23:40.503Z</updated>
    
    <content type="html"><![CDATA[<p>CSS ä¸­ä¸¤ç§å®ç°é˜´å½±çš„æ–¹å¼</p><ol type="1"><li>text-shadow å’Œ box-shadow</li><li>filter: drop-shadow</li></ol><p>å‰è€…çš„ blur-radius æŒ‡çš„æ˜¯é˜´å½±çš„æœ€å¤–å»¶åŠå¾„ï¼Œåè€…çš„ blur-radius æŒ‡çš„æ˜¯é«˜æ–¯æ¨¡ç³Šä¸­çš„æ ‡å‡†å·®($Ïƒ)</p><p><a href="https://drafts.csswg.org/css-backgrounds/#shadow-blur" target="_blank" rel="noopener">W3C çš„ CSS æ ‡å‡†æ­¤å¤„</a> è¯´åˆ°å°† stdDeviation è®¾ä¸º blur-radius çš„ä¸€åŠå¯ä»¥å¾—åˆ°è¿‘ä¼¼çš„æ•ˆæœ</p><blockquote><p>A non-zero blur radius indicates that the resulting shadow should be blurred, such as by a Gaussian filter. The exact algorithm is not defined; however the resulting shadow must approximate (with each pixel being within 5% of its expected value) the image that would be generated by applying to the shadow a Gaussian blur with a standard deviation equal to half the blur radius</p></blockquote><h2 id="ä¸€ä¸ªå®éªŒ">ä¸€ä¸ªå®éªŒ</h2><script async src="//jsfiddle.net/hikerpig/1wq70fgn/embed/result,html,js,css/"></script><p>ç›¸åŒçš„æ•°å€¼ï¼Œåœ¨ä¸åŒæµè§ˆå™¨ä¸­æ•ˆæœä¸åŒã€‚æ€»ä½“æ¥è¯´ drop-shadow çš„ç»“æœä¼šæ¯” text-shadow/box-shadow çš„æ•ˆæœæ›´åŠ å‘æ•£å’ŒæŸ”å’Œã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ul><li><a href="https://dbaron.org/log/20110225-blur-radius" target="_blank" rel="noopener">What does a blur radius mean?</a></li><li><a href="https://drafts.csswg.org/css-backgrounds/#blur-radius" target="_blank" rel="noopener">Blurring Shadow Edges</a></li><li>https://github.com/w3c/fxtf-drafts/issues/102</li><li>https://bugs.chromium.org/p/chromium/issues/detail?id=677689</li><li>https://developer.mozilla.org/en-US/docs/Web/CSS/filter</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;CSS ä¸­ä¸¤ç§å®ç°é˜´å½±çš„æ–¹å¼&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;text-shadow å’Œ box-shadow&lt;/li&gt;
&lt;li&gt;filter: drop-shadow&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‰è€…çš„ blur-radius æŒ‡çš„æ˜¯é˜´å½±çš„æœ€å¤–å»¶åŠå¾„ï¼Œåè€…çš„ 
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="CSS" scheme="http://hikerpig.github.io/tags/CSS/"/>
    
      <category term="SVG" scheme="http://hikerpig.github.io/tags/SVG/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨ä¸­çš„å­—ä½“ä¿¡æ¯æµ‹é‡</title>
    <link href="http://hikerpig.github.io/2018/11/15/2018-11-15-font-metrics-in-browser/"/>
    <id>http://hikerpig.github.io/2018/11/15/2018-11-15-font-metrics-in-browser/</id>
    <published>2018-11-14T16:00:00.000Z</published>
    <updated>2019-01-06T02:58:47.755Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>é¢˜å›¾æ¥è‡ª http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align</p></blockquote><h1 id="ä¸ºä»€ä¹ˆåŒæ ·çš„-font-size-æ–‡å­—é«˜åº¦ä¸ä¸€æ ·">ä¸ºä»€ä¹ˆåŒæ ·çš„ font-size ï¼Œæ–‡å­—é«˜åº¦ä¸ä¸€æ ·ï¼Ÿ</h1><p>æ¯ä¸ªå­—ä½“åœ¨è®¾è®¡çš„æ—¶å€™ï¼Œéƒ½æ˜¯åŸºäºä¸€ä¸ª <a href="http://designwithfontforge.com/zh-CN/The_EM_Square.html" target="_blank" rel="noopener">EM Square</a>ï¼Œè¿™æ˜¯æ´»å­—å°åˆ·ä¸­å­—æ¨¡çš„é«˜åº¦ã€‚</p><blockquote><p>åœ¨æ•°å­—åŒ–å­—ä½“ä¸­ï¼Œem æ˜¯ç©ºé—´çš„æ•°å­—åŒ–å®šä¹‰æ€»é‡ã€‚åœ¨OpenTypeå­—ä½“ä¸­ï¼ŒUPMæˆ–emå¤§å°é€šå¸¸æ˜¯1000å•ä½ã€‚åœ¨TrueTypeå­—ä½“ä¸­ï¼ŒUPMçº¦å®šæ˜¯2çš„å¹‚ï¼Œé€šå¸¸æ˜¯1024æˆ–2048ã€‚</p></blockquote><p>å®é™…æƒ…å†µä¸­ï¼Œè®¸å¤šå­—ä½“çš„å†…å®¹é«˜åº¦å…¶å®æ˜¯æ¯” em box è¦å¤§çš„ã€‚</p><p>åŒæ˜¯ <code>font-size: 30px</code> æƒ…å†µä¸‹ï¼Œæ­¤å¤„çš„ Noto Sans JP çš„å­—ä½“ç©ºé—´å°±æ¯” Kosugi Maru è¦é«˜ã€‚è€Œä¸”åœ¨å­—ä½“æ¡†å†…ï¼Œå‚ç›´æ–¹å‘ä¸Šè¿˜æœ‰ç•™ç™½ã€‚</p><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/fonts/noto-sans-jp-1.jpg" alt="undefined" title="undefined"><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com//image/fonts/kosugi-maru-1.jpg" alt="undefined" title="undefined"><p>å‚ç›´æ–¹å‘ç•™ç™½å¤§å°çš„è®¡ç®—å…¬å¼ï¼Œå¯ä»¥ç”±å­—ä½“æ–‡ä»¶ä¸­çš„å®šä¹‰å¾—åˆ°ï¼š</p><blockquote><p>internal leading = ascent - descent - EM_size</p></blockquote><h1 id="ä»£ç ç‰‡æ®µ">ä»£ç ç‰‡æ®µ</h1><p>å¯ä»¥åœ¨<a href="https://jsfiddle.net/hikerpig/xkt3o4sd/4/" target="_blank" rel="noopener">è¿™ä¸ª fiddle</a> é‡Œçœ‹åˆ°ç»“æœã€‚</p><h2 id="ä½¿ç”¨-canvas-åº¦é‡æ–‡å­—å®½åº¦">ä½¿ç”¨ canvas åº¦é‡æ–‡å­—å®½åº¦</h2><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMetricsByCanvas</span>(<span class="hljs-params">canvas, str, font</span>) </span>&#123;  <span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">'2d'</span>)  ctx.font = font  <span class="hljs-built_in">console</span>.log(str, font, ctx.measureText(str))&#125;<span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-keyword">const</span> canvas = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'canvas'</span>)  <span class="hljs-built_in">document</span>.body.appendChild(canvas)  <span class="hljs-built_in">window</span>.canvas = canvas  getMetricsByCanvas(canvas, <span class="hljs-string">'å­—'</span>, <span class="hljs-string">'30px  Noto Sans JP'</span>) <span class="hljs-comment">// å­— 30px  Noto Sans JP TextMetricsÂ &#123;width: 30&#125;</span>&#125;</code></pre><p>ä¸è¿‡æ­¤ API æ˜¯æ‹¿ä¸åˆ°å­—ç¬¦çš„é«˜åº¦çš„ã€‚å°±æœ‰ä¸€äº›æ¯”è¾ƒé»‘çš„æ–¹æ³•æ¥ä¼°ç®—å­—ä½“çš„å†…å®¹é«˜åº¦ï¼Œä¾‹å¦‚ä½¿ç”¨å¤§å†™å­—æ¯ â€˜Mâ€™ çš„å®½åº¦ä½œä¸ºå†…åŠŸé«˜åº¦çš„è¿‘ä¼¼ã€‚è¿™äº›æŠ€å·§å…¶å®éƒ½ä¸å­—å½¢è®¾è®¡çš„æƒ¯ä¾‹æœ‰å…³ï¼Œåœ¨æ‹‰ä¸å­—æ¯ä¸­ï¼Œâ€˜Mâ€™ æ˜¯å­—å½¢æœ€ä¸ºé¥±æ»¡å’Œæ–¹æ­£çš„å­—ç¬¦ï¼Œé«˜åº¦ä¸å®½åº¦è¿‘ä¼¼ã€‚</p><p>ä¸è¿‡æ˜æ˜¾è¿™ä¸ªæƒ¯ä¾‹å¯¹äºä»¥ä¸Šä¸¤ä¸ªæ—¥æ–‡å­—ä½“<em>å¹¶ä¸é€‚ç”¨</em>ã€‚</p><p>æ±‰å­—å› ä¸ºå­—å½¢å¤šæ•°ä¸ºé¥±æ»¡çš„æ–¹å—å­—ï¼Œç”¨å®½åº¦å»ä¼°è®¡å†…å®¹é«˜åº¦å…¶å®æ›´å®¹æ˜“ï¼Œä¾‹å¦‚ â€˜äººâ€™ å’Œ â€˜å£â€™ å°±å¾ˆå¥½ç”¨ã€‚</p><h2 id="åˆ›å»ºä¸´æ—¶-dom-å…ƒç´ ç”¨äºåº¦é‡é«˜åº¦">åˆ›å»ºä¸´æ—¶ dom å…ƒç´ ç”¨äºåº¦é‡é«˜åº¦</h2><p>èƒ½æ‹¿åˆ°æ›´å…¨çš„å­—å½¢ç›’ä¿¡æ¯</p><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMetricsBySpan</span>(<span class="hljs-params">str, font</span>) </span>&#123;  <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"span"</span>);  d.style.font = font;  d.textContent = str;  <span class="hljs-built_in">document</span>.body.appendChild(d);  <span class="hljs-keyword">const</span> emHeight = d.offsetHeight;  <span class="hljs-keyword">const</span> emWidth = d.offsetWidth;  <span class="hljs-built_in">console</span>.log(str, font, &#123; emWidth, emHeight &#125;)  <span class="hljs-built_in">document</span>.body.removeChild(d);&#125;getMetricsBySpan(<span class="hljs-string">'å­—'</span>, <span class="hljs-string">'30px  Noto Sans JP'</span>) <span class="hljs-comment">// å­— 30px  Noto Sans JP &#123;emWidth: 30, emHeight: 45&#125;</span></code></pre><h1 id="ç¨å¾®ä¸é‚£ä¹ˆç®€å•ä½†å‡†ç¡®çš„æ–¹æ³•">ç¨å¾®ä¸é‚£ä¹ˆç®€å•ä½†å‡†ç¡®çš„æ–¹æ³•</h1><h2 id="åŸºäº-canvas-çš„-fontmetrics">åŸºäº canvas çš„ FontMetrics</h2><p><a href="https://github.com/soulwire/FontMetrics" target="_blank" rel="noopener">FontMetrics</a> è¿™ä¸ªåº“ï¼Œå…ˆæ¸…ç©º canvasï¼Œå°†æ–‡å­—æ¸²æŸ“è‡³ canvas ä¸Šï¼Œç„¶åé€è¡Œç»Ÿè®¡ canvas ä¸Šçš„åƒç´ ï¼Œç”±æ­¤å¯ä»¥çŸ¥é“æ–‡å­—çš„ä¸Šä¸‹å†…å®¹è¾¹ç•Œï¼Œå†ä¸ font size æ¢ç®—ï¼Œä¾¿å¯ä»¥å¾—åˆ°å­—ç¬¦çš„é«˜åº¦ã€‚</p><h2 id="opentype.js">opentype.js</h2><figure><img src="https://camo.githubusercontent.com/2eae816a7d7ec3155c6136a50cc7a939eee608ca/68747470733a2f2f7261772e6769746875622e636f6d2f6f70656e747970656a732f6f70656e747970652e6a732f6d61737465722f672f68656c6c6f2d776f726c642e706e67" alt="opentype.js"><figcaption>opentype.js</figcaption></figure><p><a href="https://opentype.js.org/" target="_blank" rel="noopener">opentype.js</a> æ˜¯ä¸€ä¸ªä¼˜ç§€çš„è§£æ OpenType å­—ä½“çš„ js åº“ã€‚ä»¥ ArrayBuffer ä¼ å…¥å­—ä½“çš„æ•°æ®ï¼Œè§£æå‡ºæ‰€æœ‰ OpenType æ ‡å‡†æ•°æ®ï¼Œå®Œå…¨å¯ä»¥åŸºäºæ­¤å†™å‡ºç¬¦åˆè‡ªå·±éœ€æ±‚çš„æ’ç‰ˆå¼•æ“ã€‚</p><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> font = parse(buffer)<span class="hljs-keyword">const</span> g = font.charToGlyph(<span class="hljs-string">'å­—'</span>)<span class="hljs-keyword">const</span> bb = g.getBoundingBox()  <span class="hljs-comment">// å¾—å‡º &#123; x1, x2 , y1, y2 &#125;</span></code></pre><h1 id="å‚è€ƒ">å‚è€ƒ</h1><p><a href="https://stackoverflow.com/questions/1134586/how-can-you-find-the-height-of-text-on-an-html-canvas" target="_blank" rel="noopener">SO ä¸Šçš„ä¸€ä¸ªé—®é¢˜</a></p><p><a href="https://www.freetype.org/freetype2/docs/glyphs/glyphs-3.html" target="_blank" rel="noopener">FreeType Glyph Metrics</a></p><p><a href="https://www.html5rocks.com/en/tutorials/canvas/texteffects/#toc-text-shadow-clipping" target="_blank" rel="noopener">Typographic effects in canvas</a></p><p><a href="http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align" target="_blank" rel="noopener">Deep dive CSS: font metrics, line-height and vertical-align</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;é¢˜å›¾æ¥è‡ª http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;ä¸ºä»€ä¹ˆåŒæ ·çš„-font-size-æ–‡å­—é«˜
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="æµè§ˆå™¨" scheme="http://hikerpig.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
      <category term="å­—ä½“" scheme="http://hikerpig.github.io/tags/%E5%AD%97%E4%BD%93/"/>
    
  </entry>
  
  <entry>
    <title>SVG å…ƒç´ çš„è‡ªå®šä¹‰  transform origin</title>
    <link href="http://hikerpig.github.io/2018/08/26/2018-08-26-beware-of-svg-transform/"/>
    <id>http://hikerpig.github.io/2018/08/26/2018-08-26-beware-of-svg-transform/</id>
    <published>2018-08-25T16:00:00.000Z</published>
    <updated>2018-09-26T06:07:34.129Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸è¦ä½¿ç”¨-transform-origin-å±æ€§">ä¸è¦ä½¿ç”¨ transform-origin å±æ€§</h2><p>SVG æ”¯æŒ <code>transform</code>ï¼Œè€Œä¸”å†™æ³•ä¼¼ä¹ä¸ CSS ä¸­ç›¸åŒï¼Œä½†æ˜¯å®ƒçš„<a href="https://www.w3.org/TR/SVG11/coords.html" target="_blank" rel="noopener">æ ‡å‡†</a>é‡Œå¹¶ä¸æ”¯æŒ <code>transform-origin</code> å±æ€§ã€‚è™½ç„¶åœ¨éƒ¨åˆ†æµè§ˆå™¨ä¸­ï¼Œç»™ SVG å…ƒç´ æŒ‡å®š <code>transform-origin</code> ä¼¼ä¹æ˜¯æœ‰æ•ˆæœçš„ï¼ˆå†™æ³•å’Œç»“æœä¹Ÿä¸ CSS ä¸€æ ·ï¼‰ï¼Œä½†æ˜¯æ— æ³•æŒ‡æœ›è¿™ä¸ªè¡Œä¸ºåœ¨æ‰€æœ‰æµè§ˆå™¨é‡Œéƒ½æœ‰æ•ˆã€‚</p><h1 id="è‡ªè¡Œè§£é‡Š-transformorigin">è‡ªè¡Œè§£é‡Š transformOrigin</h1><p>æ—¢ç„¶ä¸èƒ½é€šè¿‡ attribute æ¥æŒ‡å®šå˜æ¢åŸç‚¹ï¼Œæˆ‘ä»¬åªå¥½é€šè¿‡å¯¹å…¶ä»– transform å€¼çš„å˜åŠ¨æ¥å®ç°æƒ³è¦çš„æ•ˆæœäº†ã€‚</p><p>é¦–å…ˆå»ºç«‹ä¸€ä¸ªå¯¹è±¡ç³»ç»Ÿ</p><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> Display &#123;  x: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>  y: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>  width: <span class="hljs-built_in">number</span>  height: <span class="hljs-built_in">number</span>  scale: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>] = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]  transformOrigin?: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>]  parent?: Display  element: SVGElement  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"></span>) &#123;     <span class="hljs-keyword">this</span>.element = <span class="hljs-keyword">this</span>.createElement() <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>  &#125;  createElement() &#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'g'</span>)  &#125;  addChild(child: Display) &#123;    child.parent = <span class="hljs-keyword">this</span>    <span class="hljs-keyword">this</span>.element.appendChild(child.element)  &#125;&#125;<span class="hljs-keyword">class</span> Rect <span class="hljs-keyword">extends</span> Display &#123;  createElement() &#123;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'rect'</span>)  &#125;&#125;</code></pre><p>æ­¤æ—¶æœ‰</p><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> r1 = <span class="hljs-keyword">new</span> Rect(&#123;  name: <span class="hljs-string">"r1"</span>,  x: <span class="hljs-number">10</span>,  y: <span class="hljs-number">10</span>,  width: <span class="hljs-number">100</span>,  height: <span class="hljs-number">50</span>,&#125;)<span class="hljs-keyword">const</span> r2 = <span class="hljs-keyword">new</span> Rect(&#123;  name: <span class="hljs-string">"r2"</span>,  x: <span class="hljs-number">10</span>,  y: <span class="hljs-number">10</span>,  width: <span class="hljs-number">100</span>,  height: <span class="hljs-number">50</span>,  scale: [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>],&#125;)</code></pre><p>ç»è¿‡ç®€å•çš„å±æ€§åˆ° dom çš„æ“ä½œï¼Œå¾—åˆ°</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"r1"</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">"translate(10,10)"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"blue"</span> <span class="hljs-attr">opacity</span>=<span class="hljs-string">"0.8"</span> /&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"r2"</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">"translate(10,10) scale(2,2)"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"red"</span> <span class="hljs-attr">opacity</span>=<span class="hljs-string">"0.8"</span> /&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre><svg style="background: #CCC">&lt;rect name=â€œr1â€ transform=â€œtranslate(10,10)â€ width=â€œ100â€ height=â€œ50â€ fill=â€œblueâ€ opacity=â€œ0.8â€ /&gt; <rect name="r2" transform="translate(10,10) scale(2,2)" width="100" height="50" fill="red" opacity="0.8"/></svg><p>r2 çš„å˜æ¢ï¼Œå…ˆå¹³ç§»å†ç¼©æ”¾ï¼Œå¹³ç§»çš„ç»“æœå°±æ˜¯ç¼©æ”¾çš„åŸç‚¹ã€‚</p><p>æ­¤å¤„å°† x/y è½¬ä¸º translate è€Œä¸æ˜¯ <code>x</code> å’Œ <code>y</code> å±æ€§ï¼Œæ˜¯ä¸ºäº†ä»¥ç»Ÿä¸€çš„æ–¹å¼åšåæ ‡ç³»çš„è½¬æ¢å’Œè¿ç®—ï¼Œä¸”è€ƒè™‘åˆ°è®¸å¤šå…ƒç´ æ²¡æœ‰ <code>x</code> å’Œ <code>y</code> å±æ€§ï¼ˆå¦‚ <code>circle</code> å°±åªæœ‰ <code>cx</code> å’Œ <code>cy</code> ï¼‰ï¼Œä½†æ‰€æœ‰ SVG å…ƒç´ éƒ½æ”¯æŒ transform ã€‚</p><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formTransform</span>(<span class="hljs-params">d: Display</span>) </span>&#123;  <span class="hljs-keyword">const</span> scales = d.scale  <span class="hljs-keyword">const</span> scaleX = scales[<span class="hljs-number">0</span>]  <span class="hljs-keyword">const</span> scaleY = scales[<span class="hljs-number">1</span>]  <span class="hljs-keyword">return</span> <span class="hljs-string">`translate(<span class="hljs-subst">$&#123;d.x&#125;</span>,<span class="hljs-subst">$&#123;d.y&#125;</span>) scale(<span class="hljs-subst">$&#123;scaleX&#125;</span>,<span class="hljs-subst">$&#123;scaleY&#125;</span>)`</span>&#125;</code></pre><h2 id="å¸¦ä½ç§»è¡¥å¿çš„ç¼©æ”¾">å¸¦ä½ç§»è¡¥å¿çš„ç¼©æ”¾</h2><p>è®¡ç®—ç¼©æ”¾çš„ä½ç§»è¡¥å¿å€¼ï¼Œä½¿å¾—ç¼©æ”¾å†ä½ç§»åæ•ˆæœå°±ä¸ä»¥å˜æ¢åŸç‚¹ä¸ºä¸­å¿ƒç¼©æ”¾ä¸€æ ·ã€‚</p><p>å‡è®¾åœ¨ç¼©æ”¾ç³»æ•°ä¸º S æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„ translate ä¸º <span class="math inline">TR</span>ï¼Œå˜æ¢å®Œçš„ç»“æœï¼š</p><p><span class="math display">x&#39;=(x+TR_x)\times S_x\\\\y&#39;=(y+TR_y)\times S_y</span></p><p>å½“ä»¥å˜æ¢åŸç‚¹ä¸ºç‰¹å¾ç‚¹æ—¶ï¼Œæ–¹ç¨‹æ˜“äºæ„å»ºä¸æ±‚è§£ã€‚</p><p>ä»¤ <span class="math inline">T_x</span> å’Œ <span class="math inline">T_y</span> ä¸ºå˜æ¢åŸç‚¹ç›¸å¯¹äºåŸåæ ‡ç³»å·¦ä¸Šè§’çš„åæ ‡ï¼Œå½“ <span class="math inline">x=T_x,\  y=T_y</span> æ—¶ï¼Œä»£å…¥å¾—åˆ°ï¼š</p><p><span class="math display">TO_{x} \ \ =\ ( TO_{x} \ +TR_{x}) \times S_{x}\\\\TO_{y} \ \ =\ ( TO_{y} \ +TR_{y}) \times S_{y}</span></p><p>æ‰€ä»¥ï¼š</p><p><span class="math display">TR_{x} \ =\frac{( 1-S_{x}) \times TO_{x}}{S_{x}}\\\\\\\\TR_{y} \ =\frac{( 1-S_{y}) \times TO_{y}}{S_{y}}</span></p><p>å¸¦ç¼©æ”¾ä¿®æ­£å€¼çš„ transform è®¡ç®—æ–¹æ³•æ”¹ä¸ºï¼š</p><pre><code class="hljs diff">   const scales = d.scale   const scaleX = scales[0]   const scaleY = scales[1]<span class="hljs-deletion">-  return `translate($&#123;d.x&#125;,$&#123;d.y&#125;) scale($&#123;scaleX&#125;,$&#123;scaleY&#125;)`</span><span class="hljs-addition">+</span><span class="hljs-addition">+  let xToOrigin = d.width / 2</span><span class="hljs-addition">+  let yToOrigin = d.height / 2</span><span class="hljs-addition">+  if (d.transformOrigin) &#123;</span><span class="hljs-addition">+    xToOrigin = d.transformOrigin[0]</span><span class="hljs-addition">+    yToOrigin = d.transformOrigin[1]</span><span class="hljs-addition">+  &#125;</span><span class="hljs-addition">+  const revisedX = (1 - scaleX) * xToOrigin</span><span class="hljs-addition">+  const revisedY = (1 - scaleY) * yToOrigin</span><span class="hljs-addition">+</span><span class="hljs-addition">+  return `translate($&#123;d.x&#125;,$&#123;d.y&#125;) scale($&#123;scaleX&#125;,$&#123;scaleY&#125;) translate($&#123;revisedX&#125;,$&#123;revisedY&#125;)`</span> &#125;</code></pre><p>ä¾‹å¦‚ä¸€ä¸ªç¼©æ”¾ä¸º2å€ï¼Œ</p><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> r3 = <span class="hljs-keyword">new</span> Rect(&#123;  x: <span class="hljs-number">50</span>,  y: <span class="hljs-number">50</span>,  width: <span class="hljs-number">100</span>,  height: <span class="hljs-number">50</span>,  scale: [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>],  transformOrigin: [<span class="hljs-number">50</span>, <span class="hljs-number">25</span>],&#125;)</code></pre><p>å¯¹åº”äºç¼©æ”¾çš„å˜æ¢åº”è¯¥æ˜¯ <code>scale(2,2) translate(-25,-12.5)</code>ï¼Œå†åŠ ä¸Šå…ƒç´ æœ¬èº«çš„ä½ç§»ï¼Œæœ€åå¾—åˆ°ï¼š</p><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"r3"</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">"translate(50,50) scale(2,2) translate(-25,-12.5)"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"50"</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre><p>å˜æ¢è¿‡ç¨‹ç¤ºæ„:</p><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/trans-demo-1.svg" alt="å˜æ¢è¿‡ç¨‹ç¤ºæ„" title="å˜æ¢è¿‡ç¨‹ç¤ºæ„"><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ul><li><a href="https://www.sarasoueidan.com/blog/svg-coordinate-systems/" target="_blank" rel="noopener">svg-coordinate-systems</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä¸è¦ä½¿ç”¨-transform-origin-å±æ€§&quot;&gt;ä¸è¦ä½¿ç”¨ transform-origin å±æ€§&lt;/h2&gt;
&lt;p&gt;SVG æ”¯æŒ &lt;code&gt;transform&lt;/code&gt;ï¼Œè€Œä¸”å†™æ³•ä¼¼ä¹ä¸ CSS ä¸­ç›¸åŒï¼Œä½†æ˜¯å®ƒçš„&lt;a href=&quot;https://www.w3
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="SVG" scheme="http://hikerpig.github.io/tags/SVG/"/>
    
  </entry>
  
  <entry>
    <title>Goodbye My Santa Monica Dream ğŸµ</title>
    <link href="http://hikerpig.github.io/2018/07/31/2018-07-31-Goodbye%20My%20Santa%20Monica%20Dream/"/>
    <id>http://hikerpig.github.io/2018/07/31/2018-07-31-Goodbye My Santa Monica Dream/</id>
    <published>2018-07-30T16:00:00.000Z</published>
    <updated>2018-08-26T08:49:59.529Z</updated>
    
    <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&amp;id=30496500&amp;auto=1&amp;height=66"></iframe><p>ä»ã€ŠLife is strangeã€‹çš„åŸå£°å¸¦ä¸­å‘ç°çš„ç‘°å®ï¼Œæ¥è‡ªæ¾³å¤§åˆ©äºšçš„å…„å¦¹ç»„åˆ <a href="https://music.douban.com/musician/100215/" target="_blank" rel="noopener">Angus &amp; Julia Stone</a> çš„ä¸€é¦–ç•¥æ˜¾å¿§ä¼¤çš„æ›²å­ï¼Œä»–ä¿©å‰å‡ å¹´çš„æ›²é£ï¼Œå°æ¸…æ–°ä¸­å¸¦ç€äº›è®¸è¿·å¹»ã€‚å¦¹å¦¹å£°éŸ³ç©ºçµæ…µæ‡’ï¼ŒåƒåŠ å·çš„æµ·é£ï¼Œæ£•æ¦ˆå¶é—´æ–‘é©³çš„é˜³å…‰ï¼Œå’Œæ­Œè¯ç‰¹åˆ«é…ã€‚</p><p>åŸæ›²ä½¿ç”¨ Open D è°ƒå¼¦ï¼Œå˜è°ƒå¤¹ 3 å“ï¼Œæ„Ÿè°¢ <a href="http://www.goliathguitartutorials.com" target="_blank" rel="noopener">Goliath Guitar</a> åœ¨ <a href="https://www.youtube.com/watch?v=sOJMMpdWScM" target="_blank" rel="noopener">Youtube ä¸Šçš„æ•™ç¨‹</a>ï¼Œè®²è§£è¯¦ç»†ï¼Œä¹Ÿç»™å‡ºäº†è¿˜åŸåº¦å‡ ä¹ 100% çš„ä¼´å¥è°±å­ï¼Œè€Œä¸”éå¸¸å¥½å¼¹ã€‚pdf è°±ä¾‹å¯ä»¥<a href="http://www.goliathguitartutorials.com/santa-monica-dream.html" target="_blank" rel="noopener">å»è¿™é‡Œä¸‹è½½</a>ã€‚</p><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/tabs/santa_monica_dream_-_angus_and_julia.jpg" alt="undefined" title="undefined">]]></content>
    
    <summary type="html">
    
      
      
        &lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;amp
      
    
    </summary>
    
      <category term="æ‚è®°" scheme="http://hikerpig.github.io/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
      <category term="å‰ä»–" scheme="http://hikerpig.github.io/tags/%E5%90%89%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title>Vuex æ¨¡å—åŠ¨æ€æ³¨å†Œçš„ä¸€äº›å®è·µç»éªŒ</title>
    <link href="http://hikerpig.github.io/2018/07/03/2018-07-03-Vuex-Dynamic-Module-Hints/"/>
    <id>http://hikerpig.github.io/2018/07/03/2018-07-03-Vuex-Dynamic-Module-Hints/</id>
    <published>2018-07-02T16:00:00.000Z</published>
    <updated>2019-01-07T05:50:06.415Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1><p>æ„å»ºå¤§å‹ SPA åº”ç”¨æ—¶ï¼Œä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¼˜åŒ–æ‰‹æ®µï¼Œåœ¨ Vue ç”Ÿæ€ä¸‹ï¼Œä½¿ç”¨ vue-router å¾ˆå®¹æ˜“å®ç°ç»„ä»¶çš„æ‡’åŠ è½½ã€‚</p><p>ä½†åº”ç”¨é‡Œé™¤äº†ç»„ä»¶ï¼Œè¿˜æœ‰åºå¤§çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿™éƒ¨åˆ†å¦‚ä½•åˆ†å‰²å’Œæ‡’åŠ è½½æ¯”è¾ƒåˆé€‚å‘¢ï¼Ÿ</p><p>ä½¿ç”¨ Vuex ç®¡ç†çŠ¶æ€çš„è¯ï¼Œå…¶æä¾›äº†æ–¹æ³• <code>registerModule</code> ç”¨äº<a href="https://vuex.vuejs.org/guide/modules.html#dynamic-module-registration" target="_blank" rel="noopener">åŠ¨æ€æ³¨å†Œ</a> Moduleã€‚</p><p>å› æ­¤æŸä¸ªé¡µé¢ç‹¬æœ‰çš„ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€ç®¡ç†ï¼Œåœ¨åˆå§‹åŒ–å…¨å±€ store çš„æ—¶å€™å¯ä»¥ä¸ç”¨å¼•å…¥ï¼Œä¹‹ååœ¨è¯¥é¡µé¢è·¯ç”±ç»„ä»¶ä¸­å†å¼•å…¥å’Œæ³¨å†Œ Vuex æ¨¡å—ã€‚</p><h1 id="ç®€å•çš„ç¤ºä¾‹">ç®€å•çš„ç¤ºä¾‹</h1><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> PageA = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./views/PageA.js'</span>)<span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> VueRouter(&#123;  <span class="hljs-attr">routes</span>: [    &#123; <span class="hljs-attr">path</span>: <span class="hljs-string">'/page-a'</span>, <span class="hljs-attr">component</span>: PageA &#125;  ]&#125;)</code></pre><p>ç®€å•çš„ Vuex æ¨¡å—ï¼š</p><pre><code class="hljs javascript"><span class="hljs-comment">// store/modules/page-a.js</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> VUEX_NS = <span class="hljs-string">'page-a'</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">namespaced</span>: <span class="hljs-literal">true</span>,  state() &#123;    <span class="hljs-keyword">return</span> &#123;      <span class="hljs-attr">inventory</span>: &#123;        <span class="hljs-attr">list</span>: []      &#125;    &#125;  &#125;,  <span class="hljs-attr">getters</span>: &#123;    inventoryList(state) &#123;      <span class="hljs-keyword">return</span> state.inventory.list    &#125;  &#125;&#125;</code></pre><p>å®è·µæ—¶é­é‡äº†å‡ ä¸ªé—®é¢˜ï¼š</p><h2 id="é—®é¢˜-1æœåŠ¡å™¨å®¢æˆ·ç«¯-åœ¨å°šæœªæ³¨å†Œ-module-æ—¶è°ƒç”¨å…¶ä¸‹çš„-actionmutation-vuex-å› æ‰¾ä¸åˆ°å¯¹åº”å‡½æ•°è€Œå‡ºé”™">é—®é¢˜ 1ï¼šæœåŠ¡å™¨/å®¢æˆ·ç«¯ åœ¨å°šæœªæ³¨å†Œ Module æ—¶ï¼Œè°ƒç”¨å…¶ä¸‹çš„ action/mutation ï¼ŒVuex å› æ‰¾ä¸åˆ°å¯¹åº”å‡½æ•°è€Œå‡ºé”™</h2><pre><code class="hljs javascript"><span class="hljs-comment">// views/PageA.js</span><span class="hljs-keyword">import</span> PAGE_A_MODULE, &#123; VUEX_NS &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'store/modules/page-a'</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">'PageA'</span>,  beforeCreate() &#123;    <span class="hljs-keyword">this</span>.$store.registerModule(VUEX_NS, PAGE_A_MODULE)    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$store.dispatch(<span class="hljs-string">`<span class="hljs-subst">$&#123;VUEX_NS&#125;</span>/fetchInventory`</span>)  &#125;,&#125;</code></pre><h3 id="è€ƒè™‘æœåŠ¡å™¨ç«¯é¢„å–æ•°æ®æ³¨å…¥ç»™å®¢æˆ·ç«¯çš„æ—¶å€™">è€ƒè™‘æœåŠ¡å™¨ç«¯é¢„å–æ•°æ®æ³¨å…¥ç»™å®¢æˆ·ç«¯çš„æ—¶å€™</h3><p>å®¢æˆ·ï¼ˆæµè§ˆå™¨ï¼‰ç«¯åˆå§‹åŒ–ä»£ç ï¼Œåœ¨åˆå§‹åŒ– router ä¹‹å‰ï¼Œç»™ Vuex å…¨å±€ store æ³¨å…¥æ•°æ®ï¼š</p><pre><code class="hljs js"><span class="hljs-comment">// entry-client.js</span>store.replaceState(<span class="hljs-built_in">window</span>.__INITIAL_STATE__)</code></pre><p>æ­¤å¤„çš„ <code>__INITIAL_STATE__</code> æ˜¯ Vue SSR æä¾›çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œä½¿å¾—æµè§ˆå™¨ç«¯å¯ä»¥å¤ç”¨æœåŠ¡å™¨ç«¯å·²ç»é¢„å–è¿‡çš„æ•°æ®ã€‚</p><pre><code class="hljs js"><span class="hljs-comment">// åœ¨æ‰€æœ‰é¢„å–é’©å­(preFetch hook) resolve åï¼Œ</span><span class="hljs-comment">// æˆ‘ä»¬çš„ store ç°åœ¨å·²ç»å¡«å……å…¥æ¸²æŸ“åº”ç”¨ç¨‹åºæ‰€éœ€çš„çŠ¶æ€ã€‚</span><span class="hljs-comment">// å½“æˆ‘ä»¬å°†çŠ¶æ€é™„åŠ åˆ°ä¸Šä¸‹æ–‡ï¼Œ</span><span class="hljs-comment">// å¹¶ä¸” `template` é€‰é¡¹ç”¨äº renderer æ—¶ï¼Œ</span><span class="hljs-comment">// çŠ¶æ€å°†è‡ªåŠ¨åºåˆ—åŒ–ä¸º `window.__INITIAL_STATE__`ï¼Œå¹¶æ³¨å…¥ HTMLã€‚</span>context.state = store.state</code></pre><p>æ­¤å¤„çš„ <code>asyncData</code> ä¸ <a href="https://ssr.vuejs.org/zh/guide/data.html#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%8F%96%E5%AD%98%E5%82%A8%E5%AE%B9%E5%99%A8-data-store" target="_blank" rel="noopener">Vue SSR æ–‡æ¡£ä¸­çš„ä¾‹å­</a>ç±»ä¼¼ï¼Œä¸ Nuxt.js ä¸­çš„åŒåå‡½æ•°ç”¨æ³•ç•¥æœ‰ä¸åŒã€‚</p><p><code>prepareVuex</code> ä¸ºè‡ªå®šä¹‰çš„ç»„ä»¶é’©å­å‡½æ•°ï¼Œä¼šå…ˆäº asyncData è°ƒç”¨ï¼Œå…·ä½“è¿‡ç¨‹ä¹‹åæ¢è®¨ã€‚</p><pre><code class="hljs diff"> export default &#123;   name: 'PageA',<span class="hljs-deletion">-  beforeCreate() &#123;</span><span class="hljs-deletion">-    this.$store.registerModule(VUEX_NS, PAGE_A_MODULE)</span><span class="hljs-deletion">-    return this.$store.dispatch(`$&#123;VUEX_NS&#125;/fetchInventory`)</span><span class="hljs-addition">+  prepareVuex(&#123; store &#125;) &#123;</span><span class="hljs-addition">+    store.registerModule(VUEX_NS, PAGE_A_MODULE)</span><span class="hljs-addition">+  &#125;,</span><span class="hljs-addition">+  asyncData(&#123; store &#125;) &#123;</span><span class="hljs-addition">+    return store.dispatch(`$&#123;VUEX_NS&#125;/fetchInventory`)</span>   &#125;, &#125;</code></pre><p>æ­¤æ—¶ä¼šé‡è§</p><h2 id="é—®é¢˜2-å®¢æˆ·ç«¯æ²¡æœ‰ç”¨ä¸ŠæœåŠ¡å™¨ç«¯é¢„å–çš„æ•°æ®">é—®é¢˜2: å®¢æˆ·ç«¯æ²¡æœ‰ç”¨ä¸ŠæœåŠ¡å™¨ç«¯é¢„å–çš„æ•°æ®</h2><p>è§£å†³æ–¹å¼ï¼š</p><pre><code class="hljs diff"> export default &#123;   name: 'PageA',<span class="hljs-deletion">-  prepareVuex(&#123; store &#125;) &#123;</span><span class="hljs-deletion">-    store.registerModule(VUEX_NS, PAGE_A_MODULE)</span><span class="hljs-addition">+  prepareVuex(&#123; store, isClientInitialRoute &#125;) &#123;</span><span class="hljs-addition">+    store.registerModule(VUEX_NS, PAGE_A_MODULE, &#123; preserveState: isClientInitialRoute &#125;)</span>   &#125;,   asyncData(&#123; store &#125;) &#123;     return store.dispatch(`$&#123;VUEX_NS&#125;/fetchInventory`)   &#125;,<span class="hljs-addition">+  beforeDestroy() &#123;</span><span class="hljs-addition">+    // é”€æ¯è¯¥æ¨¡å—</span><span class="hljs-addition">+    this.$store.unregisterModule(VUEX_NS)</span><span class="hljs-addition">+  &#125;</span> &#125;</code></pre><p>æ³¨å†Œ Vuex æ¨¡å—çš„æ—¶å€™ä½¿ç”¨äº† <code>preserveState</code> ï¼Œè‹¥å¯ç”¨æ­¤é€‰é¡¹ï¼Œæ³¨å†Œ Module æ—¶è‹¥ <code>store.state[namespace]</code> ä¸‹å·²å­˜åœ¨æ•°æ®ï¼Œä¾¿ä¸ä¼šä½¿ç”¨å£°æ˜ vuex æ¨¡å—æ—¶çš„åˆå§‹ state è¦†ç›–å·²æœ‰æ•°æ®ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œè‹¥ state ä¸­æ²¡æœ‰ namespace ç›¸åº”æ•°æ®å´å¼€å¯äº†æ­¤é€‰é¡¹ï¼ŒVuex è¿˜æ˜¯ä¼šæŠ¥é”™ã€‚å› æ­¤æ­¤å¤„æ·»åŠ äº†ä¸€ä¸ªè¾“å…¥å‚æ•° <code>isClientInitialRoute</code> ï¼Œ åªæœ‰åœ¨å®¢æˆ·ç«¯åˆæ¬¡è¿›å…¥é¡µé¢ï¼ˆå¯ä»¥ä½¿ç”¨æœåŠ¡å™¨é¢„å–æ•°æ®ï¼‰æ—¶æ‰å¼€å¯ <code>preserveState</code> é€‰é¡¹ã€‚</p><h2 id="é—®é¢˜3-ç»„ä»¶çƒ­æ›´æ–°æ—¶vuex-æ¨¡å—è¢«é”€æ¯">é—®é¢˜3: ç»„ä»¶çƒ­æ›´æ–°æ—¶ï¼ŒVuex æ¨¡å—è¢«é”€æ¯</h2><p>å¼€å‘æœŸé—´ä½¿ç”¨ HotModuleReplacementPlugin å’Œ vue-loaderï¼Œè‹¥æ”¹å˜äº† PageA.js ä¸­çš„ä»£ç ï¼Œä¼šè§¦å‘çƒ­æ›´æ–°ã€‚åœ¨ <a href="https://github.com/vuejs/vue-hot-reload-api/blob/master/src/index.js" target="_blank" rel="noopener">vue-hot-reload-api</a> ä¸­ï¼Œå½“ä½¿ç”¨ vue-hot-reload-api çš„ <code>reload</code> æ–¹æ³•å¤„ç†ç»„ä»¶å®ä¾‹æ—¶ï¼Œè¯¥å®ä¾‹ä¼šè¢«é”€æ¯è€Œåé‡æ–°åˆ›å»ºã€‚<code>beforeDestroy</code> ä¸­é”€æ¯äº† Vuex çš„ <code>page-a</code> æ¨¡å—ï¼Œå´æ²¡æœ‰è°ƒç”¨ <code>prepareVuex</code> æ–¹æ³•é‡æ–°æ³¨å†Œï¼Œå› æ­¤çƒ­æ›´æ–°ä¹‹åï¼Œä½¿ç”¨è¯¥æ¨¡å—ä¹Ÿä¼šæŠ¥é”™ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><pre><code class="hljs diff">   asyncData(&#123; store &#125;) &#123;     return store.dispatch(`$&#123;VUEX_NS&#125;/fetchInventory`)   &#125;,<span class="hljs-deletion">-  beforeDestroy() &#123;</span><span class="hljs-deletion">-    // é”€æ¯è¯¥æ¨¡å—</span><span class="hljs-deletion">-    this.$store.unregisterModule(VUEX_NS)</span><span class="hljs-addition">+  beforeRouteLeave(to, from, next) &#123;</span><span class="hljs-addition">+    this.$once('hook:beforeDestroy', () =&gt; &#123;</span><span class="hljs-addition">+      // é”€æ¯è¯¥æ¨¡å—</span><span class="hljs-addition">+      this.$store.unregisterModule(VUEX_NS)</span><span class="hljs-addition">+    &#125;)</span><span class="hljs-addition">+    next()</span>   &#125; &#125;</code></pre><p>ä»”ç»†æƒ³æƒ³ï¼Œæ³¨å†Œæ¨¡å—çš„æ—¶æœºæ˜¯ä¸è·¯ç”±ç›¸å…³çš„ï¼ˆè¿›å…¥é¡µé¢ä¹‹å‰ï¼‰ï¼Œé‚£ä¹ˆé”€æ¯çš„æ—¶æœºä¹Ÿå¯ä»¥ä¸è·¯ç”±ç›¸å…³ã€‚ä¸è¿‡å¹¶ä¸é€‚åˆåœ¨ <code>beforeRouteLeave</code> é’©å­ä¸­ç«‹åˆ»é”€æ¯æ¨¡å—ã€‚å› ä¸ºæ ¹æ®ä»¥ä¸‹ vue-router æ–‡æ¡£å†…å®¹ï¼Œåœ¨æ­¤é’©å­è¢«è°ƒç”¨å®Œæˆæ—¶ï¼Œæ•´ä¸ªé¡µé¢è¿˜æ˜¯åœ¨æ­£å¸¸å·¥ä½œçš„ï¼ˆç¬¬2æ­¥åˆ°ç¬¬11æ­¥ä¸­é—´ï¼‰ï¼Œä»æœªè¿›å…¥ç»„ä»¶çš„ destroy è¿‡ç¨‹ï¼Œæ­¤æ—¶é”€æ¯æ¨¡å—ä¼šå¯¼è‡´ä¾èµ–å…¶çš„æ‰€æœ‰ç»„ä»¶å¼‚å¸¸ã€‚</p><blockquote><p><cite><a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%AE%8C%E6%95%B4%E7%9A%84%E5%AF%BC%E8%88%AA%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B" target="_blank" rel="noopener">vue-router æ–‡æ¡£ä¸­å…³äºå¯¼èˆªè§£ææµç¨‹çš„éƒ¨åˆ†</a></cite></p><ol type="1"><li>å¯¼èˆªè¢«è§¦å‘ã€‚</li><li>åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ç¦»å¼€å®ˆå«ã€‚</li><li>è°ƒç”¨å…¨å±€çš„ beforeEach å®ˆå«ã€‚</li><li>åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå« (2.2+)ã€‚</li><li>åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ beforeEnterã€‚</li><li>è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚</li><li>åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteEnterã€‚</li><li>è°ƒç”¨å…¨å±€çš„ beforeResolve å®ˆå« (2.5+)ã€‚</li><li>å¯¼èˆªè¢«ç¡®è®¤ã€‚</li><li>è°ƒç”¨å…¨å±€çš„ afterEach é’©å­ã€‚</li><li>è§¦å‘ DOM æ›´æ–°ã€‚</li><li>ç”¨åˆ›å»ºå¥½çš„å®ä¾‹è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°ã€‚</li></ol></blockquote><p>å› æ­¤å®‰å…¨çš„æ¨¡å—é”€æ¯æ—¶æœºéœ€è¦åœ¨ DOM æ›´æ–°ä¸­æˆ–åï¼Œæ—§çš„é¡µé¢ç»„ä»¶å®ä¾‹é”€æ¯è¿‡ç¨‹è°ƒç”¨æ—¶ã€‚</p><h1 id="ç›¸å…³ä»£ç ">ç›¸å…³ä»£ç </h1><p>æœ€åçš„ PageA.jsï¼š</p><pre><code class="hljs js"><span class="hljs-keyword">import</span> PAGE_A_MODULE, &#123; VUEX_NS &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'store/modules/page-a'</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">'PageA'</span>,  prepareVuex(&#123; store, isClientInitialRoute &#125;) &#123;    store.registerModule(VUEX_NS, PAGE_A_MODULE, &#123; <span class="hljs-attr">preserveState</span>: isClientInitialRoute &#125;)  &#125;,  asyncData(&#123; store &#125;) &#123;    <span class="hljs-keyword">return</span> store.dispatch(<span class="hljs-string">`<span class="hljs-subst">$&#123;VUEX_NS&#125;</span>/fetchInventory`</span>)  &#125;,  beforeRouteLeave(to, <span class="hljs-keyword">from</span>, next) &#123;    <span class="hljs-keyword">this</span>.$once(<span class="hljs-string">'hook:beforeDestroy'</span>, () =&gt; &#123;      <span class="hljs-comment">// é”€æ¯è¯¥æ¨¡å—</span>      <span class="hljs-keyword">this</span>.$store.unregisterModule(VUEX_NS)    &#125;)    next()  &#125;&#125;</code></pre><p>ä¸¤ç«¯çš„å…¥å£æ–‡ä»¶ä¸­ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs typescript"><span class="hljs-comment">// router-util.ts</span><span class="hljs-keyword">import</span> Vue, &#123; VueConstructor &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><span class="hljs-keyword">type</span> VueCtor = VueConstructor&lt;<span class="hljs-built_in">any</span>&gt;<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHookFromComponent</span>(<span class="hljs-params">compo: <span class="hljs-built_in">any</span>, name: <span class="hljs-built_in">string</span></span>) </span>&#123;  <span class="hljs-keyword">return</span> compo[name] || (compo.options &amp;&amp; compo.options[name])&#125;<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callComponentsHookWith</span>(<span class="hljs-params">compoList: VueCtor[], hookName: <span class="hljs-built_in">string</span>, context: <span class="hljs-built_in">any</span></span>) </span>&#123;  <span class="hljs-keyword">return</span> compoList.map(<span class="hljs-function">(<span class="hljs-params">component</span>) =&gt;</span> &#123;    <span class="hljs-keyword">const</span> hook = getHookFromComponent(component, hookName)    <span class="hljs-keyword">if</span> (hook) &#123;      <span class="hljs-keyword">return</span> hook(context)    &#125;  &#125;).filter(_ =&gt; _)&#125;</code></pre><pre><code class="hljs js"><span class="hljs-comment">// entry-server.js</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> context =&gt; &#123;  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;    <span class="hljs-comment">// set router's location</span>    router.push(context.url)    router.onReady(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;      <span class="hljs-keyword">const</span> matchedComponents = router.getMatchedComponents()      <span class="hljs-keyword">try</span> &#123;        <span class="hljs-comment">// åŠ ä¸Š try/catch é¿å…æ­¤ block å†…æŠ›å‡ºçš„é”™è¯¯é€ æˆ promise unhandledRejection</span>        callComponentsHookWith(matchedComponents, <span class="hljs-string">'prepareVuex'</span>, &#123; store &#125;)        <span class="hljs-keyword">const</span> asyncDataResults = callComponentsHookWith(matchedComponents, <span class="hljs-string">'asyncData'</span>,          &#123;            store,            <span class="hljs-attr">route</span>: router.currentRoute,          &#125;        )        <span class="hljs-built_in">Promise</span>.all(asyncDataResults).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;          context.state = store.state          resolve(app)        &#125;).catch(reject)      &#125; <span class="hljs-keyword">catch</span>(err) &#123;        reject(err)      &#125;    &#125;, reject)  &#125;)&#125;</code></pre><pre><code class="hljs js"><span class="hljs-comment">// entry-client.js</span>router.onReady(<span class="hljs-function">(<span class="hljs-params">initialRoute</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> initialMatched = router.getMatchedComponents(initialRoute)  callComponentsHookWith(initialMatched, <span class="hljs-string">'prepareVuex'</span>, &#123; store, <span class="hljs-attr">isClientInitialRoute</span>: <span class="hljs-literal">true</span> &#125;)  router.beforeResolve(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> &#123;    <span class="hljs-keyword">const</span> matched = router.getMatchedComponents(to)    callComponentsHookWith(matched, <span class="hljs-string">'prepareVuex'</span>, &#123; store &#125;)    <span class="hljs-built_in">Promise</span>.all(callComponentsHookWith(activated, <span class="hljs-string">'asyncData'</span>, &#123; store, <span class="hljs-attr">route</span>: to &#125;))      .then(next)      .catch(next)  &#125;)  <span class="hljs-comment">// actually mount to DOM</span>  app.$mount(<span class="hljs-string">'#app'</span>)&#125;)</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æ„å»ºå¤§å‹ SPA åº”ç”¨æ—¶ï¼Œä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¼˜åŒ–æ‰‹æ®µï¼Œåœ¨ Vue ç”Ÿæ€ä¸‹ï¼Œä½¿ç”¨ vue-router å¾ˆå®¹æ˜“å®ç°ç»„ä»¶çš„æ‡’åŠ è½½ã€‚&lt;/p&gt;
&lt;p&gt;ä½†åº”ç”¨é‡Œé™¤äº†ç»„ä»¶ï¼Œè¿˜æœ‰åºå¤§çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿™éƒ¨åˆ†å¦‚ä½•åˆ†å‰²å’Œæ‡’åŠ è½½æ¯”è¾ƒåˆé€‚å‘¢ï¼Ÿ&lt;/p&gt;

      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Vue" scheme="http://hikerpig.github.io/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>Try Rust WebAssembly</title>
    <link href="http://hikerpig.github.io/2018/05/03/2018-05-03-Try-Rust-Webassemly/"/>
    <id>http://hikerpig.github.io/2018/05/03/2018-05-03-Try-Rust-Webassemly/</id>
    <published>2018-05-02T16:00:00.000Z</published>
    <updated>2018-08-26T08:50:19.060Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å…¬å¸é¡¹ç›®é‡Œçš„ä¸€ä¸ªå°è§’è½ï¼Œå°è¯•ä½¿ç”¨ Rust + WebAssembly åŠ é€Ÿåº”ç”¨é‡Œéƒ¨åˆ†è®¡ç®—</p><h2 id="é€‰æ‹©">é€‰æ‹©</h2><p>é¦–å…ˆè¦åˆ†æ¸…é¡¹ç›®é‡Œ WebAssembly çš„å®šä½</p><ol type="1"><li>åº”ç”¨ä¸»ä½“ï¼šå®Œæˆç»å¤§å¤šæ•°é€»è¾‘ï¼ŒJS åªä½œä¸ºåŠ è½½å…¥å£å’Œå°‘éƒ¨åˆ†äº‹ä»¶ç»‘å®šæ¡¥æ¢</li><li>å·¥å…·åº“ï¼šåˆ†æ‹…ä¸€äº›å¤æ‚å’Œè€—æ—¶çš„è®¡ç®—ï¼Œç”± JS å†³å®šä»€ä¹ˆæ—¶å€™è°ƒç”¨ wasm æ¨¡å—å‡½æ•°ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œç”± JS ç®¡ç† wasm çš„çº¿æ€§å†…å­˜</li></ol><p>æ­¤æ¬¡å° Demo å±äºç¬¬ 2 ç§æƒ…å†µ</p><h3 id="é€‰æ‹©-rust-target">é€‰æ‹© Rust Target</h3><p>rust æ”¯æŒ <code>wasm32-unknown-unknown</code> å’Œ <code>wasm32-unknown-emscripten</code> ä¸¤ç§ç¼–è¯‘ç›®æ ‡ï¼Œåè€…é™¤äº†wasm å¤–ï¼Œè¿˜ç”Ÿæˆäº† emscripten é£æ ¼çš„ JS ä½œä¸ºå…¥å£ï¼Œä¸ asm.js çš„è°ƒç”¨é£æ ¼ç»Ÿä¸€ã€‚ä¸è¿‡ä¼šæ·»åŠ å¥½äº›è¿è¡Œæ—¶ä»£ç ï¼Œä¸ wasm ä¹‹é—´ä¹Ÿéš”ç€ä¸€å±‚å°è£…ã€‚åŸºäºä¸Šä¸€é¡¹çš„é€‰æ‹©ï¼Œæˆ‘ä»¬é€‰æ‹©å‰è€…</p><pre><code class="hljs bash">rustup target add wasm32-unknown-unknown</code></pre><h1 id="webassembly-è€ƒé‡">WebAssembly è€ƒé‡</h1><h2 id="æ•°æ®ç±»å‹é—®é¢˜">æ•°æ®ç±»å‹é—®é¢˜</h2><p>WebAssembly å½“å‰åªæ”¯æŒå‡ ç§<a href="https://developer.mozilla.org/en-US/docs/WebAssembly/Understanding_the_text_format#Signatures_and_parameters" target="_blank" rel="noopener">æœ‰é™çš„æ•°å­—ç±»å‹</a>ï¼Œi32/i64/f32/f64ï¼ŒJS ä¸ä¹‹äº¤äº’æ—¶ï¼Œé™¤äº† number ä»¥å¤–çš„å€¼éƒ½è¦æœ‰åºåˆ—åŒ–/ååºåˆ—åŒ–å¤„ç†ã€‚</p><h3 id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</h3><p>å¯ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/TextEncoder" target="_blank" rel="noopener">TextEncoder/TextDecoder</a> å°† JS å­—ç¬¦ä¸²åºåˆ—åŒ–ä¸º utf-8 å­—èŠ‚æµï¼Œåœ¨ Rust ç«¯å…ˆå°†å­—èŠ‚æµè§£æä¸ºå­—ç¬¦ä¸²ï¼Œå†ä½¿ç”¨ã€‚</p><h3 id="æ•°ç»„">æ•°ç»„</h3><p>JS ç›´æ¥æ“ä½œ wasm ç¤ºä¾‹çš„å†…å­˜ï¼Œå°†æ•°ç»„æ•°æ®å†™å…¥ï¼Œè°ƒç”¨ wasm æ–¹æ³•æ—¶ï¼Œå°†æ•°ç»„èµ·å§‹çš„æŒ‡é’ˆä»¥åŠæ•°ç»„é•¿åº¦ä½œä¸ºå‚æ•°ã€‚</p><pre><code class="hljs rust"><span class="hljs-comment">// rust éƒ¨åˆ†</span><span class="hljs-keyword">pub</span> <span class="hljs-keyword">unsafe</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">load_image_data</span></span>(in_image_ptr: *<span class="hljs-keyword">mut</span> <span class="hljs-built_in">u8</span>, width: <span class="hljs-built_in">i32</span>, height: <span class="hljs-built_in">i32</span>) -\&gt; *<span class="hljs-keyword">const</span> <span class="hljs-built_in">u8</span> &#123;  <span class="hljs-keyword">let</span> arr_len = (width * height * <span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">usize</span>;  <span class="hljs-keyword">let</span> in_image_data = <span class="hljs-built_in">Vec</span>::from_raw_parts(in_image_ptr, arr_len, arr_len);  <span class="hljs-keyword">return</span> in_image_data.as_ptr();&#125;</code></pre><pre><code class="hljs ts"><span class="hljs-comment">// js éƒ¨åˆ†</span><span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">'2d'</span>)<span class="hljs-keyword">const</span> imageData = ctx.getImageData(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">50</span>)<span class="hljs-keyword">const</span> imgDataVecPtr = copyJsArrayToRust(<span class="hljs-keyword">this</span>.instanceExports, imageData.data)wasmExports.load_image_data(imgDataVecPtr, <span class="hljs-number">100</span>, <span class="hljs-number">50</span>)<span class="hljs-string">`</span></code></pre><h2 id="ä¸Šä»£ç ">ä¸Šä»£ç </h2><h3 id="rust-ç«¯">Rust ç«¯</h3><pre><code class="hljs rust"><span class="hljs-comment">// main.rs</span><span class="hljs-keyword">use</span> std::&#123;mem&#125;;<span class="hljs-keyword">use</span> std::ffi::CString;<span class="hljs-keyword">use</span> std::os::raw::&#123;c_char&#125;;<span class="hljs-keyword">extern</span> &#123;  <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">clog</span></span>(ptr: *<span class="hljs-keyword">const</span> <span class="hljs-built_in">u8</span>, number: <span class="hljs-built_in">usize</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">js_log</span></span>(s: <span class="hljs-built_in">String</span>) &#123;  <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> _s = s.clone();  <span class="hljs-keyword">unsafe</span> &#123;  <span class="hljs-keyword">let</span> m = _s.as_mut_vec().as_mut_ptr();  clog(m <span class="hljs-keyword">as</span> *<span class="hljs-keyword">const</span> <span class="hljs-built_in">u8</span>, _s.len());  &#125;&#125;<span class="hljs-meta">#[no_mangle]</span><span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">alloc</span></span>(size: <span class="hljs-built_in">usize</span>) -&gt; *<span class="hljs-keyword">const</span> <span class="hljs-built_in">u8</span> &#123;  <span class="hljs-keyword">let</span> buf = <span class="hljs-built_in">Vec</span>::with_capacity(size);  <span class="hljs-keyword">let</span> ptr = buf.as_ptr();  mem::forget(buf); <span class="hljs-comment">// è®© rust æ”¾å¼ƒå¯¹æ­¤æ®µå†…å­˜çš„æ§åˆ¶æƒï¼Œæ­¤å‡½æ•°ç»“æŸåè¯¥æ®µå†…å­˜å¯¹äº rust æ¥è¯´æ˜¯æ³„æ¼çš„çŠ¶æ€ï¼Œåˆ†é…å’Œç®¡ç†æƒäº¤ç»™ JS</span>  <span class="hljs-keyword">return</span> ptr;&#125;<span class="hljs-meta">#[no_mangle]</span><span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">log_something</span></span>(text_ptr: *<span class="hljs-keyword">mut</span> c_char) -&gt; *<span class="hljs-keyword">const</span> <span class="hljs-built_in">u8</span> &#123;  <span class="hljs-keyword">let</span> text = CString::from_raw(text_ptr).into_string().unwrap();  js_log(text);&#125;<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() &#123;&#125;  <span class="hljs-comment">// ç•™ä¸€ä¸ª main ç¡®ä¿ rust èƒ½æ­£å¸¸ç¼–è¯‘</span></code></pre><h3 id="js-ç«¯">JS ç«¯</h3><pre><code class="hljs ts"><span class="hljs-comment">// wasm-util.ts</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> ModuleExports &#123;  memory: WebAssembly.Memory  alloc(len: <span class="hljs-built_in">number</span>): WasmMemPtr  log_something(text_ptr: <span class="hljs-built_in">number</span>)&#125;<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadWebAssembly</span>&lt;<span class="hljs-title">T</span> <span class="hljs-title">extends</span> <span class="hljs-title">ModuleExports</span>&gt;(<span class="hljs-params">input: <span class="hljs-built_in">string</span>, imports: <span class="hljs-built_in">any</span></span>) </span>&#123;  <span class="hljs-comment">// Fetch the file and compile it</span>  <span class="hljs-keyword">return</span> fetch(input).then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.arrayBuffer())  .then(<span class="hljs-function"><span class="hljs-params">buffer</span> =&gt;</span> &#123;    <span class="hljs-comment">// Create the imports for the module, including the</span>    <span class="hljs-comment">// standard dynamic library imports</span>    imports = imports || &#123;&#125;    imports.env = imports.env || &#123;&#125;    <span class="hljs-keyword">if</span> (!imports.env.memory) &#123;  imports.env.memory = <span class="hljs-keyword">new</span> WebAssembly.Memory(&#123; initial: <span class="hljs-number">1</span> &#125;)    &#125;    <span class="hljs-comment">// Create the instance.</span>    <span class="hljs-keyword">return</span> WebAssembly.instantiate(buffer, imports)  &#125;)&#125;<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyJsStringToRust</span>(<span class="hljs-params"><span class="hljs-built_in">module</span>: ModuleExports, str: <span class="hljs-built_in">string</span></span>) </span>&#123;  <span class="hljs-keyword">const</span> utf8Encoder = <span class="hljs-keyword">new</span> TextEncoder()  <span class="hljs-keyword">const</span> string_buffer = utf8Encoder.encode(str)  <span class="hljs-keyword">const</span> len = string_buffer.length  <span class="hljs-keyword">const</span> ptr = <span class="hljs-built_in">module</span>.alloc(len + <span class="hljs-number">1</span>)  <span class="hljs-keyword">const</span> memory = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-built_in">module</span>.memory.buffer, ptr)  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;    memory[i] = string_buffer[i]  &#125;  memory[len] = <span class="hljs-number">0</span> <span class="hljs-comment">// cstring end</span>  <span class="hljs-keyword">return</span> ptr&#125;<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decodeRustString</span>(<span class="hljs-params"><span class="hljs-built_in">module</span>: ModuleExports, ptr: WasmMemPtr</span>) </span>&#123;  <span class="hljs-keyword">const</span> collectCString = <span class="hljs-function"><span class="hljs-keyword">function</span>*(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-keyword">const</span> memory = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-built_in">module</span>.memory.buffer)  <span class="hljs-keyword">while</span> (memory[ptr] !== <span class="hljs-number">0</span>) &#123;    <span class="hljs-keyword">if</span> (memory[ptr] === <span class="hljs-literal">undefined</span>) &#123;  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tried to read undef mem'</span>)    &#125;    <span class="hljs-keyword">yield</span> memory[ptr]    ptr += <span class="hljs-number">1</span>  &#125;  &#125;  <span class="hljs-keyword">const</span> buffer_as_u8 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(collectCString())  <span class="hljs-keyword">const</span> utf8Decoder = <span class="hljs-keyword">new</span> TextDecoder()  <span class="hljs-keyword">const</span> buffer_as_utf8 = utf8Decoder.decode(buffer_as_u8)  <span class="hljs-keyword">return</span> buffer_as_utf8&#125;<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copyJsArrayToRust</span>(<span class="hljs-params">exports: ModuleExports, arr: <span class="hljs-built_in">number</span>[] | <span class="hljs-built_in">Uint8ClampedArray</span></span>) </span>&#123;  <span class="hljs-keyword">const</span> &#123; memory, alloc &#125; = exports  <span class="hljs-keyword">const</span> rVecPtr = alloc(arr.length)  <span class="hljs-keyword">const</span> asBytes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(memory.buffer, rVecPtr, arr.length)  asBytes.set(arr)  <span class="hljs-keyword">return</span> rVecPtr&#125;</code></pre><p>demo.ts</p><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123;copyJsStringToRust, decodeRustString&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./wasm-util'</span><span class="hljs-keyword">const</span> importObj = &#123;  env: &#123;    clog: <span class="hljs-function">(<span class="hljs-params">ptr: WasmMemPtr, <span class="hljs-built_in">number</span>: <span class="hljs-built_in">number</span></span>) =&gt;</span> &#123;    <span class="hljs-keyword">const</span> str = decodeRustString(<span class="hljs-keyword">this</span>.rut.instanceExports, ptr)    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"[rust] "</span> + str)    &#125;,  &#125;&#125;loadWebAssembly(<span class="hljs-string">'demo.wasm'</span>).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;  <span class="hljs-keyword">const</span> strPtr = copyJsStringToRust(wasmExports, <span class="hljs-string">'Heyhey you you'</span>)  wasmExports.log_something(strPtr)&#125;)<span class="hljs-comment">// '[rust] Heyhey you you'</span></code></pre><h2 id="ç¼–è¯‘-wasm">ç¼–è¯‘ WASM</h2><pre><code class="hljs bash">cargo rustc --release --target=wasm32-unknown-unknown</code></pre><h2 id="wasm-ç˜¦èº«">WASM ç˜¦èº«</h2><p>å‚è§<a href="https://rust-lang-nursery.github.io/rust-wasm/game-of-life/code-size.html" title="WASM ç˜¦èº«" target="_blank" rel="noopener">æ­¤æ–‡</a></p><h3 id="cargo.toml-ä¸­ä¸€äº›è®¾å®š">Cargo.toml ä¸­ä¸€äº›è®¾å®š</h3><pre><code class="hljs undefined">[profile.release]debug = falselto = true</code></pre><h1 id="ä¾‹å­">ä¾‹å­</h1><ul><li><a href="https://www.hellorust.com/demos/" target="_blank" rel="noopener">Hello Rust</a></li><li>https://arkada38.github.io/2017/12/04/rust-wasm-string-to-uppercase/</li><li>https://stackoverflow.com/questions/49014610/passing-a-javascript-string-to-a-rust-function-compiled-to-webassembly</li><li><a href="https://kripken.github.io/blog/binaryen/2018/04/18/rust-emscripten.html" target="_blank" rel="noopener">Small WebAssembly Binaries with Rust + Emscripten</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨å…¬å¸é¡¹ç›®é‡Œçš„ä¸€ä¸ªå°è§’è½ï¼Œå°è¯•ä½¿ç”¨ Rust + WebAssembly åŠ é€Ÿåº”ç”¨é‡Œéƒ¨åˆ†è®¡ç®—&lt;/p&gt;
&lt;h2 id=&quot;é€‰æ‹©&quot;&gt;é€‰æ‹©&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆè¦åˆ†æ¸…é¡¹ç›®é‡Œ WebAssembly çš„å®šä½&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;åº”ç”¨ä¸»ä½“ï¼šå®Œæˆç»å¤§å¤šæ•°é€»è¾‘ï¼ŒJS
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="WebAssembly" scheme="http://hikerpig.github.io/tags/WebAssembly/"/>
    
      <category term="Rust" scheme="http://hikerpig.github.io/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ Jest å•å…ƒæµ‹è¯•åŸºäº Vue çš„é¡¹ç›®</title>
    <link href="http://hikerpig.github.io/2018/04/06/2018-04-06-Write-Vue-Tests-in-Jest/"/>
    <id>http://hikerpig.github.io/2018/04/06/2018-04-06-Write-Vue-Tests-in-Jest/</id>
    <published>2018-04-05T16:00:00.000Z</published>
    <updated>2018-08-26T08:50:26.662Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸ºä¸€ä¸ªåŸºäº Vue çš„é¡¹ç›®æ­å»ºæµ‹è¯•æ¡†æ¶ï¼Œæœ‰ä¸¤ä¸ªæ¯”è¾ƒæˆç†Ÿçš„é€‰æ‹©ï¼ŒMocha + Webpack + Karmaï¼Œæˆ–æ˜¯ Jestã€‚</p><p>å‰è€…ä¹Ÿæ˜¯ vue-cli é»˜è®¤è„šæ‰‹æ¶é‡Œçš„æµ‹è¯•æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä¹‹å‰çš„é¡¹ç›®ä¹Ÿç”¨äº†å®ƒï¼Œå®é™…ä½¿ç”¨èµ·æ¥ï¼Œæ„Ÿè§‰æˆä¹Ÿ Karmaï¼Œè´¥ä¹Ÿ Karmaï¼Œé…ç½®èµ·æ¥ä¸æ˜¯å¾ˆé¡ºæ‰‹ï¼Œå¯¼è‡´æµ‹è¯•å¿…é¡»åœ¨å®Œæ•´æ‰“åŒ…åæ‰èƒ½è¿›è¡Œï¼Œæµ‹è¯•æ—¶é—´éšç€ç”¨ä¾‹å¢åŠ é£é€Ÿå¢é•¿ã€‚è€Œä¸”è°ƒè¯•å•ä¸ªæµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™å†·å¯åŠ¨æ—¶é—´å¤ªé•¿ã€‚</p><p>æœ€åé‡‡ç”¨äº†åŠŸèƒ½å¼ºå¤§çš„ Jestã€‚</p><h2 id="å†™æµ‹è¯•">å†™æµ‹è¯•</h2><h3 id="æµ‹è¯•-vue-ç»„ä»¶">æµ‹è¯• Vue ç»„ä»¶</h3><p>å‚è§ Vue Cookbook ä¸­å…³äº<a href="https://vuejs.org/v2/cookbook/unit-testing-vue-components.html" target="_blank" rel="noopener">å•å…ƒæµ‹è¯•</a>çš„ä¸€ç« ï¼Œä»¥åŠ <a href="https://vue-test-utils.vuejs.org/en/" target="_blank" rel="noopener">vue test-utils çš„æ–‡æ¡£</a> ã€‚</p><h3 id="æ‹¦æˆªç½‘ç»œè¯·æ±‚">æ‹¦æˆªç½‘ç»œè¯·æ±‚</h3><p>ç”±äºç›®å‰è¯·æ±‚éƒ½é€šè¿‡ axiosï¼Œå¯ä»¥ç®€å•åœ°é€šè¿‡å¯¹ axios å¯¹è±¡çš„åŠ«æŒæ¥å®ç°è¿™ä¸€éœ€æ±‚ï¼Œè€ƒè™‘ <a href="https://github.com/ctimmerm/axios-mock-adapter" target="_blank" rel="noopener">axios-mock-adapter</a> æ’ä»¶ã€‚</p><h3 id="æ‹¦æˆªå®šæ—¶å™¨">æ‹¦æˆªå®šæ—¶å™¨</h3><p>çœ‹Jest æ–‡æ¡£çš„ <a href="https://facebook.github.io/jest/docs/en/timer-mocks.html" target="_blank" rel="noopener">Timer Mocks</a> ä¸€ç« ã€‚</p><h3 id="è‡ªå®šä¹‰-mock">è‡ªå®šä¹‰ Mock</h3><p>é‡‡ç”¨ Jest ä¸€æ–¹é¢æ˜¯å› ä¸ºå®ƒå…·æœ‰å¾ˆæ–¹ä¾¿çš„ Mock æ–¹æ¡ˆï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨æ¢æµ‹ <code>__mocks__</code> æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼Œä¾‹å¦‚å¦‚æœæ–°å»º <code>__mocks__/axios.js</code>ï¼Œæµ‹è¯•ä¸­æ‰€æœ‰æºç çš„ <code>require('axios')</code> è¿”å›çš„å¯¹è±¡éƒ½ä¼šæ˜¯è¯¥æ–‡ä»¶çš„å¯¼å‡ºå†…å®¹ã€‚è¯¦è§æ–‡æ¡£ä¸­çš„ <a href="https://facebook.github.io/jest/docs/en/manual-mocks.html" target="_blank" rel="noopener">Manual Mocks</a> ä¸€ç« ã€‚</p><h2 id="è°ƒè¯•æµ‹è¯•">è°ƒè¯•æµ‹è¯•</h2><p>ä»¥åœ¨ VSCode ä¸­ Debug çš„é…ç½®ä¸ºä¾‹ï¼Œä»¥ä¸‹ä¸º <code>.vscode/launch.json</code> ç¤ºä¾‹ï¼Œå‚è€ƒæ–‡ç« <a href="https://segmentfault.com/a/1190000011852541" target="_blank" rel="noopener">ã€Šåœ¨VS Codeä¸­è°ƒè¯•Jestå•å…ƒæµ‹è¯•ã€‹</a>ï¼š</p><pre><code class="hljs json">&#123;  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"0.2.0"</span>,  <span class="hljs-attr">"configurations"</span>: [    &#123;      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"node"</span>,      <span class="hljs-attr">"request"</span>: <span class="hljs-string">"launch"</span>,      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Debug Current Jest Test"</span>,      <span class="hljs-attr">"program"</span>: <span class="hljs-string">"$&#123;workspaceRoot&#125;/node_modules/jest/bin/jest"</span>,      <span class="hljs-attr">"cwd"</span>: <span class="hljs-string">"$&#123;workspaceRoot&#125;"</span>,      <span class="hljs-attr">"env"</span>: &#123;        <span class="hljs-attr">"NODE_ENV"</span>: <span class="hljs-string">"test"</span>      &#125;,      <span class="hljs-attr">"args"</span>: [<span class="hljs-string">"--runInBand"</span>, <span class="hljs-string">"--env=jsdom"</span>, <span class="hljs-string">"$&#123;fileBasename&#125;"</span>],      <span class="hljs-attr">"runtimeArgs"</span>: [        <span class="hljs-string">"--inspect-brk"</span>,      ],      <span class="hljs-attr">"sourceMaps"</span>: <span class="hljs-literal">true</span>,      <span class="hljs-attr">"console"</span>: <span class="hljs-string">"integratedTerminal"</span>,      <span class="hljs-attr">"internalConsoleOptions"</span>: <span class="hljs-string">"neverOpen"</span>,    &#125;,    &#123;      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"node"</span>,      <span class="hljs-attr">"request"</span>: <span class="hljs-string">"attach"</span>,      <span class="hljs-attr">"stopOnEntry"</span>: <span class="hljs-literal">false</span>,      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Attach to node inspect-brk"</span>,      <span class="hljs-attr">"port"</span>: <span class="hljs-number">9229</span>    &#125;,  ]&#125;</code></pre><h3 id="ä½¿ç”¨-vscode-å¯åŠ¨æµ‹è¯•">ä½¿ç”¨ VSCode å¯åŠ¨æµ‹è¯•</h3><p>args ä¸­çš„ <code>--runInBand</code> å’Œ <code>--env=jsdom</code> éƒ½æ˜¯ Jest çš„é…ç½®é¡¹ï¼Œè¯¦ç»†çš„å¯æŸ¥é˜… <a href="https://facebook.github.io/jest/docs/en/cli.html" target="_blank" rel="noopener">jest cli æ–‡æ¡£</a></p><p><code>${fileBasename}</code> ä¸º VSCode é…ç½®æä¾›çš„å˜é‡ï¼Œåœ¨æ­¤å¤„è¡¨æ˜åªè®© Jest è¿è¡Œå½“å‰æ‰“å¼€æ–‡ä»¶æè¿°çš„ç”¨ä¾‹ã€‚</p><h3 id="é€šè¿‡è°ƒè¯•åè®®è¿æ¥è¿›ç¨‹">é€šè¿‡è°ƒè¯•åè®®è¿æ¥è¿›ç¨‹</h3><p>å¯ä»¥ä¸é€šè¿‡ VSCodeï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨å‘½ä»¤ <code>node --inspect=9229 --inspect-brk ./node_modules/.bin/jest  --runInBand</code> è¿è¡Œ jestï¼Œ</p><p>ç¬¬äºŒä¸ªé…ç½®(request ä¸º â€˜attachâ€™)ï¼Œè¿æ¥ä¸€ä¸ªå¼€æ”¾ 9229 ä¸ºè°ƒè¯•ç«¯å£çš„å·²ç»åœ¨è¿è¡Œçš„ node è¿›ç¨‹ã€‚</p><p>æ­¤ç§æ–¹å¼å¯é€‰æ‹©å…¶ä»–å®ç°äº†è¿œç¨‹è°ƒè¯•åè®®çš„IDEï¼ˆä¾‹å¦‚ Webstormï¼‰æˆ–æµè§ˆå™¨ï¼ˆä¾‹å¦‚ <a href="https://zhuanlan.zhihu.com/p/30264842" target="_blank" rel="noopener">chrome://inspect</a> ï¼‰æ¥å®ç°æ–­ç‚¹è°ƒè¯•ç­‰åŠŸèƒ½ã€‚</p><p>å…³äº Inspector åè®®å¯çœ‹<a href="https://zhuanlan.zhihu.com/p/30264842" target="_blank" rel="noopener">æ­¤æ–‡ç« </a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¸ºä¸€ä¸ªåŸºäº Vue çš„é¡¹ç›®æ­å»ºæµ‹è¯•æ¡†æ¶ï¼Œæœ‰ä¸¤ä¸ªæ¯”è¾ƒæˆç†Ÿçš„é€‰æ‹©ï¼ŒMocha + Webpack + Karmaï¼Œæˆ–æ˜¯ Jestã€‚&lt;/p&gt;
&lt;p&gt;å‰è€…ä¹Ÿæ˜¯ vue-cli é»˜è®¤è„šæ‰‹æ¶é‡Œçš„æµ‹è¯•æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä¹‹å‰çš„é¡¹ç›®ä¹Ÿç”¨äº†å®ƒï¼Œå®é™…ä½¿ç”¨èµ·æ¥ï¼Œæ„Ÿè§‰æˆä¹Ÿ Karmaï¼Œè´¥ä¹Ÿ Karmaï¼Œé…ç½®
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Test" scheme="http://hikerpig.github.io/tags/Test/"/>
    
      <category term="Vue" scheme="http://hikerpig.github.io/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Typescript ä¸­ç»§æ‰¿ Error å¯¹è±¡</title>
    <link href="http://hikerpig.github.io/2018/04/02/2018-04-02-Customize-Error-in-Typescript/"/>
    <id>http://hikerpig.github.io/2018/04/02/2018-04-02-Customize-Error-in-Typescript/</id>
    <published>2018-04-01T16:00:00.000Z</published>
    <updated>2018-08-26T08:50:49.156Z</updated>
    
    <content type="html"><![CDATA[<p>é€šè¿‡ Typescript class ç»§æ‰¿ Error å®ç°è‡ªå®šä¹‰é”™è¯¯ç±»å‹æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªå‘ã€‚</p><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> MyError <span class="hljs-keyword">extends</span> <span class="hljs-built_in">Error</span> &#123;&#125;</code></pre><p>ä½†æ˜¯è¿è¡Œèµ·æ¥ï¼š</p><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> err = <span class="hljs-keyword">new</span> MyError()err <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span> <span class="hljs-comment">// true</span>err <span class="hljs-keyword">instanceof</span> MyError  <span class="hljs-comment">// ç»“æœç«Ÿç„¶æ˜¯ false</span></code></pre><h2 id="åŸå› ">åŸå› </h2><p>ä½¿ç”¨ Babel/Typescript ç¼–è¯‘å‡ºçš„ä»£ç æœ‰ç±»ä¼¼çš„é—®é¢˜</p><p>Typescript 2.7.2 ç¼–è¯‘å‡ºçš„ä»£ç </p><pre><code class="hljs typescript"><span class="hljs-keyword">var</span> __extends = (<span class="hljs-keyword">this</span> &amp;&amp; <span class="hljs-keyword">this</span>.__extends) || (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-keyword">var</span> extendStatics = <span class="hljs-built_in">Object</span>.setPrototypeOf ||        (&#123; __proto__: [] &#125; <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span> &amp;&amp; <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d, b</span>) </span>&#123; d.__proto__ = b; &#125;) ||        <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d, b</span>) </span>&#123; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p <span class="hljs-keyword">in</span> b) <span class="hljs-keyword">if</span> (b.hasOwnProperty(p)) d[p] = b[p]; &#125;;    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">d, b</span>) </span>&#123;        extendStatics(d, b);        <span class="hljs-function"><span class="hljs-keyword">function</span> __(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">this</span>.constructor = d; &#125;        d.prototype = b === <span class="hljs-literal">null</span> ? <span class="hljs-built_in">Object</span>.create(b) : (__.prototype = b.prototype, <span class="hljs-keyword">new</span> __());    &#125;;&#125;)();<span class="hljs-keyword">var</span> MyError = <span class="hljs-comment">/** @class */</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">_super</span>) </span>&#123;    __extends(MyError, _super);    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyError</span>(<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-comment">// é—®é¢˜å…³é”®åœ¨è¿™é‡Œ</span>        <span class="hljs-keyword">return</span> _super !== <span class="hljs-literal">null</span> &amp;&amp; _super.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>) || <span class="hljs-keyword">this</span>;    &#125;    <span class="hljs-keyword">return</span> MyError;&#125;(<span class="hljs-built_in">Error</span>));</code></pre><p>åŸå› åœ¨äºï¼ŒError æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­˜åœ¨ï¼Œå³æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ã€‚ä»¥ä¸‹ä¸¤ç§è°ƒç”¨çš†å¯è¿”å› error objectã€‚</p><pre><code class="hljs js"><span class="hljs-built_in">Error</span>(<span class="hljs-string">'message'</span>)<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'message'</span>)</code></pre><p>é‚£ä¹ˆåœ¨è°ƒç”¨ä»¥ä¸‹å‡½æ•°æ—¶ï¼Œ_super ä¸º Errorï¼Œè¿”å›çš„å³æ˜¯ <code>Error(this, arguments)</code>ï¼Œè€Œä¸æ˜¯ <code>this</code> ã€‚</p><pre><code class="hljs typescript">_super !== <span class="hljs-literal">null</span> &amp;&amp; _super.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>) || <span class="hljs-keyword">this</span>;</code></pre><h2 id="åœ¨-typescript-ä¸­">åœ¨ Typescript ä¸­</h2><p>ç¿»äº†ç¿»æ–‡æ¡£ï¼ŒTypescript 2.1 çš„ä¸€äº› <a href="https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work" target="_blank" rel="noopener">breaking change</a> å¯¼è‡´å¯¹äºä¸€äº›åŸç”Ÿå¯¹è±¡(Error/Array/Map)çš„ç»§æ‰¿æ— æ³•æ­£å¸¸å·¥ä½œï¼Œåº”è¯¥å°±æ˜¯ç”± generated code çš„æ”¹å˜é€ æˆçš„ã€‚å®˜æ–¹ç»™å‡ºçš„ä¸€ä¸ªå»ºè®®æ˜¯ï¼š</p><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> FooError <span class="hljs-keyword">extends</span> <span class="hljs-built_in">Error</span> &#123;  <span class="hljs-keyword">constructor</span>(<span class="hljs-params">m: <span class="hljs-built_in">string</span></span>) &#123;    <span class="hljs-keyword">super</span>(m)    <span class="hljs-comment">// åœ¨ super ä¹‹åç«‹åˆ»è°ƒç”¨ï¼Œæ”¹å˜å®ä¾‹çš„ prototype.</span>    <span class="hljs-built_in">Object</span>.setPrototypeOf(<span class="hljs-keyword">this</span>, FooError.prototype)  &#125;&#125;</code></pre><p>ä½†æ˜¯è¿™ä¸ªå†™æ³•å…¶å®ç›¸å½“çš„å‚»ï¼Œå› ä¸ºå¯¹äºæ¯ä¸€ä¸ªå­ç±»çš„æ„å»ºå‡½æ•°æ¥è¯´ï¼Œåœ¨æ”¹å˜åŸå‹ä¹‹å‰ï¼Œæ˜¯æ— æ³•æ‹¿åˆ°æ­£ç¡®çš„å­ç±»å®ä¾‹ â€˜this.constructorâ€™ çš„ï¼Œæ‰€ä»¥ <code>Object.setPrototypeOf</code> éœ€è¦å‡ºç°åœ¨æ‰€æœ‰å­ç±»çš„æ„å»ºå‡½æ•°ä¸­ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2><p>åªå¥½æŠŠåŸå‹ç»§æ‰¿æ‹¿å›æ¥äº†ï¼Œæœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼š</p><pre><code class="hljs typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> ExtensibleError <span class="hljs-keyword">implements</span> <span class="hljs-built_in">Error</span> &#123;  message: <span class="hljs-built_in">string</span>  name: <span class="hljs-built_in">string</span>  <span class="hljs-keyword">constructor</span>(<span class="hljs-params">message?: <span class="hljs-built_in">string</span></span>) &#123;    <span class="hljs-built_in">Error</span>.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)    <span class="hljs-keyword">this</span>.message = message || <span class="hljs-string">''</span>    <span class="hljs-keyword">this</span>.name = <span class="hljs-keyword">this</span>.constructor.name    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Error</span>.captureStackTrace === <span class="hljs-string">'function'</span>) &#123;      <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.constructor)    &#125;  &#125;&#125;ExtensibleError.prototype = <span class="hljs-built_in">Object</span>.create(<span class="hljs-built_in">Error</span>.prototype)</code></pre><p>æ„å»ºä¸€ä¸ªä¸­é—´çš„è¾…åŠ©ç±»ï¼Œå¹¶ä¸ç›´æ¥é‡‡ç”¨ class ç»§æ‰¿ Errorï¼Œè€Œåªå®ç° Error æ¥å£ï¼Œé‡‡ç”¨åŸå‹ç»§æ‰¿ï¼Œæ­¤ç±»çš„ç¤ºä¾‹å¯ç»è¿‡ <code>instanceOf</code> çš„æ£€éªŒã€‚é€šè¿‡ <code>Error.captureStackTrac</code> åœ¨åˆå§‹åŒ–æ­¤ç±»å®ä¾‹æ—¶èƒ½å¤Ÿæ•è·è°ƒç”¨æ ˆã€‚</p><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> MyError <span class="hljs-keyword">extends</span> ExtensibleError &#123;&#125;<span class="hljs-keyword">const</span> err = <span class="hljs-keyword">new</span> MyError()err <span class="hljs-keyword">instanceof</span> ExtensibleError  <span class="hljs-comment">// true</span>err <span class="hljs-keyword">instanceof</span> MyError  <span class="hljs-comment">// true</span>err <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span> <span class="hljs-comment">// true</span></code></pre><p>å‚è€ƒ</p><ul><li><a href="https://github.com/thundernet8/Blog/issues/1" target="_blank" rel="noopener">Errorç»§æ‰¿è¸©å‘è®°</a></li><li><a href="https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work" target="_blank" rel="noopener">breaking change</a></li><li><a href="https://stackoverflow.com/questions/12915412/how-do-i-extend-a-host-object-e-g-error-in-typescript" target="_blank" rel="noopener">so ä¸Šçš„ä¸€ä¸ªç­”æ¡ˆ</a></li></ul>]]></content>
    
    <summary type="html">
    
      è·¨è¿‡ Error ç»§æ‰¿çš„å‘
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Javascript" scheme="http://hikerpig.github.io/tags/Javascript/"/>
    
      <category term="Typescript" scheme="http://hikerpig.github.io/tags/Typescript/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Typescript ä¸­ä½¿ç”¨å¯è¢«å¤ç”¨çš„ Vue Mixin</title>
    <link href="http://hikerpig.github.io/2018/01/21/2018-01-21-typed-vue-mixins/"/>
    <id>http://hikerpig.github.io/2018/01/21/2018-01-21-typed-vue-mixins/</id>
    <published>2018-01-20T16:00:00.000Z</published>
    <updated>2018-09-07T03:01:14.276Z</updated>
    
    <content type="html"><![CDATA[<p>è½¬åˆ°ç”¨ Typescript å†™ Vue åº”ç”¨ä»¥åï¼Œç»è¿‡ä¸€è½®å·¥å…·é“¾å’Œä¾èµ–çš„æ´—ç¤¼ï¼Œæ€»ç®—è¹’è·šåœ°èƒ½èµ°èµ·æ¥äº†ï¼Œä¸è¿‡æœ‰ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„åŠŸèƒ½ mixinï¼Œä¼¼ä¹è¿˜æ²¡æœ‰å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>æ—¢æƒ³äº«å— mixin çš„çµæ´»å’Œæ–¹ä¾¿ï¼Œåˆæƒ³æ”¶è· ts çš„ç±»å‹ç³»ç»Ÿå¸¦æ¥çš„å®‰å…¨ä¿éšœå’Œå¼€å‘æ—¶ä½¿ç”¨ IntelliSense çš„é¡ºæ»‘ä½“éªŒã€‚</p><p>vuejs å®˜æ–¹ç»„ç»‡é‡Œæœ‰ä¸€ä¸ª â€˜vue-class-componentâ€™ ä»¥åŠè¿å¸¦æ¨èçš„ â€˜vue-property-decoratorâ€™ï¼Œéƒ½æ²¡æœ‰ç›¸åº”å®ç°ã€‚ç¿»äº†ä¸‹å‰è€…çš„ issueï¼Œæœ‰ä¸€æ¡æŒ‚äº†å¥½äº›æ—¶é—´çš„å¾…åš feature å°±æ˜¯ mixin çš„æ”¯æŒã€‚</p><p>ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¤æ‚çš„äº‹ï¼Œè‡ªå·±å†™ä¸€ä¸ªå§ã€‚</p><blockquote><p>åæ³¨ï¼švue-class-component 6.2.0 å¼€å§‹æä¾› <a href="https://github.com/vuejs/vue-class-component/commit/cdcbfe5bb1a4c9d59a4b3066477f49c9aae8e2fc" target="_blank" rel="noopener">mixins</a> æ–¹æ³•ï¼Œå’Œæœ¬æ–‡çš„å®ç°æ€è·¯ç›¸ä¼¼ã€‚</p></blockquote><h1 id="å®ç°">å®ç°</h1><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> Vue, &#123; VueConstructor &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> VClass&lt;T&gt; = &#123;  <span class="hljs-keyword">new</span>(): T&#125; &amp; Pick&lt;VueConstructor, keyof VueConstructor&gt;<span class="hljs-comment">/** * mixins for class style vue component */</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Mixins</span>&lt;<span class="hljs-title">A</span>&gt;(<span class="hljs-params">c: VClass&lt;A&gt;</span>): <span class="hljs-title">VClass</span>&lt;<span class="hljs-title">A</span>&gt;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Mixins</span>&lt;<span class="hljs-title">A</span>, <span class="hljs-title">B</span>&gt;(<span class="hljs-params">c: VClass&lt;A&gt;, c1: VClass&lt;B&gt;</span>): <span class="hljs-title">VClass</span>&lt;<span class="hljs-title">A</span>&amp;<span class="hljs-title">B</span>&gt;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Mixins</span>&lt;<span class="hljs-title">A</span>, <span class="hljs-title">B</span>, <span class="hljs-title">C</span>&gt;(<span class="hljs-params">c: VClass&lt;A&gt;, c1: VClass&lt;B&gt;, c2: VClass&lt;C&gt;</span>): <span class="hljs-title">VClass</span>&lt;<span class="hljs-title">A</span>&amp;<span class="hljs-title">B</span>&amp;<span class="hljs-title">C</span>&gt;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Mixins</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">c: VClass&lt;T&gt;, ...traits: <span class="hljs-built_in">Array</span>&lt;VClass&lt;T&gt;&gt;</span>): <span class="hljs-title">VClass</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;  <span class="hljs-title">return</span> <span class="hljs-title">c</span>.<span class="hljs-title">extend</span>(<span class="hljs-params">&#123;    mixins: traits  &#125;</span>)&#125;</span></span></span></code></pre><p>å£°æ˜ <code>VClass&lt;T&gt;</code> å¯ä½œä¸º T çš„ç±»æ„é€ å™¨ã€‚åŒæ—¶é€šè¿‡ <code>Pick</code> æ‹¿åˆ° Vue çš„æ„é€ å™¨ä¸Šçš„é™æ€æ–¹æ³•ï¼ˆextend/mixin ä¹‹ç±»ï¼‰ï¼Œå¦‚æ­¤æ‰èƒ½å¤Ÿæ”¯æŒä¸‹é¢è¿™æ®µä¸­çš„çœŸæ­£å®ç°ï¼Œé€šè¿‡è°ƒç”¨ä¸€ä¸ª Vue çš„å­ç±»æ„é€ å™¨ä¸Šçš„ <code>extend</code> æ–¹æ³•ç”Ÿæˆæ–°çš„å­ç±»æ„é€ å™¨ã€‚</p><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Mixins</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">c: VClass&lt;T&gt;, ...traits: <span class="hljs-built_in">Array</span>&lt;VClass&lt;T&gt;&gt;</span>): <span class="hljs-title">VClass</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;  <span class="hljs-keyword">return</span> c.extend(&#123;    mixins: traits  &#125;)&#125;</code></pre><p>è‡³äº ABC è¿™ä¸ªçº¯ç²¹æ˜¯ç±»å‹å£°æ˜çš„ä½“åŠ›æ´»äº†ã€‚</p><h1 id="ä½¿ç”¨">ä½¿ç”¨</h1><p>å®é™…ä½¿ç”¨æ—¶:</p><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; Component, Vue &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-property-decorator'</span><span class="hljs-keyword">import</span> &#123; Mixins &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'../../util/mixins'</span><span class="hljs-meta">@Component</span><span class="hljs-keyword">class</span> PageMixin <span class="hljs-keyword">extends</span> Vue &#123;  title = <span class="hljs-string">'Test Page'</span>  redirectTo(path: <span class="hljs-built_in">string</span>) &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'calling reidrectTo'</span>, path)    <span class="hljs-keyword">this</span>.$router.push(&#123; path &#125;)  &#125;&#125;<span class="hljs-keyword">interface</span> IDisposable &#123;  dispose(...args: <span class="hljs-built_in">any</span>[]): <span class="hljs-built_in">any</span>&#125;<span class="hljs-meta">@Component</span><span class="hljs-keyword">class</span> DisposableMixin <span class="hljs-keyword">extends</span> Vue &#123;  _disposables: IDisposable[]  created() &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'disposable mixin created'</span>);    <span class="hljs-keyword">this</span>._disposables = []  &#125;  beforeDestroy() &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'about to clear disposables'</span>)    <span class="hljs-keyword">this</span>._disposables.map(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> &#123;      d.dispose()    &#125;)    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._disposables  &#125;  registerDisposable(d: IDisposable) &#123;    <span class="hljs-keyword">this</span>._disposables.push(d)  &#125;&#125;<span class="hljs-meta">@Component</span>(&#123;  template: <span class="hljs-string">`  &lt;div&gt;    &lt;h1&gt;&#123;&#123; title &#125;&#125;&lt;/h1&gt;    &lt;p&gt;Counted: &#123;&#123; counter &#125;&#125;&lt;/p&gt;  &lt;/div&gt;  `</span>&#125;)<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> TimerPage <span class="hljs-keyword">extends</span> Mixins(PageMixin, DisposableMixin) &#123;  counter = <span class="hljs-number">0</span>  mounted() &#123;    <span class="hljs-keyword">const</span> timer = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.counter++ &gt;= <span class="hljs-number">3</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.redirectTo(<span class="hljs-string">'/otherpage'</span>)      &#125;      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'count to'</span>, <span class="hljs-keyword">this</span>.counter);    &#125;, <span class="hljs-number">1000</span>)    <span class="hljs-keyword">this</span>.registerDisposable(&#123;      dispose() &#123;        clearInterval(timer)      &#125;    &#125;)  &#125;&#125;</code></pre><pre><code class="hljs undefined">count to 1count to 2count to 3calling reidrectTo /otherpageabout to clear disposables</code></pre><p>æ³¨æ„åˆ°ç›´æ¥ <code>extends Vue</code> çš„ <code>DisposableMixin</code> å¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ Vue ç»„ä»¶ï¼Œä¹Ÿä¸å¯ä»¥ç›´æ¥åœ¨ <code>mixins</code> é€‰é¡¹é‡Œä½¿ç”¨ï¼Œå¦‚æœè¦è¢«ä»¥ <code>Vue.extend</code> æ–¹å¼æ‰©å±•çš„è‡ªå®šä¹‰ç»„ä»¶ä½¿ç”¨ï¼Œè®°ä½ä½¿ç”¨ <code>Component</code> åŒ…è£…ä¸€å±‚ã€‚</p><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> ExtendedComponent = Vue.extend(&#123;  name: <span class="hljs-string">'ExtendedComponent'</span>,  mixins: [Component(DisposableMixin)],&#125;)</code></pre><h1 id="abstract-class">Abstract class</h1><p>åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œå¤šæ•°æƒ…å†µéœ€æ±‚ä¸‹ä¼šæ›´å¤æ‚ï¼Œæä¾›ä¸€äº›åŸºç¡€åŠŸèƒ½ï¼Œä½†æœ‰äº›éƒ¨åˆ†éœ€è¦ç•™ç»™ç»§æ‰¿è€…è‡ªè¡Œå®ç°ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨æŠ½è±¡ç±»å°±å¾ˆåˆé€‚ã€‚</p><h2 id="ç›´æ¥ç»§æ‰¿">ç›´æ¥ç»§æ‰¿</h2><pre><code class="hljs typescript"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> AbstractMusicPlayer <span class="hljs-keyword">extends</span> Vue &#123;  <span class="hljs-keyword">abstract</span> audioSrc: <span class="hljs-built_in">string</span>    playing = <span class="hljs-literal">false</span>    togglePlay() &#123;    <span class="hljs-keyword">this</span>.playing = !<span class="hljs-keyword">this</span>.playing  &#125;&#125;<span class="hljs-meta">@Component</span><span class="hljs-keyword">class</span> MusicPlayerA <span class="hljs-keyword">extends</span> AbstractMusicPlayer &#123;  audioSrc = <span class="hljs-string">'/audio-a.mp3'</span>&#125;<span class="hljs-meta">@Component</span><span class="hljs-keyword">class</span> MusicPlayerB <span class="hljs-keyword">extends</span> AbstractMusicPlayer &#123;  staticBase = <span class="hljs-string">'/statics'</span>  <span class="hljs-keyword">get</span> audioSrc() &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;this.staticBase&#125;</span>/audio-b.mp3`</span>  &#125;&#125;</code></pre><h2 id="ä½¿ç”¨-mixins">ä½¿ç”¨ Mixins</h2><h3 id="åæ–¹æ³•æ¬ºéª—ä»¥åŠæ³¨é‡Š">åæ–¹æ³•ï¼šæ¬ºéª—ï¼Œä»¥åŠæ³¨é‡Š</h3><p>ä½†æŠ½è±¡ç±»æ˜¯æ— æ³•è¢«å®ä¾‹åŒ–çš„ï¼Œå¹¶ä¸æ»¡è¶³ <code>{ new(): T }</code> è¿™ä¸ªè¦æ±‚ï¼Œå› æ­¤åªèƒ½è¢«ç»§æ‰¿ï¼Œè€Œ<strong>ä¸èƒ½</strong>è¢«æ··å…¥ï¼Œç”±äºåŒæ ·çš„åŸå› ï¼ŒæŠ½è±¡ç±»ä¹Ÿæ— æ³•è¢« â€˜vue-class-componentâ€™ çš„ <code>Component</code> å‡½æ•°è£…é¥°ã€‚</p><p>è¿™æ—¶å€™åªå¥½å°†å®ç°äº†çš„åŠŸèƒ½å†™å…¥ Mixin ä¸­ï¼Œå¾…å®ç°çš„åŠŸèƒ½æ”¾åˆ°æ¥å£é‡Œï¼Œè®©å…·ä½“ç±»æ¥å®ç°ã€‚</p><pre><code class="hljs typescriptvue-class-component">interface IMusicSourceProvider &#123;  audioSrc: string&#125;/** * éœ€è¦å®ç° IPlayerImplementation */@Componentclass PlayerMixin extends Vue &#123;  /** @abstract å¿…é¡»å®ç° */  audioSrc: string  logSrc() &#123;    console.log(this.audioSrc)  &#125;&#125;interface IPlayerImplementation extends IMusicSourceProvider &#123;&#125;@Componentclass OtherMixin extends Vue &#123;  description = &apos;å¦ä¸€ä¸ª Mixin&apos;&#125;@Componentclass RealPlayer extends Mixins(PlayerMixin, OtherMixin) implements IPlayerImplementation &#123;  audioSrc = &apos;/audio-c.mp3&apos;&#125;// æ— æ³•æ­£å¸¸å·¥ä½œ@Componentclass BrokenPlayer extends Mixins(PlayerMixin, OtherMixin) &#123;&#125;</code></pre><p>é‰´äº <code>@Component</code> è£…é¥°å™¨çš„å®ç°æ–¹å¼ï¼Œè¿™ç§æ¬ºéª—ç¼–è¯‘å™¨çš„æ–¹å¼å…¶å®è¿˜æ˜¯æ¯”è¾ƒæ‹™åŠ£çš„ã€‚</p><p>å¦‚æœä¸€ä¸ªå…·ä½“ç±»ç»§æ‰¿äº† <code>PlayerMixin</code>ï¼Œå´æ²¡æœ‰ä½¿ç”¨ getter æˆ– property initializer å®ç° <code>audioSrc</code> è¿™ä¸ªå±æ€§ï¼Œç¼–è¯‘å™¨æ— æ³•å‘Šè¯‰ä½ è¿™ä¸ªé”™è¯¯ï¼ˆä¸å¼€å¯ä¸¥æ ¼æ¨¡å¼çš„æƒ…å†µä¸‹ï¼‰ï¼Œä½†å®é™…ä½¿ç”¨ä¸­ <code>audioSrc</code> å…¶å®æ˜¯æ²¡æœ‰è¢«åˆå§‹åŒ–çš„ï¼Œä½ ä¼šå‘ç° <code>BrokenPlayer</code> çš„å®ä¾‹å½“ä¸­ <code>_data</code> é‡Œå¹¶ä¸åŒ…å« <code>audioSrc</code>ï¼Œå³ä¾¿åœ¨å®ä¾‹åŒ–åæ‰‹åŠ¨è®¾ç½®è¯¥å€¼ï¼ŒVue ä¹Ÿæ— æ³•ç›‘å¬åˆ°è¯¥å€¼çš„å˜åŒ–ï¼Œä¼šé€ æˆä¸€äº›æ¯”è¾ƒéšç§˜çš„ bugã€‚</p><p>æˆ‘ä»¬åªèƒ½åœ¨ä»£ç é‡Œå°å¿ƒç¿¼ç¿¼å†™ä¸Šæ³¨é‡Šï¼ŒæœŸå¾…ä½¿ç”¨è€…ä¸è¦å¿˜äº†è¿™ä»¶äº‹ã€‚</p><p>ä¹Ÿå¯ä»¥æ‰§è¡Œä¸€äº›å¼€å‘æ—¶å€™çš„é¢å¤–æ£€æŸ¥ï¼Œå¦‚ä¸‹ï¼š</p><h4 id="è‡ªå®šä¹‰è£…é¥°å™¨-abstractproperty">è‡ªå®šä¹‰è£…é¥°å™¨ AbstractProperty</h4><p>vue-class-component æä¾›äº† <a href="https://github.com/vuejs/vue-class-component#create-custom-decorators" target="_blank" rel="noopener">createDecorator</a> æ–¹æ³•æ¥åˆ›å»ºå…¶ä½“ç³»ä¸‹çš„è‡ªå®šä¹‰è£…é¥°å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç”¨ï¼š</p><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; createDecorator &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-class-component'</span><span class="hljs-comment">// ä¸€ä¸ªä»€ä¹ˆéƒ½ä¸åšçš„è£…é¥°å™¨ï¼Œåœ¨ production ç¯å¢ƒä¸‹å¯ç”¨ã€‚ä¸ä½¿ç”¨ createDecorator</span><span class="hljs-keyword">const</span> HolderDecorator = <span class="hljs-function">(<span class="hljs-params">ctor: <span class="hljs-built_in">any</span></span>) =&gt;</span> ctor<span class="hljs-comment">/** * Only for vue-class-component decorated class */</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> AbstractProperty = isProduction ? HolderDecorator:createDecorator(<span class="hljs-function">(<span class="hljs-params">options, key</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> originCreated = options.created  options.created = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-keyword">if</span> (originCreated) originCreated.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)    <span class="hljs-keyword">if</span> (!(key <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>)) &#123;      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`æœªå®ç° AbstractProperty '<span class="hljs-subst">$&#123;key&#125;</span>'`</span>)    &#125;  &#125;&#125;)<span class="hljs-meta">@Component</span><span class="hljs-keyword">class</span> PlayerMixin <span class="hljs-keyword">extends</span> Vue &#123;  <span class="hljs-meta">@AbstractProperty</span>  audioSrc: <span class="hljs-built_in">string</span>  logSrc() &#123;    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.audioSrc)  &#125;&#125;<span class="hljs-meta">@Component</span><span class="hljs-keyword">class</span> BrokenPlayer <span class="hljs-keyword">extends</span> Mixins(PlayerMixin, OtherMixin) &#123;&#125;<span class="hljs-keyword">const</span> player = <span class="hljs-keyword">new</span> BrokenPlayer<span class="hljs-comment">// æœªå®ç° AbstractProperty 'audioSrc'</span></code></pre><h3 id="æ²¡é‚£ä¹ˆåçš„æ–¹æ³•ä¸­é—´ç±»">æ²¡é‚£ä¹ˆåçš„æ–¹æ³•ï¼šä¸­é—´ç±»</h3><pre><code class="hljs typescript"><span class="hljs-meta">@Component</span><span class="hljs-keyword">class</span> _PlayerImpl <span class="hljs-keyword">extends</span> AbstractMusicPlayer &#123;  audioSrc = <span class="hljs-string">'/audio-d.mp3'</span>&#125;<span class="hljs-meta">@Component</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> RealPlayer2 <span class="hljs-keyword">extends</span> Mixins(_PlayerImpl, OtherMixin) &#123;&#125;</code></pre><p>ä½¿ç”¨ä¸­é—´ç±» <code>_PlayerImpl</code> æ¥å®ç°æŠ½è±¡ç±»çš„æŠ½è±¡éƒ¨åˆ†ï¼Œç„¶åå†è¢«çœŸæ­£çš„ä½¿ç”¨è€… <code>RealPlayer2</code> ä½¿ç”¨ã€‚å•°å—¦äº†ä¸€ç‚¹ï¼Œä½†æ˜¯ç±»å‹å®‰å…¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è½¬åˆ°ç”¨ Typescript å†™ Vue åº”ç”¨ä»¥åï¼Œç»è¿‡ä¸€è½®å·¥å…·é“¾å’Œä¾èµ–çš„æ´—ç¤¼ï¼Œæ€»ç®—è¹’è·šåœ°èƒ½èµ°èµ·æ¥äº†ï¼Œä¸è¿‡æœ‰ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„åŠŸèƒ½ mixinï¼Œä¼¼ä¹è¿˜æ²¡æœ‰å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ—¢æƒ³äº«å— mixin çš„çµæ´»å’Œæ–¹ä¾¿ï¼Œåˆæƒ³æ”¶è· ts çš„ç±»å‹ç³»ç»Ÿå¸¦æ¥çš„å®‰å…¨ä¿éšœå’Œå¼€å‘æ—¶ä½¿ç”¨ In
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Typescript" scheme="http://hikerpig.github.io/tags/Typescript/"/>
    
      <category term="Vue" scheme="http://hikerpig.github.io/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>ES6 Class å’Œ Babel 6 åœ¨ IE &lt;= 10 æ—¶å€™çš„ä¸€ä¸ªå‘</title>
    <link href="http://hikerpig.github.io/2017/09/25/2017-09-25-ES6+Babel-little-bug-under-IE11/"/>
    <id>http://hikerpig.github.io/2017/09/25/2017-09-25-ES6+Babel-little-bug-under-IE11/</id>
    <published>2017-09-24T16:00:00.000Z</published>
    <updated>2018-08-26T08:51:33.168Z</updated>
    
    <content type="html"><![CDATA[<p>å†™ ES6+ ä¸€å®šé€ƒä¸å¼€ babelï¼Œä¹Ÿé¿ä¸å¼€è°ƒè¯• babel ç”Ÿæˆçš„ä¸€äº›ä»£ç ã€‚</p><p>å½“è¾“å…¥ä¸€æ®µ ES6 Class ä»£ç æ—¶:</p><pre><code class="hljs js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;  <span class="hljs-keyword">static</span> baseName = <span class="hljs-string">'Person'</span>  <span class="hljs-keyword">static</span> speakForAll() &#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.baseName  &#125;  speak() &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">'Hello'</span>  &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Developer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Person</span> </span>&#123;&#125;<span class="hljs-keyword">const</span> myself = <span class="hljs-keyword">new</span> Developer()<span class="hljs-built_in">console</span>.log(myself.speak() === <span class="hljs-string">'Hello'</span>) <span class="hljs-comment">// true</span><span class="hljs-built_in">console</span>.log(Person.speakForAll() === <span class="hljs-string">'Person'</span>) <span class="hljs-comment">// true</span><span class="hljs-built_in">console</span>.log(Developer.speakForAll() === <span class="hljs-string">'Person'</span>) <span class="hljs-comment">// true</span></code></pre><h1 id="é—®é¢˜">é—®é¢˜</h1><p>åœ¨å¼€å‘å¸¸ç”¨çš„æµè§ˆå™¨ Chrome å’Œ Firefox é‡Œæ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯åœ¨ IE10 ä¸‹ä¼šæŠ¥é”™ <code>Uncaught TypeError: Developer.speakForAll is not a function</code></p><h2 id="åˆ¨æ ¹é—®åº•">åˆ¨æ ¹é—®åº•</h2><p><code>.babelrc</code> é…ç½®å¦‚ä¸‹:</p><pre><code class="hljs json">&#123;  <span class="hljs-attr">"presets"</span>: [<span class="hljs-string">"es2015"</span>, <span class="hljs-string">"stage-2"</span>],&#125;</code></pre><p>çœ‹ babel ç¼–è¯‘å‡ºçš„ä¸€ä¸²ä»£ç  blahblahï¼Œ é‡ç‚¹ä¸‹é¢è¯´:</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> _class, _temp<span class="hljs-function"><span class="hljs-keyword">function</span> _possibleConstructorReturn(<span class="hljs-params">self, call</span>) </span>&#123;  <span class="hljs-keyword">if</span> (!self) &#123;    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ReferenceError</span>(      <span class="hljs-string">"this hasn't been initialised - super() hasn't been called"</span>,    )  &#125;  <span class="hljs-keyword">return</span> call &amp;&amp; (<span class="hljs-keyword">typeof</span> call === <span class="hljs-string">'object'</span> || <span class="hljs-keyword">typeof</span> call === <span class="hljs-string">'function'</span>)    ? call    : self&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> _inherits(<span class="hljs-params">subClass, superClass</span>) </span>&#123;  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> superClass !== <span class="hljs-string">'function'</span> &amp;&amp; superClass !== <span class="hljs-literal">null</span>) &#123;    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(      <span class="hljs-string">'Super expression must either be null or a function, not '</span> +        <span class="hljs-keyword">typeof</span> superClass,    )  &#125;  subClass.prototype = <span class="hljs-built_in">Object</span>.create(superClass &amp;&amp; superClass.prototype, &#123;    <span class="hljs-attr">constructor</span>: &#123;      <span class="hljs-attr">value</span>: subClass,      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,    &#125;,  &#125;)  <span class="hljs-keyword">if</span> (superClass)    <span class="hljs-built_in">Object</span>.setPrototypeOf      ? <span class="hljs-built_in">Object</span>.setPrototypeOf(subClass, superClass)      : (subClass.__proto__ = superClass)&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> _classCallCheck(<span class="hljs-params">instance, Constructor</span>) </span>&#123;  <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> Constructor)) &#123;    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Cannot call a class as a function'</span>)  &#125;&#125;<span class="hljs-keyword">var</span> Person = ((_temp = _class = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params"></span>) </span>&#123;    _classCallCheck(<span class="hljs-keyword">this</span>, Person)  &#125;  Person.speakForAll = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">speakForAll</span>(<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.baseName  &#125;  Person.prototype.speak = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">speak</span>(<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">'Hello'</span>  &#125;  <span class="hljs-keyword">return</span> Person&#125;)()),(_class.baseName = <span class="hljs-string">'Person'</span>),_temp)<span class="hljs-keyword">var</span> Developer = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_Person</span>) </span>&#123;  _inherits(Developer, _Person)  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Developer</span>(<span class="hljs-params"></span>) </span>&#123;    _classCallCheck(<span class="hljs-keyword">this</span>, Developer)    <span class="hljs-keyword">return</span> _possibleConstructorReturn(<span class="hljs-keyword">this</span>, _Person.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>))  &#125;  <span class="hljs-keyword">return</span> Developer&#125;)(Person)<span class="hljs-keyword">var</span> myself = <span class="hljs-keyword">new</span> Developer()<span class="hljs-built_in">console</span>.log(myself.speak() === <span class="hljs-string">'Hello'</span>)<span class="hljs-built_in">console</span>.log(Person.speakForAll() === <span class="hljs-string">'Person'</span>)<span class="hljs-built_in">console</span>.log(Developer.speakForAll() === <span class="hljs-string">'Person'</span>)</code></pre><p>å…³é”®æ˜¯æ­¤æ®µå®ç°ç»§æ‰¿çš„éƒ¨åˆ†:</p><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> _inherits(<span class="hljs-params">subClass, superClass</span>) </span>&#123;  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> superClass !== <span class="hljs-string">'function'</span> &amp;&amp; superClass !== <span class="hljs-literal">null</span>) &#123;    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(      <span class="hljs-string">'Super expression must either be null or a function, not '</span> +        <span class="hljs-keyword">typeof</span> superClass,    )  &#125;  subClass.prototype = <span class="hljs-built_in">Object</span>.create(superClass &amp;&amp; superClass.prototype, &#123;    <span class="hljs-attr">constructor</span>: &#123;      <span class="hljs-attr">value</span>: subClass,      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,      <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,    &#125;,  &#125;)  <span class="hljs-keyword">if</span> (superClass)    <span class="hljs-built_in">Object</span>.setPrototypeOf      ? <span class="hljs-built_in">Object</span>.setPrototypeOf(subClass, superClass)      : (subClass.__proto__ = superClass)&#125;</code></pre><p><code>subClass.prototype</code> è¿™ä¸€æ®µæ¯”è¾ƒç®€å•ï¼Œæ“ä½œåŸå‹é“¾æ¥å®ç°å®ä¾‹æ–¹æ³•å’Œå±æ€§çš„ç»§æ‰¿ã€‚é¡ºå¸¦è¿˜ç”¨ object descriptor é‡å†™äº† <code>constructor</code> è¿™ä¸€å±æ€§ï¼Œè°ƒç”¨ <code>myself.constructor</code> æ—¶æ‰ä¼šæ‹¿åˆ°æ­£ç¡®çš„å€¼ <code>Developer</code>ï¼Œè€Œä¸æ˜¯ <code>Person</code>ã€‚</p><p>æ¥ä¸‹æ¥çš„ä¸€æ®µæ¯”è¾ƒæœ‰è¶£ã€‚</p><pre><code class="hljs js"><span class="hljs-built_in">Object</span>.setPrototypeOf(subClass, superClass)</code></pre><p>è¿™ä¸ªå†™æ³•è¿˜æ˜¯æ¯”è¾ƒè®¨å·§çš„ï¼Œå°†çˆ¶ç±»çš„æ„é€ å‡½æ•° <code>superClass</code> ä½œä¸ºå­ç±»æ„é€ å‡½æ•° <code>subClass</code> çš„åŸå‹ã€‚</p><h1 id="çŸ¥è¯†å›é¡¾">çŸ¥è¯†å›é¡¾</h1><h2 id="object.setprototypeof">Object.setPrototypeOf</h2><p>è¿™æ˜¯ä¸ª <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-object.setprototypeof" target="_blank" rel="noopener">ES2015</a> æ–°æå‡ºçš„å‡½æ•°ï¼Œå‡½æ•°ç­¾åï¼š</p><pre><code class="hljs js"><span class="hljs-built_in">Object</span>.setPrototypeOf(obj, prototype)</code></pre><p>å¯¹æ¯” <code>Object.create</code>ï¼Œå¯ä»¥åœ¨å¯¹è±¡åˆ›å»ºå‡ºæ¥ä¹‹åæ›¿æ¢å…¶åŸå‹ã€‚</p><pre><code class="hljs js"><span class="hljs-keyword">const</span> p1 = &#123;&#125;<span class="hljs-built_in">Object</span>.setPrototypeOf(p1, Person.prototype)<span class="hljs-built_in">console</span>.log(p1.speak()) <span class="hljs-comment">// ä¸º'Hello'</span></code></pre><p>æµè§ˆå™¨å…¼å®¹æ€§</p><table><thead><tr class="header"><th>Feature</th><th>Chrome</th><th>Edge</th><th>Firefox</th><th>IE</th><th>Opera</th><th>Safari</th></tr></thead><tbody><tr class="odd"><td>Basic Support</td><td>34</td><td>(Yes)</td><td>31</td><td>11</td><td>(Yes)</td><td>9</td></tr></tbody></table><p>æ³¨æ„åˆ°ä» IE11 æ‰å¼€å§‹æ”¯æŒæ­¤æ–¹æ³•ã€‚</p><p>æ—¢ç„¶ç¬¬ä¸€æ¡è·¯è¡Œä¸é€šï¼Œé‚£å°±ç¬¬äºŒæ¡å‘—ã€‚</p><h2 id="proto__"><code>__proto__</code></h2><p><code>_inherits</code> å‡½æ•°ä¸­å›é€€åˆ° <code>subClass.__proto__ = superClass</code>ã€‚<code>__proto__</code> æŒ‡å‘çš„æ˜¯å¯¹è±¡æ„é€ å‡½æ•°çš„ <code>prototype</code>ï¼Œé€šè¿‡é‡è®¾ <code>subClass</code> çš„åŸå‹æ¥ä½¿å…¶è·å¾—çˆ¶ç±»æ„é€ å‡½æ•°ä¸Šçš„æ–¹æ³•(æ­¤ä¾‹ä¸­æ˜¯ class ä¸Šçš„é™æ€æ–¹æ³•)ã€‚</p><p>å…³é”®åœ¨äºï¼Œ<code>__proto__</code> æ˜¯ä¸ªéæ ‡å‡†çš„å±æ€§ï¼Œæ ¹æ®<a href="https://docs.microsoft.com/en-us/scripting/javascript/reference/proto-property-object-javascript" target="_blank" rel="noopener">å¾®è½¯çš„æ–‡æ¡£</a>ï¼ŒIE10 åŠå…¶ä»¥ä¸‹éƒ½æ²¡æœ‰æ”¯æŒã€‚</p><blockquote><p>Not supported in the following document modes: Quirks, Internet Explorer 6 standards, Internet Explorer 7 standards, Internet Explorer 8 standards, Internet Explorer 9 standards, Internet Explorer 10 standards. Not supported in Windows 8.</p></blockquote><p><a href="https://github.com/babel/babel/issues/3041" target="_blank" rel="noopener">Babel çš„ä¸€ä¸ª issue</a> ä¸­æœ‰äººæè¿‡ç±»ä¼¼é—®é¢˜ï¼Œå›ç­”æ˜¯ï¼šbabel 6 ä¸è€ƒè™‘å…¼å®¹ IEã€‚æ²¡ç¢°ä¸Šé—®é¢˜ç®—å¹¸è¿ï¼Œç¢°ä¸Šé—®é¢˜åªå¥½è‡ªå·±è§£å†³ã€‚</p><h1 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h1><p>å°±è¿™ä¸ªäº‹æƒ…æ¥è¯´ï¼Œæ·»åŠ ä¸€ä¸ª polyfill èƒ½å¤Ÿè§£å†³ã€‚ä»¥ <a href="https://github.com/wesleytodd/setprototypeof" target="_blank" rel="noopener">è¿™ä¸ªå®ç°</a> æ¥è¯´:</p><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-built_in">Object</span>.setPrototypeOf || (&#123;<span class="hljs-attr">__proto__</span>:[]&#125; <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span> ? setProtoOf : mixinProperties);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setProtoOf</span>(<span class="hljs-params">obj, proto</span>) </span>&#123;  obj.__proto__ = proto;  <span class="hljs-keyword">return</span> obj;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixinProperties</span>(<span class="hljs-params">obj, proto</span>) </span>&#123;  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> proto) &#123;    <span class="hljs-keyword">if</span> (!obj.hasOwnProperty(prop)) &#123;      obj[prop] = proto[prop];    &#125;  &#125;  <span class="hljs-keyword">return</span> obj;&#125;</code></pre><p>å…ˆæ¢æµ‹ Object ä¸Šæ˜¯å¦åŸç”Ÿæ”¯æŒï¼Œç„¶åæ£€æµ‹æ›´æ”¹ <code>__proto__</code> æ˜¯å¦æœ‰ä½œç”¨ï¼Œæœ€åå›é€€åˆ°ç®€å•æš´åŠ›çš„éå†èµ‹å€¼ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å†™ ES6+ ä¸€å®šé€ƒä¸å¼€ babelï¼Œä¹Ÿé¿ä¸å¼€è°ƒè¯• babel ç”Ÿæˆçš„ä¸€äº›ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;å½“è¾“å…¥ä¸€æ®µ ES6 Class ä»£ç æ—¶:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs js&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=
      
    
    </summary>
    
    
      <category term="Javascript" scheme="http://hikerpig.github.io/tags/Javascript/"/>
    
      <category term="Babel" scheme="http://hikerpig.github.io/tags/Babel/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Object.create(null) åˆ›å»ºç©ºå¯¹è±¡</title>
    <link href="http://hikerpig.github.io/2017/09/07/2017-09-07-Using-Object.create/"/>
    <id>http://hikerpig.github.io/2017/09/07/2017-09-07-Using-Object.create/</id>
    <published>2017-09-06T16:00:00.000Z</published>
    <updated>2018-08-26T08:51:38.530Z</updated>
    
    <content type="html"><![CDATA[<p>ä½¿ç”¨å¯¹è±¡å­—é¢é‡å½¢å¼æ—¶ï¼Œéšå¼åœ°åˆ›å»ºäº†ä¸€ä¸ªä»¥ <code>Object.prototype</code> ä½œä¸ºåŸå‹çš„å¯¹è±¡ã€‚</p><p>ä»¥ä¸‹ä¸¤ç§æ–¹å¼ç­‰åŒã€‚</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> o1 = &#123;&#125;<span class="hljs-keyword">var</span> o2 = <span class="hljs-built_in">Object</span>.create(<span class="hljs-built_in">Object</span>.prototype)</code></pre><h2 id="æ›´çœäº‹çš„æ–¹æ³•">æ›´çœäº‹çš„æ–¹æ³•</h2><pre><code class="hljs js"><span class="hljs-keyword">var</span> o3 = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>)</code></pre><p>åˆ›å»ºä¸€ä¸ªä¸ç»§æ‰¿ä»»ä½•åŸå‹çš„å¯¹è±¡ã€‚</p><p>å¦‚æœéœ€è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„ map æ€§è´¨çš„å¯¹è±¡ï¼Œä½¿ç”¨æ­¤ç§æ–¹å¼ï¼Œåœ¨å¯¹ <code>o3</code> è¿›è¡Œéå†çš„æ—¶å€™ï¼Œå°±å¯ä»¥èº²å¼€å……æ»¡æ¶æ„çš„ä¸–ç•Œåœ¨ <code>Object.prototype</code> ä¸Šæ·»åŠ çš„æ–¹æ³•æˆ–å±æ€§ã€‚</p><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> k <span class="hljs-keyword">in</span> o1) &#123;  <span class="hljs-keyword">if</span> (o1.hasOwnProperty(k)) &#123;  &#125;&#125;<span class="hljs-comment">// éå†æ—¶ä¸éœ€è¦åˆ¤æ–­ hasOwnProperty</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> k <span class="hljs-keyword">in</span> o3) &#123;&#125;</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä½¿ç”¨å¯¹è±¡å­—é¢é‡å½¢å¼æ—¶ï¼Œéšå¼åœ°åˆ›å»ºäº†ä¸€ä¸ªä»¥ &lt;code&gt;Object.prototype&lt;/code&gt; ä½œä¸ºåŸå‹çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹ä¸¤ç§æ–¹å¼ç­‰åŒã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs js&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;va
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Javascript" scheme="http://hikerpig.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>ç»™å¼€å‘å‡å‹çš„ gulp.watch é…ç½®</title>
    <link href="http://hikerpig.github.io/2017/08/22/2017-08-22-gulp-watch-for-poor-cpu/"/>
    <id>http://hikerpig.github.io/2017/08/22/2017-08-22-gulp-watch-for-poor-cpu/</id>
    <published>2017-08-21T16:00:00.000Z</published>
    <updated>2018-08-26T08:51:43.865Z</updated>
    
    <content type="html"><![CDATA[<p>Gulp çš„æ–‡ä»¶ç›‘å¬ä½¿ç”¨äº† <a href="https://github.com/shama/gaze" target="_blank" rel="noopener">gaze</a>ï¼Œå¦‚æœåªçœ‹äº† Gulp çš„ API æ–‡æ¡£å¯èƒ½ä¼šæ¼æ‰ä¸€äº›å‚æ•°ã€‚</p><p><a href="https://github.com/gulpjs/gulp/blob/master/docs/API.md" target="_blank" rel="noopener">Gulp æ–‡æ¡£</a> ä¸­æåˆ°:</p><p><code>gulp.watch(glob[, opts], tasks)</code></p><pre><code class="hljs undefined">optsType: ObjectOptions, that are passed to gaze.</code></pre><p>options åŒ…æ‹¬:</p><ul><li><code>interval</code> {integer} Interval to pass to fs.watchFile</li><li><code>debounceDelay</code> {integer} Delay for events called in succession for the same file/event in milliseconds</li><li><code>mode</code> {string} Force the watch mode. Either â€˜autoâ€™ (default), â€˜watchâ€™ (force native events), or â€˜pollâ€™ (force stat polling).</li><li><code>cwd</code> {string} The current working directory to base file patterns from. Default is process.cwd()</li></ul><p>gaze çš„è®¾ç½®å‚æ•°ä¸­ï¼Œæ„Ÿè§‰æœ€æœ‰ç”¨å´è¢«é—æ¼çš„å°±æ˜¯ <code>interval</code> äº†ï¼Œå¥½å¤šäººæåˆ° <a href="https://github.com/gulpjs/gulp/issues/634" target="_blank" rel="noopener">gulp.watch CPU å ç”¨å¤ªé«˜</a>ï¼Œå› ä¸º gaze é»˜è®¤ 100ms æ£€æŸ¥ç›‘å¬çš„æ–‡ä»¶çŠ¶æ€ã€‚</p><p>å¦‚æœç›‘å¬æ–‡ä»¶å¤ªå¤šå¯¼è‡´ CPU å ç”¨å±…é«˜ä¸ä¸‹çš„è¯ï¼Œå¯ä»¥è€ƒè™‘åŠ å¤§ <code>interval</code>:</p><pre><code class="hljs js">gulp.watch(blob, &#123;<span class="hljs-attr">interval</span>: <span class="hljs-number">500</span>&#125;, tasks)</code></pre><p>ç¬”è®°æœ¬å°±ä¸ä¼šå‘¼å‘¼ä¹±å«äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Gulp çš„æ–‡ä»¶ç›‘å¬ä½¿ç”¨äº† &lt;a href=&quot;https://github.com/shama/gaze&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;gaze&lt;/a&gt;ï¼Œå¦‚æœåªçœ‹äº† Gulp çš„ API æ–‡æ¡£å¯èƒ½ä¼šæ¼æ‰ä¸€äº›å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a hre
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Holy Awesome Spacemacs</title>
    <link href="http://hikerpig.github.io/2017/08/05/2017-08-05-Holy-Awesome-Spacemacs/"/>
    <id>http://hikerpig.github.io/2017/08/05/2017-08-05-Holy-Awesome-Spacemacs/</id>
    <published>2017-08-04T16:00:00.000Z</published>
    <updated>2018-08-26T08:51:51.720Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://spacemacs.org/img/logo.svg"></p><p>å¾ˆä¹…ä»¥å‰çœ‹ SICP çš„æ—¶å€™å°è¯•åœ¨ windows ä¸‹ä½¿ç”¨ emacs æ—¶å—åˆ°äº†æƒŠå“ï¼Œé‚£åˆ€è€•ç«ç§ä¸€èˆ¬çš„ç•Œé¢å•Šã€‚åæ¥åœ¨ Ubuntu ç»ˆç«¯ä¸­æ‰“å¼€ï¼Œè¯¶ï¼Ÿæ€ä¹ˆå…³ä¸æ‰ï¼Ÿä¸æ‰ï¼Ÿæ‰ï¼Ÿï¼ˆå…¶å® Vim ä¹Ÿä¸€æ ·ï¼Œå°ç™½ç»ˆç»“è€…ï¼‰</p><p>ä½†æ˜¯çœ‹å®Œ<a href="https://www.zhihu.com/question/29692328" target="_blank" rel="noopener">å¦‚ä½•è¯„ä»· Emacs çš„é…ç½®æ–‡ä»¶ Spacemacsï¼Ÿ</a>ä»¥åŠèº«è¾¹å¤šäººçš„å®‰åˆ©åï¼Œå¿ƒç—’ç—’åœ°å°è¯•äº†ä¸‹ï¼Œä»ä¸€ä¸ªå¤–è¡Œäººçœ¼é‡Œçœ‹æ¥ï¼Œç®€ç›´æ˜¯ Emacs ç•Œçš„ä¸€è‚¡æ¸…æµï¼Œå²è¯—çº§çš„é…ç½®å·¥ç¨‹ã€‚</p><h1 id="å®‰è£…">å®‰è£…</h1><p>é‰´äºæœ‰ Every thing in Emacs çš„ä¼ ç»Ÿï¼Œé€‰æ‹©äº†å¯ä»¥ä¸å…‰åœ¨ç»ˆç«¯é‡Œä½¿ç”¨ï¼Œä¾¿å®‰è£…äº†å¸¦æœ‰ Mac GUI ç³»ç»Ÿæ”¯æŒçš„ Emacsï¼š</p><pre><code class="hljs undefined">brew install emacs --with-cocoa</code></pre><h2 id="spacemacs">Spacemacs</h2><p>å®Œå…¨æ²¡æœ‰å†å²çš„ <code>.emacs.d</code> åŒ…è¢±ï¼Œä¸€é”®å®‰è£…</p><pre><code class="hljs undefined">git clone https://github.com/syl20bnr/spacemacs ~/.emacs.d</code></pre><h1 id="å¼€å§‹ä½¿ç”¨">å¼€å§‹ä½¿ç”¨</h1><p>è¿˜æƒ³è¯´æ‰“å¼€é€Ÿåº¦æœç„¶æ¯” Vim æ…¢äº†ä¸å°‘ï¼Œä½†æ˜¯æ…¢æ…¢ä½¿ç”¨ç€å‘ç°ï¼Œè€ƒè™‘åˆ°è¿™äº›å·¨é‡çš„åŠŸèƒ½ä»¥åŠè¶…æ£’çš„ä½“éªŒæ¥è¯´ï¼Œç­‰å¾—å¤ªå€¼äº†ã€‚é‡ç‚¹æ˜¯ï¼Œ<strong>å¼€ç®±å³ç”¨</strong>ã€‚</p><p>é€‰æ‹©äº† Setup Guile ä¸­æç¤ºäº†ç›¸å¯¹è¾ƒé‡çš„ <code>helm</code> layerï¼Œä»¥åŠå¼€äº†å…¶ä»–ä¸ƒå…«ä¸ª layerã€‚ä¸è€ƒè™‘é¦–æ¬¡å®‰è£…æ’ä»¶çš„æ—¶é—´ï¼Œä¹‹åå¹³å‡å¯åŠ¨æ—¶é—´åœ¨15ç§’å†…ã€‚</p><p>ç„¶åå¼€å§‹é¢†æ•™ Emacs çš„èƒ½é‡ï¼š</p><h1 id="org-mode">org-mode</h1><p>æ±Ÿæ¹–ç›¸ä¼ èƒ½ç”¨äº<a href="http://docs.huihoo.com/open-source/guide/ch32.html" target="_blank" rel="noopener">ç»„ç»‡ä½ çš„æ„å¿µ</a>çš„â€œæ–‡æ¡£/çŸ¥è¯†/æ—¥ç¨‹/<del>äººç”Ÿ</del>ç®¡ç†å·¥å…·â€ï¼Œç¥çº§æ’ä»¶ã€‚</p><p>åœ¨è¿™ä¹‹å‰ï¼Œä½¿ç”¨ <a href="http://vimwiki.github.io" target="_blank" rel="noopener">Vimwiki</a> ç®¡ç†ä¸ªäººçŸ¥è¯†ï¼Œåœ¨ Vim é‡Œçš„è¡¨ç°ä¹Ÿæ˜¯å¾ˆæ£’çš„ï¼Œä½†æ˜¯æŠ˜è…¾èµ·æ¥æ€»æœ‰å‡ ç‚¹ä¸ç”šæ»¡æ„ï¼Œä½†åœ¨ org-mode ä¸‹æ‰¾åˆ°äº†å®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="æ–‡æ¡£è½¬æ¢">æ–‡æ¡£è½¬æ¢</h2><p>åœ¨ Markdown å¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œè¿˜éœ€è¦å•ç‹¬å»è®°å¿† Vimwiki è‡ªå·±çš„è¯­æ³•ï¼Œæœ‰æ—¶å€™è½¬ä¸è¿‡å¼¯æ¥ã€‚è¿˜æœ‰ï¼Œæœ‰æ—¶å€™ä¸€äº›æ”¶é›†æ€§è´¨çš„ç¬”è®°ï¼Œéœ€è¦ä» html è½¬æ¢è¿‡æ¥ï¼ŒVimwiki åœ¨è¿™æ–¹é¢ç›¸å…³å·¥å…·æ¯”è¾ƒåŒ®ä¹ã€‚</p><p><code>org-mode</code> è™½è¯´ä¹Ÿæ˜¯è‡ªæˆä¸€æ´¾çš„è¯­æ³•ï¼Œä½†æ˜¯ç›¸å…³å·¥å…·é“¾éå¸¸å®Œå–„ï¼Œä¸å„ç§æ–‡æ¡£æ ¼å¼äº’è½¬æ¯«æ— å‹åŠ›ï¼Œä¾‹å¦‚ <a href="https://github.com/fasheng/vimwiki2org" target="_blank" rel="noopener">vimwiki2org</a>ã€‚</p><p>å½“éœ€è¦é›†æˆç°æœ‰å·¥å…·åˆ°ç¼–è¾‘å™¨é‡Œæ—¶ï¼Œä¸€è¾¹æ˜¯å®šä¹‰æ¸…æ™°ã€æ–‡æ¡£å®Œå–„ã€ç»§æ‰¿äº† Lisp ç³»ç¾æ„Ÿçš„ Emacs Lisp ï¼Œå’Œæ—¶å¸¸è®©äººå‘¼å”¤ç¥å…½çš„ Vim Scriptã€‚</p><h2 id="ä»£ç å—æ”¯æŒ">ä»£ç å—æ”¯æŒ</h2><p>åœ¨ Vimwiki é‡Œæ’å…¥å’ŒæŸ¥é˜…ä»£ç å—çš„ä½“éªŒï¼Œçº¯ç²¹è€Œè´«ä¹ã€‚</p><p>åŒæ ·ä¸€ä¸ª python ä»£ç å—ï¼Œåœ¨ Vimwiki é‡Œï¼š</p><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/emacs/vimwiki-code.png" alt="undefined" title="undefined"><p>è€Œåœ¨ org-mode å½“ä¸­ä¸€åˆ‡éƒ½å¾ˆè¡Œäº‘æµæ°´</p><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/emacs/org-mode-code.png" alt="undefined" title="undefined"><h2 id="å…¶ä»–ä¼˜ç‚¹">å…¶ä»–ä¼˜ç‚¹</h2><p>åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>æ‰€è§å³æ‰€å¾—ï¼Œé»˜è®¤æƒ…å†µä¸‹ live previewï¼Œä¸ä¼šç”Ÿæˆå¤šä½™æ–‡ä»¶</li><li>å¼ºå¤§çš„é“¾æ¥ç³»ç»Ÿï¼Œç›´æ¥è·³è½¬è‡³å¤šç§å½¢å¼çš„å†…å¤–é“¾æ¥</li><li>å¼ºå¤§çš„<a href="http://orgmode.org/manual/Agenda-Views.html" target="_blank" rel="noopener">æ—¥ç¨‹è§„åˆ’åŠŸèƒ½</a></li><li>å¼ºå¤§çš„<a href="http://www.cnblogs.com/holbrook/archive/2012/04/12/2444992.html" target="_blank" rel="noopener">è¡¨æ ¼ç¼–è¾‘åŠŸèƒ½</a></li></ul><h3 id="ä¸€äº›æ”¶é›†">ä¸€äº›æ”¶é›†</h3><ul><li><a href="http://doc.norang.ca/org-mode.htm" target="_blank" rel="noopener">Organize Your Life In Plain Text!</a></li></ul><h1 id="helm">helm</h1><p><a href="http://tuhdo.github.io/helm-intro.html" target="_blank" rel="noopener">A Package in a league of its own: Helm</a></p><p>äº¤äº’å½¢å¼è®©æˆ‘æƒ³èµ·äº† Vim ä¸‹çš„ <code>ctrlp</code> å’Œ <code>unite</code>ï¼Œä½†æ˜¯èƒ½åšçš„äº‹æƒ…æ›´å¤šï¼Œè€Œä¸”æ‰©å±•æ€§æ›´å¥½ã€‚</p><p>é™¤äº†èƒ½æ‰¾åˆ°ä»»ä½•æ–‡ä»¶å¤–ï¼Œè¿˜èƒ½æ‰¾ä¸ªä»»ä½•ä¸€ä¸ªå‘½ä»¤ï¼Œå†ä¹Ÿä¸ç”¨è®°é‚£ä¹ˆå¤š <code>M-x</code> å‘½ä»¤äº†ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒå°æ‹‡æŒ‡å—ä¼¤äº†ã€‚</p><figure><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201601/15/103214s4z77zo4pimefccm.jpg" alt="From linux.cn"><figcaption>From linux.cn</figcaption></figure><h1 id="scala-mode-ä»¥åŠ-ensime">scala-mode ä»¥åŠ ensime</h1><p>åœ¨åš Coursera ä¸Š Scala è¯¾ç¨‹ä½œä¸šçš„æ—¶å€™è¯•äº†ä¸€ä¸‹ã€‚<a href="http://ensime.org/" target="_blank" rel="noopener">Ensime</a> çš„ Emacs æ’ä»¶å®Œæˆåº¦<a href="http://ensime.org/editors/" target="_blank" rel="noopener">éå¸¸çš„é«˜</a>ã€‚</p><h1 id="artist-mode">artist-mode</h1><p>æ— æ¯”ç‚«é…·çš„ ACSII Art å·¥å…·ï¼Œå†™æ³¨é‡Šå’Œæ–‡æ¡£æœ‰æ—¶ä¸€å›¾èƒœåƒè¨€ã€‚é…åˆ org-modeï¼Œæ„Ÿè§‰è‡ªå·±ä»æœªå¦‚æ­¤çƒ­çˆ±å†™æ–‡æ¡£ã€‚</p><p>çœ‹<a href="http://emacser.com/artist-mode.htm" target="_blank" rel="noopener">emacser ä¸Šçš„ä¸€ç¯‡ä»‹ç»</a>ã€‚</p><p>Vim ä¸Šæœ‰ä¸ªç±»ä¼¼çš„æ’ä»¶ <a href="http://www.vim.org/scripts/script.php?script_id=40" target="_blank" rel="noopener">Drawit.vim</a>ï¼Œä¸çŸ¥äºŒè€…è°å…ˆè°åï¼Œéƒ½æŒºå¥½ç”¨çš„ã€‚</p><h1 id="imenu-list">imenu-list</h1><p>åœ¨å³è¾¹æ–°å»ºä¸€ä¸ª buffer æ˜¾ç¤º imenu çš„ç»“æœï¼Œæ¥è¿‘äº Vim çš„ Tagbar ä½¿ç”¨ä½“éªŒã€‚</p><figure><img src="https://github.com/bmag/imenu-list/raw/master/images/imenu-list-dark.png" alt="github imenu-list"><figcaption>github imenu-list</figcaption></figure><h1 id="å¯ä»¥ä½¿ç”¨ä½†ä¸å‡†å¤‡æ›¿æ¢ç°æœ‰ä¸»åŠ›ç¼–è¾‘å™¨atomvimçš„">å¯ä»¥ä½¿ç”¨ï¼Œä½†ä¸å‡†å¤‡æ›¿æ¢ç°æœ‰ä¸»åŠ›ç¼–è¾‘å™¨ï¼ˆAtom/Vimï¼‰çš„</h1><h2 id="coffee-mode">coffee-mode</h2><p><a href="https://github.com/defunkt/coffee-mode" target="_blank" rel="noopener">coffee-mode</a> æ”¯æŒ coffeescript æ–‡ä»¶çš„è¯­æ³•é«˜äº®ã€ç¼–è¯‘å’Œ watch ç­‰åŠŸèƒ½ï¼Œé…åˆ etags ä½¿ç”¨è¿˜ä¸é”™ã€‚</p><p>ä¸ evil ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™éœ€è¦ä¸€äº›é¢å¤–é…ç½®ï¼Œå¦åˆ™ç”¨ <code>o</code> æ¢è¡Œçš„æ—¶å€™å‘ç°ç¼©è¿›ä¸å¯¹ã€‚</p><p>å®˜æ–¹ README ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼š</p><pre><code class="hljs elisp">(custom-set-variables &apos;(coffee-indent-like-python-mode t))</code></pre><h1 id="æ”¾å¼ƒæŠ˜è…¾çš„éƒ¨åˆ†">æ”¾å¼ƒæŠ˜è…¾çš„éƒ¨åˆ†</h1><h2 id="javascript-å’Œ-eslint">Javascript å’Œ Eslint</h2><p>ä½œä¸ºä¸€ä¸ªå‰ç«¯ï¼Œè¿˜æ˜¯æœ‰ç‚¹å°é—æ†¾çš„ã€‚</p><p>æ²¡æœ‰æ‰¾åˆ°å¼€ç®±å³ç”¨çš„æ’ä»¶ï¼Œ<code>flycheck</code> ä¼¼ä¹å¾ˆæ˜¯å¼ºå¤§ï¼Œä½†æ˜¯è¦æ”¯æŒ eslint è¿˜æœ‰æ”¹è®¸å¤šé…ç½®ã€‚å½“ç„¶äº†ï¼Œå‰ç«¯å¼€å‘è¿˜æ˜¯çœ‹ VS Code å’Œ Atom å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://spacemacs.org/img/logo.svg&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆä¹…ä»¥å‰çœ‹ SICP çš„æ—¶å€™å°è¯•åœ¨ windows ä¸‹ä½¿ç”¨ emacs æ—¶å—åˆ°äº†æƒŠå“ï¼Œé‚£åˆ€è€•ç«ç§ä¸€èˆ¬çš„ç•Œé¢å•Šã€‚åæ¥åœ¨ Ubuntu ç»ˆç«¯ä¸­æ‰“å¼€ï¼Œè¯¶ï¼Ÿæ€ä¹ˆå…³ä¸æ‰ï¼Ÿä¸æ‰ï¼Ÿæ‰
      
    
    </summary>
    
    
      <category term="emacs" scheme="http://hikerpig.github.io/tags/emacs/"/>
    
      <category term="editor" scheme="http://hikerpig.github.io/tags/editor/"/>
    
      <category term="productivity" scheme="http://hikerpig.github.io/tags/productivity/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯ Log å°è®°</title>
    <link href="http://hikerpig.github.io/2016/12/21/2016-12-21-Enhanced-Client-Side-Console/"/>
    <id>http://hikerpig.github.io/2016/12/21/2016-12-21-Enhanced-Client-Side-Console/</id>
    <published>2016-12-20T16:00:00.000Z</published>
    <updated>2018-08-26T08:52:02.072Z</updated>
    
    <content type="html"><![CDATA[<p>ç›¸ä¿¡å„ä½å‰ç«¯å·¥ç¨‹å¸ˆä»¬éƒ½ç»å†è¿‡ä¸€ä¸ªé»‘æš—çš„åœºæ™¯ã€‚</p><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/stack-or-gtfo.jpg" alt="undefined" title="undefined"><p>(å“å“Ÿå“å“Ÿæµ‹è¯•å¤§äººæˆ‘ä»€ä¹ˆä¹Ÿæ²¡è¯´)</p><p>æ›¾ç»æœ‰ä¸€ä¸ªå‡ºç°bugçš„é¡µé¢å‡ºç°åœ¨æˆ‘é¢å‰ï¼Œæˆ‘æ²¡æœ‰çæƒœï¼Œç›´åˆ°ç”¨æˆ·å…³æ‰é¡µé¢äº†ï¼Œæ‰åæ‚”è«åŠã€‚</p><p>è€Œä¸”é”™è¯¯ä¸èƒ½ç­‰åˆ°ç”¨æˆ·åé¦ˆäº†æ‰å»æ¢ç©¶ï¼Œæœ€å¥½æœ‰å®Œå¤‡çš„æ”¶é›†å’Œå“åº”ç³»ç»Ÿï¼Œç§¯æçš„é”™è¯¯æ—¥å¿—åˆ†æï¼Œä½¿æˆ‘ä»¬é˜²æ‚£äºæœªç„¶ã€‚</p><h2 id="æˆç†Ÿçš„-saas-æœåŠ¡">æˆç†Ÿçš„ SaaS æœåŠ¡</h2><p>é€‰æ‹©è¿˜æ˜¯æŒºå¤šçš„ï¼Œä¾‹å¦‚ <a href="http://trackjs.com/" target="_blank" rel="noopener">track.js</a>ï¼Œ<a href="https://sentry.io" target="_blank" rel="noopener">Sentry</a>ï¼Œ<a href="https://errorception.com/" target="_blank" rel="noopener">ErrorCeption</a>ï¼Œ<a href="https://www.loggly.com/" target="_blank" rel="noopener">Loggly</a>ï¼Œ<a href="https://airbrake.io/" target="_blank" rel="noopener">Airbrke</a>ã€‚éƒ½æ¯”è¾ƒæˆç†Ÿï¼Œå„å®¶å„æœ‰ç‰¹è‰²ï¼Œé›†æˆç›¸å¯¹ç®€å•ã€‚</p><h3 id="track.jstrackjs"><a href="http://trackjs.com/" target="_blank" rel="noopener">{track.js}</a></h3><p>é„™å…¬å¸åœ¨ä½¿ç”¨çš„æœåŠ¡ï¼Œååˆ†å¥½ç”¨ï¼Œæ¯”èµ·å…¶ä»–å‡ ä¸ªé€‰é¡¹ï¼Œåªä¸“æ³¨åœ¨å‰ç«¯é”™è¯¯æ—¥å¿—ï¼Œé™¤äº†åŸºæœ¬çš„è®°å½•ã€sourcemapæ”¯æŒä»¥åŠé”™è¯¯æ ˆè¿½è¸ªä»¥å¤–ï¼Œæä¾›çš„äº‹ä»¶è®°å½•å’Œæ—¶é—´è½´åŠŸèƒ½ï¼Œè®°å½•äº†æ‰€æœ‰ç½‘ç»œè¯·æ±‚ä»¥åŠç”¨æˆ·æ“ä½œ(çš†å¯é…ç½®å¼€å…³)ï¼Œèƒ½è®©ä½ æ›´å¥½åœ°é‡ç°å¼‚å¸¸å‘ç”Ÿçš„è¿‡ç¨‹ã€‚ååˆ†æ¨èå¤§å®¶è¯•è¯•ï¼Œè¯•ç”¨æœŸæœ‰30å¤©ï¼Œåœ¨è‡ªå·±çš„é¡¹ç›®é‡Œå…ˆè¯•è¯•å§ã€‚</p><h3 id="sentrysentry"><a href="https://sentry.io" target="_blank" rel="noopener">Sentry</a></h3><p>æœ‰è·¨è¯­è¨€å’Œå¤šæ¡†æ¶é›†æˆæ”¯æŒï¼Œå‰åç«¯çš†å¯ç”¨ï¼Œæœ‰å…è´¹çš„ç¤¾åŒºç‰ˆæœ¬ã€‚</p><p>å€¼å¾—ä¸€è¯´çš„æ˜¯æµè§ˆå™¨ç«¯çš„åº“åå­—æ˜¯<code>raven</code>ï¼Œçœ‹äº†ä¸å¾—ä¸ä¸ºè¿™ä¸ªæ¢—ç‚¹ä¸ªèµã€‚</p><figure><img src="http://www.30play.com/manage/editor/UploadFile/2014108143616129.jpg" alt="X-Men"><figcaption>X-Men</figcaption></figure><h2 id="é”™è¯¯æ ˆè¿½è¸ªstack-trace">é”™è¯¯æ ˆè¿½è¸ª(Stack Trace)</h2><p>å¦‚æœä¸ä½¿ç”¨è‡ªå¸¦ parser çš„æœåŠ¡è€Œæ˜¯è‡ªå·±å®ç°å‰ååŠŸèƒ½ï¼Œå¯èƒ½åœ¨å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œæœ€å¥½åšä¸€äº›å¤„ç†ï¼Œä¾‹å¦‚ç”Ÿæˆæ›´å¯è¯»çš„é”™è¯¯æ ˆï¼Œä¼šè®©ä½ å·¥ä½œæ›´åŠ è½»æ¾ã€‚æ ˆä¿¡æ¯å¯¹äºå®šä½å’Œè°ƒè¯•é”™è¯¯æ˜¯ååˆ†é‡è¦çš„ã€‚</p><h3 id="ç¬¬ä¸‰æ–¹åº“">ç¬¬ä¸‰æ–¹åº“</h3><h4 id="tracekit"><a href="https://github.com/csnover/TraceKit" target="_blank" rel="noopener">TraceKit</a></h4><pre><code class="hljs javascript"><span class="hljs-comment">// å…ˆæ³¨å†Œä¸€ä¸‹æŠ¥å‘Šçš„è¡Œä¸ºå›è°ƒ</span>TraceKit.report.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">yourLogger</span>(<span class="hljs-params">errorReport</span>) </span>&#123;  <span class="hljs-comment">// å‘é€ajaxè¯·æ±‚åˆ°æœåŠ¡å™¨ç«¯</span>  <span class="hljs-comment">// åœ¨ https://gist.github.com/4491219 ä¸Šæœ‰ä¸ªå¥½ä¾‹å­</span>&#125;;<span class="hljs-comment">// å¼€å§‹å†™ç¨‹åº</span><span class="hljs-keyword">try</span> &#123;  <span class="hljs-comment">/*   * your application code here   *   */</span>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'oops'</span>);&#125; <span class="hljs-keyword">catch</span> (e) &#123;  TraceKit.report(e); <span class="hljs-comment">//error with stack trace gets normalized and sent to subscriber</span>&#125;</code></pre><h4 id="stacktrace.js"><a href="http://stacktracejs.com/" target="_blank" rel="noopener">stacktrace.js</a></h4><p>è§£æé”™è¯¯æ ˆå¹¶ä¸”ç»™å‡ºç»“æ„åŒ–è¡¨ç¤ºï¼Œapi è®¾è®¡æ»¡è¶³ Promise è§„èŒƒã€‚</p><p>å®˜æ–¹ç»™å‡ºçš„ä¾‹å­:</p><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> callback = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">stackframes</span>) </span>&#123;  <span class="hljs-keyword">var</span> stringifiedStack = stackframes.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sf</span>) </span>&#123;    <span class="hljs-keyword">return</span> sf.toString();  &#125;).join(<span class="hljs-string">'\n'</span>);  <span class="hljs-built_in">console</span>.log(stringifiedStack);&#125;;<span class="hljs-keyword">var</span> errback = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>&#123; <span class="hljs-built_in">console</span>.log(err.message); &#125;;<span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg, file, line, col, error</span>) </span>&#123;  <span class="hljs-comment">// callback is called with an Array[StackFrame]</span>  StackTrace.fromError(error).then(callback).catch(errback);&#125;;</code></pre><h3 id="æå‡å¼€å‘æ—¶console-logä½“éªŒçš„è½»é‡ç¬¬ä¸‰æ–¹åº“">æå‡å¼€å‘æ—¶Console logä½“éªŒçš„è½»é‡ç¬¬ä¸‰æ–¹åº“</h3><h4 id="logdown"><a href="https://github.com/caiogondim/logdown.js" target="_blank" rel="noopener">Logdown</a></h4><p>nodeå’Œæµè§ˆå™¨ç«¯éƒ½å¯ä»¥ä½¿ç”¨çš„ä¸€ä¸ªå·¥å…·ã€‚</p><p>æä¾›å‘½åç©ºé—´ï¼Œå¹¶èƒ½åˆ†åˆ«å¼€å…³å„å‘½åç©ºé—´çš„log:</p><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> uiLogger = <span class="hljs-keyword">new</span> Logdown(&#123;<span class="hljs-attr">prefix</span>: <span class="hljs-string">'MyApp:UI'</span>&#125;);<span class="hljs-keyword">var</span> networkServiceLogger = <span class="hljs-keyword">new</span> Logdown(&#123;<span class="hljs-attr">prefix</span>: <span class="hljs-string">'MyApp:Network'</span>&#125;);Logdown.disable(<span class="hljs-string">'MyApp:UI'</span>);Logdown.enable(<span class="hljs-string">'MyApp:Network'</span>);Logdown.disable(<span class="hljs-string">'MyApp:*'</span>); <span class="hljs-comment">// æ”¯æŒé€šé…ç¬¦</span></code></pre><p>è¿˜æ”¯æŒ markdown è¯­æ³•:</p><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> logger = <span class="hljs-keyword">new</span> Logdown(&#123;<span class="hljs-attr">markdown</span>: <span class="hljs-literal">true</span>&#125;);logger.warn(<span class="hljs-string">'Log is *Awesome*'</span>);</code></pre><p>å¯ä»¥çœ‹çœ‹ä½œè€…ç»™çš„<a href="https://caiogondim.github.io/logdown.js/" target="_blank" rel="noopener">ä¾‹å­</a></p><img src="//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/logdown.js.png" alt="undefined" title="undefined"><h1 id="æœ€å">æœ€å</h1><p>é”™è¯¯æ—¥å¿—æ”¶é›†å®Œäº†è®°ä½è¦å»çœ‹å“Ÿã€‚</p><h1 id="å‚è€ƒ">å‚è€ƒ</h1><ul><li><a href="https://www.sitepoint.com/logging-errors-client-side-apps/" target="_blank" rel="noopener">Logging Errors in Client-Side Applications</a>: åŸºæœ¬ä¸Šæ˜¯åŸæ–‡</li><li>é¢˜å›¾æ¥è‡ª<a href="https://github.com/csnover/TraceKit" target="_blank" rel="noopener">TraceKit</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç›¸ä¿¡å„ä½å‰ç«¯å·¥ç¨‹å¸ˆä»¬éƒ½ç»å†è¿‡ä¸€ä¸ªé»‘æš—çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;img src=&quot;//images-hikerpig.oss-cn-beijing.aliyuncs.com/image/stack-or-gtfo.jpg&quot; alt=&quot;undefined&quot; title=&quot;undefi
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Engineering" scheme="http://hikerpig.github.io/tags/Engineering/"/>
    
  </entry>
  
  <entry>
    <title>[è¯‘] ä½¿ç”¨é‡æ„ä»¶ï¼ˆCodemodï¼‰åŠ é€Ÿ JavaScript å¼€å‘</title>
    <link href="http://hikerpig.github.io/2016/06/30/2016-06-02-turbocharged-javascript-refactoring-with-codemods/"/>
    <id>http://hikerpig.github.io/2016/06/30/2016-06-02-turbocharged-javascript-refactoring-with-codemods/</id>
    <published>2016-06-29T16:00:00.000Z</published>
    <updated>2018-08-26T08:57:39.030Z</updated>
    
    <content type="html"><![CDATA[<ul><li>åŸæ–‡é“¾æ¥ : <a href="https://medium.com/airbnb-engineering/turbocharged-javascript-refactoring-with-codemods-b0cae8b326b9#.tjerodd52" target="_blank" rel="noopener">Turbocharged JavaScript refactoring with codemods</a></li><li>åŸæ–‡ä½œè€… : <a href="https://medium.com/u/e52389684329" target="_blank" rel="noopener">Joe Lencioni</a></li></ul><h3 id="ä½¿ç”¨é‡æ„ä»¶codemodåŠ é€Ÿ-javascript-å¼€å‘">ä½¿ç”¨é‡æ„ä»¶ï¼ˆCodemodï¼‰åŠ é€Ÿ JavaScript å¼€å‘</h3><p>åœ¨èŠ±å›­é‡Œè€•è€˜ä¹è¶£æ— ç©·ï¼Œä½†å¦‚æœé™¤è‰ä¸å‹¤ï¼Œæœ€åæ”¶è·å¯èƒ½æ˜¯ä¸€å›¢æªå¿ƒã€‚æ¼æ‰ä¸€æ¬¡é™¤è‰æœ¬èº«å¯èƒ½å¹¶æ— å¤§ç¢ï¼Œä½†ç§¯å°‘æˆå¤šæœ€åä¼šæ¯æ‰æ•´åº§èŠ±å›­ã€‚æ²¡æœ‰æ‚è‰çš„èŠ±å›­è®©ç»´æŠ¤å·¥ä½œç¥æ¸…æ°”çˆ½ã€‚è¿™ä¸ªé“ç†å¯¹ä»£ç åº“ä¹Ÿç±»ä¼¼ã€‚</p><p>æˆ‘é€šå¸¸è®¨åŒé™¤è‰ï¼Œç»å¸¸å¿˜è®°è¿™äº‹çš„ç»“æœå°±æ˜¯ä¸€å›¢ç³Ÿã€‚è°¢å¤©è°¢åœ°åœ¨ç¼–ç¨‹ç•Œæœ‰åƒ <a href="http://eslint.org/" target="_blank" rel="noopener">ESLint</a> å’Œ <a href="https://github.com/brigade/scss-lint" target="_blank" rel="noopener">SCSS-Lint</a> è¿™æ ·çš„å¥½ä¸œè¥¿æé†’æˆ‘ä»¬å‹¤ç†ä»£ç ã€‚ä½†æ˜¯å¦‚æœé¢å¯¹çš„æ˜¯å¤§æ®µå¤§æ®µçš„å†å²ä»£ç ï¼Œå…‰æ˜¯æƒ³æƒ³è¦æ‰‹åŠ¨è°ƒæ•´æˆç™¾ååƒä¸‡çš„ç©ºæ ¼å’Œé€—å·ï¼Œæ‚²ä¼¤ä¾¿é€†æµæˆæ²³ã€‚</p><p>8å¹´æ¥æœ‰å‡ ç™¾ä¸‡è¡Œ JavaScript ä»£ç è¿›å…¥ Airbnb çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ã€‚åŒæ—¶ï¼Œå‰ç«¯ç•Œé£èµ·äº‘æ¶Œã€‚æ–°åŠŸèƒ½ï¼Œæ–°æ¡†æ¶ï¼Œç”šè‡³ JavaScript æœ¬èº«éƒ½åœ¨å¿«é€Ÿè¿›åŒ–ã€‚å°½ç®¡éµå¾ª<a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener">è‰¯å¥½çš„ä»£ç é£æ ¼</a>ä¼šè®©å˜é©å°‘äº›ç–¼ç—›ï¼Œä½†è¿˜æ˜¯å¾ˆå®¹æ˜“ç´¯ç§¯å‡ºä¸å†éµå¾ªæœ€æ–°â€œæœ€ä½³å®è·µâ€çš„å·¨å¤§ä»£ç åº“ã€‚æ¯ä¸€å¤„ä»£ç é£æ ¼çš„ä¸ä¸€è‡´éƒ½æ˜¯ä¸€æ£µæ‚è‰ï¼Œå”¯ä¸€å½’å®¿å°±æ˜¯è¢«é“²æ‰ï¼ŒåŒ–ä½œæ˜¥æ³¥æ›´æŠ¤èŠ±ï¼Œå¥½è®©å¼€å‘å›¢é˜Ÿä¿æŒé«˜æ•ˆã€‚æ¥çœ‹çœ‹æˆ‘ä»¬èŠ±å›­ç°åœ¨çš„æ ·å­ï¼š</p><p><img src="http://ww1.sinaimg.cn/large/005SiNxygw1f3j83hmmrij30jk0dvjsn.jpg"></p><p>æˆ‘æ‰§ç€äºå¢åŠ å›¢é˜Ÿæ•ˆç‡ï¼Œä¹Ÿæ·±çŸ¥ä¿æŒä¸€è‡´æ€§çš„ä»£ç èƒ½å¢é€Ÿå›¢é˜Ÿåé¦ˆå’Œå‡å°‘æ— æ•ˆæ²Ÿé€šã€‚æˆ‘ä»¬æœ€è¿‘å¼€å§‹äº†ä¸€ä¸ªæ•´ç†ä»£ç çš„é¡¹ç›®ï¼Œå‡†å¤‡æŠŠè®¸å¤šé™ˆæ—§çš„ JavaScript ä»£ç è½¬åŒ–å¾—ç¬¦åˆæˆ‘ä»¬çš„ä»£ç é£æ ¼ï¼Œäº¦ä½¿æˆ‘ä»¬çš„ä»£ç æ£€éªŒå™¨æœ‰æ›´å¤šç”¨æ­¦ä¹‹åœ°ã€‚è‹¥å…¨éƒ½æ‰‹åŠ¨å®Œæˆï¼Œä¼šæ˜¯ä»¶ååˆ†æ— èŠå’Œè€—æ—¶çš„è‹¦å·®ï¼Œæ‰€ä»¥æˆ‘ä»¬å€ŸåŠ©å·¥å…·å¸®æˆ‘ä»¬è‡ªåŠ¨åŒ–æ­¤å·¥ä½œã€‚è™½è¯´ä½¿ç”¨ <em><code>eslint -fix</code></em> æ˜¯ä¸ªä¸é”™çš„å¼€å§‹ï¼Œä½†<a href="https://github.com/eslint/eslint/issues/5329" target="_blank" rel="noopener">å®ƒç°åœ¨æ‰€èƒ½æœ‰é™</a>ã€‚å°½ç®¡ä»–ä»¬<a href="https://twitter.com/geteslint/status/723909416957829122" target="_blank" rel="noopener">æœ€è¿‘å¼€å§‹æ¥å—ä¿®å¤æ‰€æœ‰è§„åˆ™çš„PR</a>ï¼Œä¹Ÿå‡†å¤‡<a href="https://github.com/cst/cst" target="_blank" rel="noopener">æ„å»º JavaScript çš„å…·ä½“è¯­æ³•æ ‘</a>ï¼Œä½†ç­‰è¿™äº›åŠŸèƒ½å®Œæˆè¿˜éœ€è¦äº›æ—¶é—´ã€‚æ„Ÿè°¢ä¸Šè‹æˆ‘ä»¬å‘ç°äº† Facebook çš„ <a href="https://github.com/facebook/jscodeshift" target="_blank" rel="noopener">jscodeshift</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡æ„å·¥å…·ï¼ˆååŠ©å¤§å‹ä»£ç åº“çš„è‡ªåŠ¨åŒ–é‡æ„ï¼‰ã€‚å¦‚æœä»£ç åº“æ˜¯ä¸ªèŠ±å›­ï¼Œé‚£ä¹ˆ jscodeshift å°±åƒä¸ªé™¤è‰æœºå™¨äººã€‚</p><p>æ­¤å·¥å…·å°† JavaScript è§£æä¸ºä¸€æ£µ <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="noopener">æŠ½è±¡è¯­æ³•æ ‘</a>ï¼Œå¹¶åœ¨å…¶ä¸Šè¿›è¡Œå˜æ¢ï¼Œç„¶åè¾“å‡ºç¬¦åˆæŒ‡å®šä»£ç é£æ ¼çš„æ–° JavaScript ä»£ç ã€‚è½¬æ¢è¿‡ç¨‹æ˜¯ç”¨ JavaScript æœ¬èº«å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å›¢é˜Ÿå¾ˆä¹æ„ä½¿ç”¨æ­¤å·¥å…·ã€‚å¯»æ‰¾æˆ–æ˜¯åˆ›å»ºè½¬æ¢ä»£ç èƒ½åŠ é€Ÿæˆ‘ä»¬ä¹å‘³çš„é‡æ„ï¼Œè®©æˆ‘ä»¬å›¢é˜Ÿèƒ½å¤Ÿä¸“æ³¨äºæ›´æœ‰æ„ä¹‰çš„å·¥ä½œã€‚</p><p>è¿è¡Œå‡ ä¸ªä»£ç é‡æ„ä»¶åï¼Œæˆ‘ä»¬çš„èŠ±å›­æ•´æ´äº†ç‚¹ï¼š</p><p><img src="http://ww4.sinaimg.cn/large/a490147fjw1f3j9ybpgazj20je0flwfm.jpg"></p><h3 id="ç­–ç•¥">ç­–ç•¥</h3><p>é‰´äºå¤šæ•°é‡æ„ä»¶èƒ½åœ¨ä¸€åˆ†é’Ÿå†…å¤„ç†ä¸Šåƒæ–‡ä»¶ï¼Œæˆ‘å‘ç°å®ƒæ˜¯æˆ‘æ‰“å‘ä¸»è¦å·¥ä½œçš„ç­‰å¾…é—´éš™ï¼ˆä¾‹å¦‚ç­‰ä»£ç å®¡æŸ¥ï¼‰çš„ä¸é”™é€‰æ‹©ã€‚å®ƒå¸®æˆ‘æœ€å¤§åŒ–æå‡äº†å·¥ä½œæ•ˆç‡ä»è€Œè®©æˆ‘èƒ½åœ¨æ›´å¤§å’Œæ›´é‡è¦çš„é¡¹ç›®ä¸­æœ‰æ‰€å»ºæ ‘ã€‚</p><p>å¤§è§„æ¨¡é‡æ„ä¸»è¦é¢ä¸´å››å¤§æŒ‘æˆ˜ã€‚æ²Ÿé€šã€æ­£ç¡®æ€§ã€ä»£ç å®¡æŸ¥ä»¥åŠå†²çªåˆå¹¶ã€‚æˆ‘é‡‡å–ä»¥ä¸‹ç­–ç•¥æ¥åº”å¯¹è¿™äº›æŒ‘æˆ˜ã€‚</p><p>é‡æ„ä»¶ä¸æ€»æ˜¯èƒ½äº§å‡ºæˆ‘éœ€è¦çš„ç»“æœï¼Œå› æ­¤å¯¹å…¶ç»“æœçš„å®¡æŸ¥å’Œæ”¹åŠ¨ååˆ†é‡è¦ã€‚ä»¥ä¸‹å‘½ä»¤åœ¨è·‘å®Œé‡æ„ä»¶åå¾ˆæœ‰ç”¨ï¼š</p><pre><code>git diffgit add --patchgit checkout --patch</code></pre><p>ä¿æŒæ¯ä¸ªæäº¤å’Œ PR åœ¨å°çš„ä½“é‡æ˜¯å¥½çš„åšæ³•ï¼Œå¯¹äºé‡æ„ä»¶ä¹Ÿä¸ä¾‹å¤–ã€‚æˆ‘é€šå¸¸ä¸€æ®µæ—¶é—´å†…è¿›è¡Œä¸€ç±»é‡æ„ï¼Œå‡å°‘ä»£ç å®¡æŸ¥å’Œå†²çªåˆå¹¶çš„éº»çƒ¦ã€‚æˆ‘äº¦ç»å¸¸è®©é‡æ„ä»¶è‡ªåŠ¨æäº¤é‡æ„ç»“æœï¼Œè€Œåè‹¥æœ‰å¿…è¦ï¼Œå†æ‰‹åŠ¨æ¸…ç†ã€‚è¿™æ ·åœ¨è¡åˆåˆ†æ”¯æ—¶è§£å†³å†²çªä¼šè½»æ¾ç‚¹ï¼Œå› ä¸ºæˆ‘å¯ä»¥ä½¿ç”¨</p><pre><code>git checkout --ours path/to/conflict</code></pre><p>ç„¶ååœ¨é‚£ä¸ªæ–‡ä»¶ä¸Šå†è¿è¡Œä¸€æ¬¡é‡æ„ä»¶ï¼Œä¹‹åä¹Ÿä¸ä¼šå¼„ä¹±æˆ‘è‡ªå·±çš„æ‰‹åŠ¨æäº¤ã€‚</p><p>æœ‰æ—¶é‡æ„ä»¶ç”Ÿæˆäº†å¾ˆå¤§çš„å˜åŠ¨ï¼Œæˆ‘è§‰å¾—åœ¨æ­¤æƒ…å†µä¸‹æ ¹æ®ç›®å½•æˆ–æ–‡ä»¶åæ¥åˆ†æˆæ•°æ¬¡æäº¤æˆ– PR ä¼šæ¯”è¾ƒå¥½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæäº¤é‡æ„ .js æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæäº¤é‡æ„.jsx æ–‡ä»¶ã€‚è¿™æ ·ä¹‹åä»£ç å®¡æŸ¥å’Œå†²çªåˆå¹¶ä¼šç›¸å¯¹è½»æ¾ä¸€ç‚¹ã€‚è°¨éµ <a href="https://en.wikipedia.org/wiki/Unix_philosophy" target="_blank" rel="noopener">Unix å“²å­¦</a>ï¼Œåˆ†æ‰¹è¿›è¡Œæ–‡ä»¶é‡æ„ç®€å•åˆ°ä»…éœ€è°ƒæ•´ <em><code>find</code></em> å‘½ä»¤çš„å‚æ•°ï¼š</p><pre><code>find app/assets/javascripts -name *.jsx -not -path */vendor/* | \  xargs jscodeshift -t ~/path/to/transform.js</code></pre><p>ä¸ºé¿å…å’Œåˆ«äººçš„ä»£ç å†²çªï¼Œæˆ‘é€šå¸¸åœ¨å‘¨äº”æ—©ä¸Šæ‰æ¨é€æˆ‘çš„é‡æ„ä»¶ç”Ÿæˆçš„æäº¤ï¼Œç„¶åå‘¨ä¸€èµ¶åœ¨å¤§å®¶å¼€å§‹å·¥ä½œä¹‹å‰è¿›è¡Œè¡åˆå’Œåˆå¹¶ã€‚è¿™æ ·å…¶ä»–äººå‘¨æœ«æ”¾å‡å‰ä¸è¢«ä½ çš„é‡æ„ä»¶é˜»ç¢ï¼Œèƒ½å¥½å¥½æ•´ç†è‡ªå·±çš„å·¥ä½œæˆæœã€‚</p><h3 id="æˆ‘ä»¬ç”¨å¾—é¡ºæ‰‹çš„é‡æ„ä»¶">æˆ‘ä»¬ç”¨å¾—é¡ºæ‰‹çš„é‡æ„ä»¶</h3><p>è™½ç„¶æ­¤å·¥å…·è¿˜æ¯”è¾ƒæ–°ï¼Œå·²ç„¶æœ‰äº†ä¸€äº›å®ç”¨çš„é‡æ„ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘ä»¬æˆåŠŸä¸Šæ‰‹äº†çš„ã€‚</p><h4 id="è½»é‡çº§é‡æ„ä»¶">è½»é‡çº§é‡æ„ä»¶</h4><p>ä»¥ä¸‹æ˜¯äº›ç”¨ç€ä¸é‚£ä¹ˆç—›è‹¦çš„ï¼Œç«‹åˆ»ä¸Šæ‰‹æ„Ÿå—æˆæ•ˆã€‚</p><p><a href="https://github.com/cpojer/js-codemod#arrow-function" target="_blank" rel="noopener"><strong>js-codemod/arrow-function</strong></a><strong>:</strong> è°¨æ…åœ°æŠŠå‡½æ•°è½¬ä¸ºç®­å¤´å‡½æ•°</p><p>ä½¿ç”¨å‰:</p><pre><code>[1, 2, 3].map(function(x) {  return x * x;}.bind(this));</code></pre><p>ä½¿ç”¨å:</p><pre><code>[1, 2, 3].map(x =&gt; x * x);</code></pre><p><a href="https://github.com/cpojer/js-codemod#no-vars" target="_blank" rel="noopener"><strong>js-codemod/no-vars</strong></a><strong>:</strong> å°† <em><code>var'_ å®‰å…¨è½¬åŒ–ä¸º _</code>const<code>_ æˆ– _</code>let`</em>ã€‚</p><p>ä½¿ç”¨å‰:</p><pre><code>var belong = &#39;anywhere&#39;;</code></pre><p>ä½¿ç”¨å:</p><pre><code>const belong = &#39;anywhere&#39;;</code></pre><p><a href="https://github.com/cpojer/js-codemod#object-shorthand" target="_blank" rel="noopener"><strong>js-codemod/object-shorthand</strong></a><strong>:</strong> æŠŠå¯¹è±¡å­—é¢é‡è½¬ä¸º ES6 çš„ç®€å†™è¡¨ç¤ºã€‚</p><p>ä½¿ç”¨å‰:</p><pre><code>const things = {  belong: belong,  anywhere: function() {},};</code></pre><p>ä½¿ç”¨å:</p><pre><code>const things = {  belong,  anywhere() {},};</code></pre><p><a href="https://github.com/cpojer/js-codemod#unchain-variables" target="_blank" rel="noopener"><strong>js-codemod/unchain-variables</strong></a><strong>:</strong> åˆ†ç¦»è¿ç»­å£°æ˜çš„å˜é‡ã€‚</p><p>ä½¿ç”¨å‰:</p><pre><code>const belong = &#39;anywhere&#39;, welcome = &#39;home&#39;;</code></pre><p>ä½¿ç”¨å:</p><pre><code>const belong = &#39;anywhere&#39;;const welcome = &#39;home&#39;;</code></pre><p><a href="https://github.com/cpojer/js-codemod#unquote-properties" target="_blank" rel="noopener"><strong>js-codemod/unquote-properties</strong></a><strong>:</strong> ç§»é™¤å¯¹è±¡å±æ€§çš„å¼•å·ã€‚</p><p>ä½¿ç”¨å‰:</p><pre><code>const things = {  &#39;belong&#39;: &#39;anywhere&#39;,};</code></pre><p>ä½¿ç”¨å:</p><pre><code>const things = {  belong: &#39;anywhere&#39;,};</code></pre><h4 id="é‡é‡çº§é‡æ„ä»¶">é‡é‡çº§é‡æ„ä»¶</h4><p>ä»¥ä¸‹é‡æ„ä»¶æˆ–æ˜¯æ”¹åŠ¨å¾ˆå¤šä»£ç å¼•å‘åˆå¹¶å’Œå†²çªä¹‹ç—›ï¼Œæˆ–æ˜¯éœ€è¦æ›´å¤šåç»­çš„æ‰‹åŠ¨æ›´æ”¹ä»¥ä¿è¯ä»£ç è¿˜èƒ½çœ‹å¾—ä¸‹å»ã€‚</p><p><a href="https://github.com/reactjs/react-codemod#class" target="_blank" rel="noopener"><strong>react-codemod/class</strong></a><strong>:</strong> æŠŠ <em><code>React.createClass</code></em> è½¬ä¸º ES6 class çš„å®ç°ã€‚</p><p>æ­¤é‡æ„ä»¶åœ¨æœ‰ mixin çš„æ—¶å€™ä¸ä¼šå˜æ¢ï¼Œåœ¨ç±»ä¼¼äº <em><code>propTypes</code></em>ã€é»˜è®¤ props å’Œ initial state å®šä¹‰è¿™æ ·çš„å¿…è¦è½¬æ¢åšå¾—å¾ˆå¥½ï¼Œè¿˜èƒ½å°†äº‹ä»¶å›è°ƒå‡½æ•°ç»‘å®šåˆ°æ„é€ å™¨ä¸Šã€‚</p><p>ä½¿ç”¨å‰:</p><pre><code>const BelongAnywhere = React.createClass({  // ...});</code></pre><p>ä½¿ç”¨å:</p><pre><code>class BelongAnywhere extends React.Component {  // ...}</code></pre><p><a href="https://github.com/reactjs/react-codemod#sort-comp" target="_blank" rel="noopener"><strong>react-codemod/sort-comp</strong></a><strong>:</strong> æ ¹æ® <a href="https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/sort-comp.md" target="_blank" rel="noopener">ESLint react/sort-comp rule</a> é‡æ–°ç»„ç»‡ React component çš„æ–¹æ³•å£°æ˜é¡ºåºã€‚</p><p>è¿™ä¸ªä¼šè°ƒæ•´å¤§é‡ä»£ç ï¼Œgit ä¸ä¼šè‡ªåŠ¨åˆå¹¶å†²çªã€‚æˆ‘è§‰å¾—åœ¨ä½¿ç”¨æ­¤é‡æ„ä»¶å‰æœ€å¥½æœ€å¥½è·Ÿé˜Ÿå‹æ‰“ä¸ªæ‹›å‘¼ï¼Œåœ¨ä¸å¤ªå®¹æ˜“å‘ç”Ÿå†²çªçš„æ—¶å€™ï¼ˆä¾‹å¦‚å‘¨æœ«ï¼‰è¿›è¡Œé‡æ„ã€‚å½“æˆ‘è¡åˆæ­¤é‡æ„çš„æäº¤ä¸”é‡ä¸Šå†²çªçš„æ—¶å€™ï¼Œæˆ‘ä¼šï¼š</p><pre><code>git checkout --ours path/to/conflict</code></pre><p>ç„¶åå†è¿è¡Œä¸€æ¬¡é‡æ„ä»¶ã€‚</p><p>ä½¿ç”¨å‰:</p><pre><code>class BelongAnywhere extends React.Component {  render() {    return &lt;div&gt;Belong Anywhere&lt;/div&gt;;  }  componentWillMount() {      console.log(&#39;Welcome home&#39;);    }  }</code></pre><p>ä½¿ç”¨å:</p><pre><code>class BelongAnywhere extends React.Component {  componentWillMount() {    console.log(&#39;Welcome home&#39;);  } render() {    return &lt;div&gt;Belong Anywhere&lt;/div&gt;;  }}</code></pre><p><a href="https://github.com/cpojer/js-codemod#template-literals" target="_blank" rel="noopener"><strong>js-codemod/template-literals</strong></a><strong>:</strong> æŠŠå­—ç¬¦ä¸²çš„ä¸²è”è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¨¡æ¿å­—é¢é‡è¡¨ç¤ºã€‚</p><p>å› ä¸ºæˆ‘ä»¬å¤šå¤„ç”¨åˆ°å­—ç¬¦ä¸²ä¸²è”ï¼Œè€Œä¸”è¿™ä¸ªé‡æ„ä»¶å°½å…¶æ‰€èƒ½æŠŠæ‰€æœ‰å­—ç¬¦ä¸²éƒ½è½¬æˆæ¨¡æ¿ï¼Œæˆ‘å‘ç°å¾ˆå¤šè½¬æ¢ç»“æœå…¶å®å¹¶ä¸åˆç†ã€‚æˆ‘ä¹‹æ‰€ä»¥è¿™ä¸ªé‡æ„ä»¶æ”¾åˆ°â€œé‡é‡çº§â€åˆ—è¡¨é‡Œï¼Œæ˜¯å› ä¸ºå®ƒä¼šæ”¹åŠ¨å¾ˆå¤šæ–‡ä»¶ï¼Œè€Œä¸”ä¹‹åæˆ‘ä»¬è¿˜å¾—è¿›è¡Œå¤§é‡çš„æ‰‹åŠ¨ä¿®æ”¹æ‰èƒ½å¾—åˆ°æ»¡æ„çš„ç»“æœã€‚</p><p>ä½¿ç”¨å‰:</p><pre><code>const belong = &#39;anywhere &#39;+ welcomeHome;</code></pre><p>ä½¿ç”¨å:</p><pre><code>const belong = `anywhere ${welcomeHome}`;</code></pre><h3 id="èµ„æº">èµ„æº</h3><p>è‹¥ä½ æƒ³å†™è‡ªå·±çš„é‡æ„ä»¶ï¼Œæˆ–æ˜¯çœ‹çœ‹å®ƒèƒ½åšä»€ä¹ˆï¼Œå¯ä»¥çœ‹ä¸‹ä¸‹é¢çš„èµ„æºã€‚</p><ul><li><a href="https://www.youtube.com/watch?v=d0pOgY8__JM" target="_blank" rel="noopener">é€æ­¥æ”¹è¿›å¤æ‚ç³»ç»Ÿ</a>ï¼šæ¥è‡ª Christoph Pojer äº JSConf EU 2015 ä¸Šå…³äº Facebook çš„é‡æ„ä»¶çš„æ¼”è®²ã€‚ï¼ˆäº¦å¯è§<a href="https://medium.com/@cpojer/effective-javascript-codemods-5a6686bb46fb" target="_blank" rel="noopener">é«˜æ•ˆçš„ JavaScript é‡æ„ä»¶</a>ï¼‰ã€‚</li><li><a href="https://vramana.github.io/blog/2015/12/21/codemod-tutorial/" target="_blank" rel="noopener">å¦‚ä½•å†™é‡æ„ä»¶</a>: å¸¦ä½ å†™ä¸€ä¸ªæŠŠå­—ç¬¦ä¸²ä¸²è”è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ¨¡æ¿å­—é¢é‡çš„é‡æ„ä»¶çš„æ•™ç¨‹ã€‚</li><li><a href="https://astexplorer.net/" target="_blank" rel="noopener">AST æ¢ç´¢</a>: å¯æŸ¥çœ‹ç”±å¤šç§è¯­æ³•åˆ†æç¨‹åºäº§ç”Ÿçš„ AST çš„å·¥å…·ã€‚å¥½ä¸œè¥¿ï¼Œå¯ä»¥æŸ¥çœ‹ä½ æƒ³è½¬æ¢çš„ä»£ç çš„ ASTã€‚</li><li><a href="https://medium.com/nfl-engineers/nfl-codemods-migrating-a-monolith-1e3363571707" target="_blank" rel="noopener">NFL â™¥ Cé‡æ„ä»¶: æµ·é‡ä»£ç è¿ç§»</a>: å…³äº NFL å¦‚ä½•ä½¿ç”¨é‡æ„ä»¶çš„ä¸€ä¸ªä½¿ç”¨æ¡ˆä¾‹ã€‚</li><li><a href="https://github.com/reactjs/react-codemod" target="_blank" rel="noopener">react-codemod</a>: ä¸€ç³»åˆ—å…³äº React çš„é‡æ„ä»¶ã€‚</li><li><a href="https://github.com/cpojer/js-codemod" target="_blank" rel="noopener">js-codemod</a>: ä¸€ç³»åˆ—å¸¸ç”¨çš„ JavaScript é‡æ„ä»¶ã€‚</li></ul><h3 id="å½±å“">å½±å“</h3><p>åœ¨ä½¿ç”¨äº†ä¸€äº›ç°æˆçš„å’Œæˆ‘ä»¬è‡ªå·±å†™çš„å¹¶è´¡çŒ®ç»™ç¤¾åŒºçš„é‡æ„ä»¶ä¹‹åï¼Œæˆ‘ä»¬çš„æ—§ä»£ç è´¨é‡è·å¾—å¾ˆå¤§çš„æå‡ã€‚æˆ‘ä¸è´¹å¹ç°ä¹‹åŠ›ä¾¿é‡æ„äº†40000è¡Œä»£ç ï¼Œå°†æ—§ä»£ç è°ƒæ•´è‡³ç¬¦åˆ ES6 ä»£ç é£æ ¼ã€‚èŠ±å›­ç„•ç„¶ä¸€æ–°ï¼Œæˆ‘ä»¬ä¹‹åçš„å·¥ä½œä¹Ÿæ›´æœ‰æ•ˆç‡å’Œä¹è¶£ã€‚</p><p>ä½¿ç”¨å·²æœ‰çš„é‡æ„ä»¶ä»…æ˜¯ç‰›åˆ€å°è¯•ï¼Œåªæœ‰åœ¨ä½ æ‹¿èµ·é”®ç›˜å†™å‡ºè‡ªå·±çš„é‡æ„ä»¶æ—¶ï¼ŒçœŸæ­£çš„èƒ½é‡æ‰ä¼šé‡Šæ”¾ã€‚æ— è®ºæ˜¯å¯¹ä»£ç é£æ ¼é‡æ„ï¼Œæˆ–æ˜¯å¯¹å¤±æ•ˆ API çš„è°ƒæ•´ï¼Œé‡æ„ä»¶éƒ½èƒ½å¤§æ˜¾èº«æ‰‹ï¼Œä½ å¯ä»¥å°½æƒ…æƒ³è±¡å‘æŒ¥ã€‚è¿™äº›æŠ€æœ¯å€¼å¾—å­¦ä¹ æŠ•å…¥ï¼Œèƒ½çœä¸‹ä½ å’Œä½¿ç”¨ä½ çš„é¡¹ç›®ä½¿ç”¨è€…å¾ˆå¤šæ—¶é—´ç²¾åŠ›ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;åŸæ–‡é“¾æ¥ : &lt;a href=&quot;https://medium.com/airbnb-engineering/turbocharged-javascript-refactoring-with-codemods-b0cae8b326b9#.tjerodd52&quot; ta
      
    
    </summary>
    
      <category term="å·¥å…·" scheme="http://hikerpig.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="Javascript" scheme="http://hikerpig.github.io/tags/Javascript/"/>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Engineering" scheme="http://hikerpig.github.io/tags/Engineering/"/>
    
  </entry>
  
  <entry>
    <title>[è¯‘] Javascript å§¿åŠ¿æå‡ç®€ç•¥</title>
    <link href="http://hikerpig.github.io/2016/04/28/2016-04-28-%E8%AF%91-Javascript-%E5%A7%BF%E5%8A%BF%E6%8F%90%E5%8D%87%E7%AE%80%E7%95%A5/"/>
    <id>http://hikerpig.github.io/2016/04/28/2016-04-28-è¯‘-Javascript-å§¿åŠ¿æå‡ç®€ç•¥/</id>
    <published>2016-04-27T16:00:00.000Z</published>
    <updated>2018-08-26T08:52:47.250Z</updated>
    
    <content type="html"><![CDATA[<ul><li>åŸæ–‡é“¾æ¥ : <a href="http://developer.telerik.com/featured/leveling-up-your-javascript/" target="_blank" rel="noopener">Leveling Up Your JavaScript</a></li><li>åŸæ–‡ä½œè€… : <a href="http://developer.telerik.com/author/rcamden/" target="_blank" rel="noopener">Raymond Camden</a></li></ul><p>JavaScript æ˜¯ä¸€é—¨å…¥é—¨å®¹æ˜“ï¼Œä½†æ˜¯ç›¸å½“éš¾ä»¥ç²¾é€šçš„è¯­è¨€ã€‚å¯ç°ä»Šä¸€äº›æ–‡ç« æ€»å‡è®¾ä½ å·²ç»ç²¾é€šäº†å®ƒã€‚</p><p>æˆ‘ä» 1995 å¹´ JavaScript è¿˜ä»¥ LiveScript åå­—å‡ºç°çš„æ—¶å€™å°±å¼€å§‹ç”¨å®ƒäº†ï¼Œä½†åæ¥é€æ¸ä»å‰ç«¯å¼€å‘æ’¤å›æœåŠ¡å™¨çš„å®‰å…¨æ€€æŠ±ä¸­ï¼Œç›´åˆ°äº”å¹´å‰æ‰é‡æ‹¾ã€‚å¾ˆé«˜å…´çœ‹åˆ°å¦‚ä»Šçš„æµè§ˆå™¨æ›´åŠ çš„å¼ºå¤§å’Œæ˜“äºè°ƒè¯•ã€‚ä½† JavaScript å·²ç»æ¼”å˜å¾—è¶Šæ¥è¶Šå¤æ‚ä¸”éš¾ä»¥ç²¾é€šäº†ã€‚ä¸è¿‡æœ€è¿‘æˆ‘ç»ˆäºå¾—å‡ºç»“è®ºï¼Œæˆ‘å¹¶ä¸éœ€è¦_ç²¾é€š_ Javascriptï¼Œåªéœ€è¦æ¯”ä»¥å‰æ›´è¿›ä¸€æ­¥å°±å¥½ã€‚èƒ½æˆä¸ºä¸€ä¸ªâ€œå¥½â€çš„ JavaScript å¼€å‘è€…æˆ‘ä¾¿è§‰æ¬£æ…°ã€‚</p><p>ä»¥ä¸‹æ˜¯æˆ‘å‘ç°çš„ä¸€äº›_å®ç”¨_çš„ JavaScript å°æŠ€å·§: <a href="#ç»„ç»‡ä»£ç ">ç»„ç»‡ä»£ç </a>; <a href="#ä»£ç æ£€éªŒ(Linting)">ä»£ç æ£€éªŒ</a>; <a href="#æµ‹è¯•">æµ‹è¯•</a>; ä»¥åŠ <a href="#æµè§ˆå™¨å¼€å‘è€…å·¥å…·">ä½¿ç”¨å¼€å‘è€…å·¥å…·</a>ã€‚é‡Œé¢æœ‰å‡ æ¡å¯¹æœ‰ç»éªŒçš„ JavaScript å¼€å‘è€…æ¥è¯´å¯èƒ½å¾ˆæ˜¾è€Œæ˜“è§ï¼Œä½†æ˜¯è¯­è¨€åˆå­¦è€…å¾ˆå®¹æ˜“å…»æˆåä¹ æƒ¯ã€‚è¿™äº›æŠ€å·§æé«˜äº†æˆ‘çš„æŠ€æœ¯æ°´å¹³ï¼ŒåŒæ—¶ä¹Ÿä¸ºæˆ‘çš„ç”¨æˆ·åˆ›é€ äº†æ›´å¥½çš„ä½“éªŒã€‚_è¿™_éš¾é“ä¸æ˜¯æˆ‘ä»¬æœ€å¤§çš„ç›®æ ‡ä¹ˆã€‚</p><blockquote><p>ä½ å¯åœ¨æ­¤å¤„<a href="http://developer.telerik.com/wp-content/uploads/2016/01/code.zip" target="_blank" rel="noopener">ä¸‹è½½</a>æœ¬æ–‡çš„æ ·ä¾‹ä»£ç ã€‚</p></blockquote><h2 id="ç»„ç»‡ä»£ç ">ç»„ç»‡ä»£ç </h2><p>JavaScript åˆå­¦è€…æ€»æ˜¯ä¸å¯é¿å…åœ°åœ¨ä»–ä»¬çš„ HTML é¡µé¢é‡Œå†™ä¸Šä¸€å¤§å¨ä»£ç ã€‚å¼€å§‹çš„æ—¶å€™éƒ½æ˜¯å¾ˆç®€å•çš„ï¼Œä¾‹å¦‚ä½¿ç”¨ jQuery ç»™ä¸€ä¸ªè¡¨å•è¾“å…¥è‡ªåŠ¨åŠ ä¸Šç„¦ç‚¹ï¼Œç„¶åè¦åŠ ä¸Šè¡¨å•éªŒè¯ï¼Œç„¶ååˆè¦åŠ ä¸Šä¸€äº›å¸‚åœºä¸Šèµ°ä¿çš„æ¨¡æ€æ¡†ç»„ä»¶â€”â€”å°±æ˜¯é‚£äº›é˜»æ­¢ç”¨æˆ·å¾€ä¸‹é˜…è¯»å†…å®¹å¥½è®©ä»–ä»¬åœ¨ Facebook ä¸Šç»™ç½‘ç«™ç‚¹èµçš„ä¸œè¥¿ã€‚ç»è¿‡è¿™äº›ä¸ƒä¸ƒå…«å…«çš„åŠŸèƒ½è¿­ä»£åä½ çš„ä¸€ä¸ªæ–‡ä»¶é‡Œ HTML æ ‡ç­¾å’Œ JavaScript éƒ½æœ‰äº†å‡ ç™¾è¡Œã€‚</p><p>åˆ«å†ç»§ç»­è¿™ç§ä¹±ä¸ƒå…«ç³Ÿçš„æ–¹å¼äº†ã€‚è¿™ä¸ªæŠ€å·§å¤ªç®€å•äº†æˆ‘éƒ½ä¸å¥½æ„æ€å•ç‹¬æŠŠå®ƒåˆ—å‡ºæ¥ï¼Œä½†å¤§å®¶è¿˜_çœŸçš„_å¾ˆéš¾æ‹’ç»è¿™ç§æŠŠä»£ç ä¸€å¨æ‰”ä¸Šé¡µé¢çš„å·æ‡’åšæ³•ã€‚è¿˜è¯·å„ä½åŠ¡å¿…é¿ä¹‹å¦‚ç˜Ÿç–«ã€‚å…»æˆå¥½ä¹ æƒ¯ï¼šåœ¨å¼€å§‹çš„æ—¶å€™å°±å…ˆåˆ›å»ºå¥½ä¸€ä¸ªç©ºçš„ JavaScript æ–‡ä»¶ï¼Œç„¶åç”¨ script æ ‡ç­¾å¼•å…¥å®ƒã€‚è¿™æ ·ä¸€æ¥ï¼Œä¹‹åçš„äº¤äº’ä¸å…¶ä»–å®¢æˆ·ç«¯åŠŸèƒ½ä»£ç å°±å¯ä»¥ç›´æ¥å¡«å…¥å…ˆå‰å‡†å¤‡å¥½çš„ç©ºæ–‡ä»¶é‡Œå»äº†ã€‚</p><p>æŠŠ JavaScript ä» HTML é¡µé¢ä¸­å‰¥ç¦»ä»¥åï¼ˆå¹²å‡€å¤šäº†æ˜¯ä¸æ˜¯ï¼Ÿï¼‰ï¼Œä¸‹ä¸€ä¸ªé—®é¢˜å°±æ˜¯å…³äºè¿™äº›ä»£ç çš„ç»„ç»‡å½¢å¼äº†ã€‚è¿™å‡ ç™¾è¡Œ JavaScript ä¹Ÿè®¸åŠŸèƒ½æ²¡å•¥é—®é¢˜ï¼Œä½†æ˜¯å‡ ä¸ªæœˆåï¼Œä¸€æ—¦ä½ å¼€å§‹æƒ³è°ƒè¯•æˆ–æ˜¯æ”¹ç‚¹ä¸œè¥¿ï¼Œä½ å¯èƒ½ç‰¹ä¹ˆæ‰¾ä¸åˆ°æŸä¸ªå‡½æ•°åœ¨å“ªäº†ã€‚</p><p>è‹¥ä»…ä»…æŠŠä»£ç ä» HTML ä¸­å‰¥ç¦»åˆ°ä¸€ä¸ªå•ç‹¬æ–‡ä»¶ä¸­æ˜¯ä¸å¤Ÿçš„ï¼Œé‚£è¿˜èƒ½æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><h3 id="æ¡†æ¶">æ¡†æ¶ï¼</h3><p>æ˜¾ç„¶è§£å†³æ–¹æ¡ˆæ˜¯æ¡†æ¶ã€‚æŠŠæ‰€æœ‰ä¸œè¥¿ç”¨ AngularJSï¼Œæˆ– Emberï¼Œæˆ– React æˆ–å…¶ä»–å‡ ç™¾ä¸ªæ¡†æ¶ä¸­æŸä¸€ä¸ªå†™ä¸€éã€‚å“¼å“§å“¼å“§åœ°æŠŠæ•´ä¸ªç½‘ç«™é‡å†™ä¸ºä¸€ä¸ªå•é¡µåº”ç”¨ï¼Œç”¨ä¸Š MVC ä»€ä¹ˆçš„ã€‚</p><p>æˆ–è€…æ ¹æœ¬ä¸éœ€è¦ã€‚å½“ç„¶äº†ï¼Œåˆ«è¯¯ä¼šæˆ‘ï¼Œåœ¨ç¼–å†™åº”ç”¨çš„æ—¶å€™æˆ‘å–œæ¬¢ç”¨ Angularï¼Œä½†æ˜¯ä¸€ä¸ªâ€œåº”ç”¨â€å’Œä¸€ä¸ªé¡µé¢çš„äº¤äº’å¤æ‚åº¦æ˜¯æœ‰åŒºåˆ«çš„ã€‚ä¸€ä¸ªç”¨ä¸Š Ajax æŠ€æœ¯çš„äº§å“ç›®å½•é¡µå’Œ Gmail ä¹Ÿæ˜¯æœ‰åŒºåˆ«çš„ - èµ·ç å‡ åä¸‡è¡Œä»£ç çš„åŒºåˆ«ã€‚é‚£ä¹ˆï¼Œå¦‚æœä¸èµ°æ¡†æ¶è¿™æ¡è·¯çš„è¯ï¼Œè¿˜æœ‰ä»€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿ</p><h3 id="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</h3><p>è®¾è®¡æ¨¡å¼æ˜¯å¯¹â€œè¿™æ˜¯è¿‡å»äººä»¬è§£å†³é—®é¢˜çš„ä¸€ä¸ªæ–¹æ³•â€è¿™å¥è¯çš„é«˜çº§è¯´æ³•ã€‚Addy Osmani å†™è¿‡ä¸€æœ¬å…³äºæ­¤çš„å¾ˆå¥½çš„ä¹¦ï¼Œ<a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/" target="_blank" rel="noopener">å­¦ä¹  JavaScript è®¾è®¡æ¨¡å¼</a>ï¼Œå¯ä»¥å…è´¹ä¸‹è½½é˜…è¯»ã€‚æˆ‘æ¨èè¿™æœ¬ä¹¦ã€‚ä½†æ˜¯æˆ‘å¯¹å®ƒï¼ˆä»¥åŠç±»ä¼¼çš„å…³äºæ­¤è®®é¢˜çš„è®¨è®ºï¼‰æœ‰ç‚¹å°çœ‹æ³•ï¼Œå› ä¸ºæœ€åä½ ä»¬å†™çš„ä»£ç å¯èƒ½å˜æˆè¿™æ ·:</p><pre><code>var c = new Car();c.startEngine();c.drive();c.soNotRealistic();</code></pre><p>å¯¹æˆ‘æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼åœ¨æŠ½è±¡å±‚é¢ä¸Šæ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†æ˜¯åœ¨_å®é™…å·¥ä½œä¸­_ï¼Œæ²¡æœ‰ä»€ä¹ˆç”¨ã€‚åœ¨å®é™…é¡¹ç›®çš„ç¯å¢ƒä¸‹ï¼ŒæŒ‘é€‰å¹¶åº”ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä»¶å¾ˆå›°éš¾çš„äº‹æƒ…ã€‚</p><h4 id="æ¨¡å—">æ¨¡å—</h4><p>åœ¨æ‰€æœ‰æˆ‘çœ‹è¿‡çš„è®¾è®¡æ¨¡å¼ä¸­ï¼Œæˆ‘è§‰å¾—æ¨¡å—æ¨¡å¼æ˜¯æœ€ç®€å•ä¹Ÿæ˜¯æœ€å®¹æ˜“åº”ç”¨åˆ°ç°æœ‰ä»£ç é‡Œçš„ã€‚</p><p>çºµè€Œè§ˆä¹‹ï¼Œæ¨¡å—æ¨¡å¼å°±æ˜¯ä¸€ç³»åˆ—ä»£ç ä¹‹å¤–åŠ äº†ä¸ªåŒ…è£…ã€‚ä½ æŠ½å–å‡ºä¸€ç³»åˆ—åŠŸèƒ½ç›¸å…³çš„ä»£ç æ‰”åˆ°ä¸€ä¸ªæ¨¡å—é‡Œï¼Œå†³å®šéœ€è¦æš´éœ²çš„éƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥æŠŠä¸€ä¸ªæ¨¡å—é‡Œçš„ä»£ç æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶é‡Œã€‚ç„¶åå»ºç«‹ä¸€ä¸ªæ˜“äºåœ¨é¡¹ç›®ä¹‹é—´å…±äº«çš„ä»£ç é»‘åŒ£ã€‚</p><p>çœ‹çœ‹è¿™ä¸ªç®€å•çš„ä¾‹å­ã€‚æ­¤å¤„çš„è¯­æ³•ä¹çœ‹å¯èƒ½æœ‰ç‚¹å¥‡æ€ªï¼Œèµ·ç æˆ‘ä¸€å¼€å§‹æ˜¯è¿™æ ·è§‰å¾—çš„ã€‚æˆ‘ä»¬å…ˆä»â€œåŒ…è£…â€éƒ¨åˆ†å¼€å§‹çœ‹ï¼Œç„¶åæˆ‘å†è§£é‡Šå…¶ä½™éƒ¨åˆ†ã€‚</p><p><img src="http://ww4.sinaimg.cn/large/9b5c8bd8jw1f0zumg7z7gj20kp05ojru.jpg"></p><p>æ¨¡å—æ¨¡å¼çš„åŒ…è£…ã€‚</p><p>åªæœ‰æˆ‘ä¸€ä¸ªäººè¢«è¿™äº›æ‹¬å·ææ™•äº†ä¹ˆï¼Ÿæˆ‘æä¸æ˜ç™½è¿™é‡Œæ˜¯å¹²å˜›çš„ï¼Œè¿™è¿˜æ˜¯åœ¨æˆ‘æ‡‚ JavaScript çš„å‰æä¸‹ã€‚å…¶å®è¿™é‡Œå¦‚æœä»é‡Œå¾€å¤–çœ‹ï¼Œå°±æ¸…æ™°å¾ˆå¤šã€‚</p><p><img src="http://ww2.sinaimg.cn/large/9b5c8bd8jw1f0zuncbxnuj20m805lgly.jpg"></p><p>æ¨¡å—çš„å†…éƒ¨åªæ˜¯ä¸ªæ™®é€šçš„å‡½æ•°ã€‚</p><p>ä»ä¸€ä¸ªç®€å•çš„å‡½æ•°å¼€å§‹ï¼Œåœ¨å…¶å†…éƒ¨å®šä¹‰è¯¥æ¨¡å—çš„å®é™…éœ€è¦æä¾›çš„ä»£ç ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/9b5c8bd8jw1f0zunvmhafj20m805ot94.jpg"></p><p>åœ†æ‹¬å·ä½¿å¾—è¿™ä¸ªå‡½æ•°è‡ªåŠ¨æ‰§è¡Œã€‚</p><p>æœ€åçš„åœ†æ‹¬å·ä¼šè®©è¯¥å‡½æ•°ç«‹å³æ‰§è¡Œã€‚æˆ‘ä»¬åœ¨å‡½æ•°é‡Œè¿”å›äº†ä»€ä¹ˆï¼Œæ¨¡å—å°±æ˜¯ä»€ä¹ˆã€‚æ­¤æ—¶æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ç©ºçš„ã€‚ä¸è¿‡æ­¤æ—¶ä¸Šå›¾é«˜äº®çš„éƒ¨åˆ†è¿˜_ä¸æ˜¯_åˆæ³•çš„ JavaScriptã€‚é‚£ä¹ˆï¼Œæ€æ ·è®©å®ƒå˜å¾—åˆæ³•å‘¢ï¼Ÿ</p><p><img src="http://ww4.sinaimg.cn/large/9b5c8bd8jw1f0zuoenvzjj20m805mdg9.jpg"></p><p>å¤–è¾¹çš„åœ†æ‹¬å·å¼€å§‹å‘åŠŸäº†ã€‚</p><p>åœ¨<code>function() { }()</code> å¤–çš„åœ†æ‹¬å·ä½¿å¾—æ­¤å¤„æˆä¸ºåˆæ³•JavaScriptã€‚ä½ è¦æ˜¯ä¸ä¿¡æˆ‘ï¼Œå°±æ‰“å¼€å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°è‡ªå·±è¾“å…¥çœ‹çœ‹ã€‚</p><p>è¿™æ ·å°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹çœ‹åˆ°çš„ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/9b5c8bd8jw1f0zuotyvzej20m808ngm7.jpg"></p><p>è¿”å›å€¼è¢«èµ‹ç»™ä¸€ä¸ªå˜é‡ã€‚</p><p>æœ€åä¸€ä»¶äº‹æ˜¯æŠŠè¿”å›å€¼èµ‹ç»™ä¸€ä¸ªå˜é‡ã€‚å°½ç®¡æˆ‘è‡ªå·±å®Œå…¨æ‡‚å¾—è¿™é‡Œï¼Œä½†æ¯æ¬¡æˆ‘çœ‹è§è¿™ç§ä»£ç æˆ‘éƒ½å¾—æš‚åœä¸€ç§’é’Ÿæ¥æé†’è‡ªå·±è¿™æ˜¯ä»€ä¹ˆé¬¼ã€‚è¯´æ¥ä¹Ÿä¸æ€•ç¾ï¼Œæˆ‘åœ¨ç¼–è¾‘å™¨é‡Œå­˜ç€è¿™æ®µç©ºæ¨¡å—ä»£ç éšæ—¶å¿«æ‰‹ç²˜è´´ã€‚</p><p>å½“æˆ‘ä»¬ç»ˆäºå¾æœäº†è¿™å¨è¯¡å¼‚çš„è¯­æ³•ä¹‹åï¼ŒçœŸæ­£çš„æ¨¡å—æ¨¡å¼ç©¶ç«Ÿé•¿å•¥æ ·å‘¢ï¼Ÿ</p><pre><code>var counterModule = (function() {  var counter = 0;  return {    incrementCounter: function () {      return counter++;    },    resetCounter: function () {      console.log(&quot;counter value prior to reset: &quot; + counter );      counter = 0;    }  };}());</code></pre><p>è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªå«åš <code>counterModule</code> çš„æ¨¡å—ã€‚å®ƒæœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œ<code>incrementCounter</code> å’Œ <code>resetCounter</code>ã€‚å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒä»¬ï¼š</p><pre><code>console.log(counterModule.getCounter()); //0counterModule.incrementCounter();console.log(counterModule.getCounter()); //1counterModule.resetCounter();console.log(counterModule.getCounter()); //0</code></pre><p>ä¸»è¦çš„æ€æƒ³å°±æ˜¯æŠŠ <code>counterModule</code> é‡Œçš„ä»£ç å¥½å¥½åœ°å°è£…èµ·æ¥ã€‚å°è£…æ˜¯è®¡ç®—æœºç§‘å­¦åŸºç¡€æ¦‚å¿µï¼Œå°†æ¥ JavaScript è¿˜ä¼šæä¾›æ›´ç®€å•çš„å°è£…æ–¹æ³•ï¼Œä¸è¿‡å°±ç°åœ¨æ¥è¯´ï¼Œæˆ‘è§‰å¾—æ¨¡å—æ¨¡å¼å·²æ˜¯ä¸ªè¶…çº§ç®€å•å’Œä½¿ç”¨çš„ç»„ç»‡ä»£ç æ–¹æ¡ˆã€‚</p><h4 id="ä¸€ä¸ªå®ç”¨çš„æ¨¡å—æ¡ˆä¾‹">ä¸€ä¸ªå®ç”¨çš„æ¨¡å—æ¡ˆä¾‹</h4><p>åæ§½å®Œç½‘ä¸Šçœ‹åˆ°çš„æ ·ä¾‹ï¼ˆä¾‹å¦‚ä¸Šé¢é‚£ä¸ª Car çš„ä¾‹å­ï¼‰ã€‚æˆ‘ä»¬ç°åœ¨éœ€è¦ç¼–å†™ä¸€ä¸ªç¬¦åˆå®é™…åœºæ™¯éœ€æ±‚çš„ç®€å•ä»£ç ã€‚é™äºæœ¬æ–‡ç¯‡å¹…ï¼Œæˆ‘ä¼šå†™å¾—å°½é‡ç®€å•ï¼Œä½†ä¼šè´´åˆä½ åœ¨é‡åˆ°å®é™… web é¡¹ç›®æ—¶çš„æƒ…å†µã€‚</p><p>å‡è®¾ä½ çš„ç½‘æ¸¸å…¬å¸æ„£å¤©å ‚ (ä»»ç²‰è«å–·)ï¼Œåœ¨ç”¨æˆ·è¦åˆ›å»ºæ¸¸æˆäººç‰©çš„æ—¶å€™éœ€è¦ä¸€ä¸ªæ³¨å†Œé¡µé¢ã€‚ä½ éœ€è¦ä¸€ä¸ªå¯ä»¥è®©ç”¨æˆ·é€‰æ‹©åå­—çš„è¡¨å•ã€‚æ„å»ºåå­—çš„è§„åˆ™æœ‰ç‚¹è¯¡å¼‚ï¼š</p><ul><li>å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´</li><li>é•¿åº¦ä¸å°äº2</li><li>å…è®¸ç©ºæ ¼ï¼Œä½†æ˜¯ä¸èƒ½æœ‰æ ‡ç‚¹</li><li>ä¸èƒ½æœ‰â€œæ•æ„Ÿâ€è¯æ±‡</li></ul><p>å…ˆå†™ä¸‹è¿™ä¸ªè¶…ç®€å•çš„è¡¨å•ã€‚</p><pre><code>&lt;html&gt;  &lt;head&gt;  &lt;/head&gt;  &lt;body&gt;    &lt;p&gt;Text would be here to describe the rules...&lt;/p&gt;    &lt;form&gt;      &lt;input type=&quot;text&quot; placeholder=&quot;Identifer&quot;&gt;      &lt;input type=&quot;submit&quot; value=&quot;Register Identifer.&quot;&gt;    &lt;/form&gt;    &lt;script src=&quot;app.js&quot;&gt;&lt;/script&gt;  &lt;/body&gt;&lt;/html&gt;</code></pre><p>é™¤äº†æˆ‘æè¿°çš„è¾“å…¥æ¡†ï¼Œè¡¨å•é‡Œè¿˜æœ‰ä¸ªæäº¤æŒ‰é’®ã€‚ç„¶åæˆ‘åŠ äº†äº›æœ‰å…³ä¸Šé¢æåˆ°çš„è§„åˆ™çš„è¯´æ˜ï¼Œå…ˆå°½é‡ä¿æŒç²¾ç®€ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç ã€‚</p><pre><code>var badWords = [&quot;kitten&quot;,&quot;puppy&quot;,&quot;beer&quot;];function hasBadWords(s) {  for(var i=0; i &lt; badwords.length; i++) {    if(s.indexof(badwords[i]) &gt;= 0) return true;  }  return false;}function validIdentifier(s) {  //æ˜¯å¦ä¸ºç©º  if(s === &quot;&quot;) return false;  //è‡³å°‘ä¸¤ä¸ªå­—ç¬¦  if(s.length === 1) return false;  //å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´  if(s.charAt(0) !== s.charAt(0).toUpperCase()) return false;  //åªå…è®¸å­—æ¯å’Œç©ºæ ¼  if(/[^a-z ]/i.test(s)) return false;  //æ²¡æœ‰æ•æ„Ÿè¯  if(hasBadWords(s)) return false;  return true;}document.getElementById(&quot;submitButton&quot;).addEventListener(&quot;click&quot;, function(e) {  var identifier = document.getElementById(&quot;identifer&quot;).value;  if(validIdentifier(identifier)) {    return true;  } else { console.log(&#39;false&#39;);    e.preventDefault();    return false;  }});</code></pre><p>ä»ä»£ç åº•éƒ¨å¼€å§‹ï¼Œä½ çœ‹åˆ°æˆ‘å†™äº†ç‚¹åŸºæœ¬çš„è·å–é¡µé¢å…ƒç´ çš„ä»£ç ï¼ˆæ²¡é”™ä¼™è®¡ä»¬è¿™é‡Œæˆ‘æ²¡æœ‰ç”¨ jQueryï¼‰ç„¶åç›‘å¬ button ä¸Šçš„ç‚¹å‡»äº‹ä»¶ã€‚æ‹¿åˆ°ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå­—æ®µç„¶åä¼ ç»™éªŒè¯å‡½æ•°ã€‚éªŒè¯çš„å†…å®¹ä¹Ÿå°±æ˜¯æˆ‘ä¹‹å‰æè¿°çš„é‚£äº›ã€‚è¿™é‡Œä»£ç è¿˜æ²¡æœ‰_å¤ª_ä¹±ï¼Œä¸è¿‡éšç€ä¹‹åéªŒè¯é€»è¾‘çš„å¢é•¿å’Œé¡µé¢äº¤äº’é€»è¾‘çš„å¢åŠ ï¼Œä»£ç ä¼šè¶Šæ¥è¶Šéš¾ä»¥ç»´æŠ¤ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠè¿™é‡Œé‡å†™ä¸ºæ¨¡å—å§ã€‚</p><p>é¦–å…ˆï¼Œåˆ›å»º game.js æ–‡ä»¶å¹¶åœ¨ index.html ä¸­ä½¿ç”¨ script æ ‡ç­¾å¼•å…¥å®ƒã€‚ç„¶åæŠŠéªŒè¯é€»è¾‘ç§»åˆ°ä¸€ä¸ªæ¨¡å—é‡Œã€‚</p><pre><code>var gameModule = (function() {  var badWords = [&quot;kitten&quot;,&quot;puppy&quot;,&quot;beer&quot;];  function hasBadWords(s) {    for(var i=0; i &lt; badwords.length; i++) {      if(s.indexof(badwords[i]) &gt;= 0) return true;    }    return false;  }  function validIdentifier(s) {    //æ˜¯å¦ä¸ºç©º    if(s === &quot;&quot;) return false;    //è‡³å°‘ä¸¤ä¸ªå­—ç¬¦    if(s.length === 1) return false;    //å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´    if(s.charAt(0) !== s.charAt(0).toUpperCase()) return false;    //åªå…è®¸å­—æ¯å’Œç©ºæ ¼    if(/[^a-z ]/i.test(s)) return false;    //æ²¡æœ‰æ•æ„Ÿè¯    if(hasBadWords(s)) return false;    return true;  }  return {    valid:validIdentifier  }}());</code></pre><p>ç°åœ¨çš„ä»£ç å’Œä¹‹å‰ç›¸æ¯”æ²¡æœ‰ç¿»å¤©è¦†åœ°çš„å·®åˆ«ï¼Œåªä¸è¿‡æ˜¯è¢«å°è£…æˆäº†ä¸€ä¸ªæœ‰ä¸€ä¸ª <code>valid</code> æ¥å£çš„ <code>gameModule</code> å˜é‡ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ app.js æ–‡ä»¶ã€‚</p><pre><code>document.getElementById(&quot;submitButton&quot;).addEventListener(&quot;click&quot;, function(e) {  var identifier = document.getElementById(&quot;identifer&quot;).value;  if(gameModule.valid(identifier)) {    return true;  } else { console.log(&#39;false&#39;);    e.preventDefault();    return false;  }});</code></pre><p>çœ‹çœ‹æˆ‘ä»¬çš„ DOM ç›‘å¬å‡½æ•°é‡Œå°‘äº†å¤šå°‘ä»£ç ã€‚æ‰€æœ‰çš„éªŒè¯é€»è¾‘ï¼ˆä¸¤ä¸ªå‡½æ•°å’Œä¸€ä¸ªæ•æ„Ÿè¯åˆ—è¡¨ï¼‰è¢«å®‰å…¨åœ°ç§»åˆ°äº†æ¨¡å—é‡Œåï¼Œè¿™é‡Œçš„ä»£ç å°±æ›´å¥½ç»´æŠ¤äº†ã€‚å¦‚æœä½ çš„ç¼–è¾‘å™¨æ”¯æŒï¼Œä½ åœ¨æ­¤å¤„è¿˜èƒ½æœ‰æ¨¡å—æ–¹æ³•åçš„ä»£ç è¡¥å…¨ã€‚</p><p>æ¨¡å—åŒ–ä¸æ˜¯ä»€ä¹ˆé«˜æ·±çš„ä¸œè¥¿ï¼Œä½†å®ƒä½¿æˆ‘ä»¬çš„ä»£ç _æ›´å¹²å‡€_ï¼Œ<em>æ›´ç®€å•</em> ï¼Œè¿™ç»å¯¹æ˜¯ä»¶å¥½äº‹ã€‚</p><h2 id="ä»£ç æ£€éªŒlinting">ä»£ç æ£€éªŒ(Linting)</h2><p>ç®€å•ç»™åˆé—»è€…è§£é‡Šä¸‹ï¼Œä»£ç æ£€éªŒè¡¨ç¤ºä½¿ç”¨æœ€ä½³å®è·µå’Œä¸€äº›é¿å…å‡ºé”™çš„è§„åˆ™å¯¹ä»£ç è¿›è¡Œæ£€æŸ¥ã€‚å¾ˆé«˜å¤§ä¸Šå¯¹ä¸å¯¹ï¼Ÿè¿™ä¹ˆå¥½çš„ä¸œè¥¿ï¼Œæˆ‘ä»¥å‰å´ä»¥ä¸ºåªæœ‰æŒ‘å‰”è¿‡å¤´çš„å¼€å‘è€…æ‰ä¼šè€ƒè™‘è¿™ä¸ªã€‚å½“ç„¶äº†ï¼Œæˆ‘æœŸæœ›è‡ªå·±å†™å‡ºè¶…æ£’çš„ä»£ç ï¼Œä½†æˆ‘ä¹Ÿéœ€è¦è…¾å‡ºæ—¶é—´ç©æ¸¸æˆã€‚å°±ç®—æˆ‘çš„ä»£ç å¤Ÿä¸ä¸ŠæŸäº›é«˜å¤§ä¸Šçš„å®Œç¾æ ‡å‡†ï¼Œä½†å®ƒèƒ½å¥½å¥½å·¥ä½œæˆ‘å°±èƒ½æ»¡æ„äº†ã€‚</p><p>ç„¶è€Œâ€¦</p><p>è®°ä¸è®°å¾—ä½ æœ‰å¤šå°‘æ¬¡é‡å‘½åäº†ä¸ªå‡½æ•°ç„¶åæé†’è‡ªå·±ä¹‹åä¸€å®šä¼šæ”¹ï¼Ÿ</p><p>è®°ä¸è®°å¾—ä½ æœ‰å¤šå°‘æ¬¡åˆ›å»ºäº†ä¸ªæœ‰ä¸¤ä¸ªå½¢å‚çš„å‡½æ•°ï¼Œå…¶å®æœ€ååªç”¨äº†ä¸€ä¸ªï¼Ÿ</p><p>è®°ä¸è®°å¾—ä½ æœ‰å¤šå°‘æ¬¡å†™è¿‡å¤šå°‘è ¢ä»£ç ï¼Ÿæˆ‘è¯´çš„æ˜¯é‚£äº›æ ¹æœ¬ä¸èƒ½å·¥ä½œçš„ï¼Œç±»ä¼¼æˆ‘æœ€çˆ±çš„ <code>fuction</code> å’Œ <code>functon</code>ã€‚</p><p>ä»£ç æ£€éªŒå°±æ˜¯è¿™æ—¶å€™ç«™å‡ºæ¥å¸®ä½ çš„ï¼é™¤äº†æˆ‘ä¹‹å¤–å¤§å®¶éƒ½çŸ¥é“ï¼Œä»£ç æ£€éªŒä¸åªæœ‰é£æ ¼çš„æœ€ä½³å®è·µï¼Œè¿˜åŒ…å«è¯­æ³•å’ŒåŸºæœ¬çš„é€»è¾‘æ£€éªŒã€‚è¿˜æœ‰ä¸€ä¸ªè®©æˆ‘ä»â€œç­‰æˆ‘æœ‰æ—¶é—´ä¸€å®šæˆ–åšçš„â€ è·³åˆ°â€œæˆ‘ä¼šè™”è¯šåœ°éµå¾ªå®ƒâ€ çš„åŸå› ï¼Œé‚£å°±æ˜¯å‡ ä¹æ‰€æœ‰ç°ä»£ç¼–è¾‘å™¨éƒ½æ”¯æŒæ­¤åŠŸèƒ½ã€‚æˆ‘ç›®å‰ç”¨çš„ç¼–è¾‘å™¨ï¼ˆ Sublime, Brackets å’Œ Visual Studio Codeï¼‰éƒ½æ”¯æŒä»£ç å®æ—¶æ£€éªŒå’Œåé¦ˆã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œä»¥ä¸‹æ˜¯ Visual Studio Code å¯¹æˆ‘ä¸€æ®µå¾ˆæŒ«çš„ä»£ç çš„æç¤ºã€‚å½“ç„¶äº†ï¼Œæˆ‘æ˜¯æ•…æ„å†™å¾—å¾ˆæŒ«çš„ã€‚</p><p><img src="http://ww4.sinaimg.cn/large/9b5c8bd8jw1f0zupgeoxdj20m80d1q40.jpg"></p><p>Visual Studio Code ä»£ç æ£€éªŒã€‚</p><p>ä¸Šå›¾ä¸­ï¼Œä½ èƒ½çœ‹åˆ° Visual Studio Code <strike>æŠ±æ€¨</strike>æˆ‘ä»£ç ä¸­çš„å‡ ä¸ªé”™è¯¯ã€‚Visual Studio Code çš„ä»£ç æ£€éªŒå™¨ï¼Œå’Œå¤§å¤šæ•°æ£€éªŒå™¨ä¸€æ ·ï¼Œå¯é…ç½®ä½ å…³å¿ƒçš„æ£€éªŒè§„åˆ™ä»¥åŠå¯¹å…¶ä¸­â€œé”™è¯¯â€ï¼ˆå¿…é¡»ä¿®æ­£ï¼‰å’Œâ€œè­¦å‘Šâ€(åˆ«å·æ‡’å•Šï¼Œæ€»è¦ä¿®å¤çš„)çš„å®šä¹‰ã€‚</p><p>å¦‚æœä½ ä¸æƒ³å®‰è£…ä»»ä½•ä¸œè¥¿ï¼Œä¹Ÿä¸æƒ³æŠ˜è…¾ç¼–è¾‘å™¨ï¼Œå¦ä¸€ç§å¥½æ–¹æ³•æ˜¯ä½¿ç”¨<a href="http://jshint.com" target="_blank" rel="noopener">JSHint.com</a>åœ¨çº¿æ£€éªŒä»£ç ã€‚JSHint å·®ä¸å¤šæ˜¯æœ€æµè¡Œçš„æ£€éªŒå™¨ï¼Œå®ƒåŸºäºå¦ä¸€ä¸ªæ£€éªŒå™¨ JSLint (è°è¯´å®ƒä»¬é•¿å¾—åƒæ¥ç€ï¼Ÿ)ã€‚JSHint çš„è¯ç”Ÿä¸€éƒ¨åˆ†åŸå› æ˜¯ç”±äº JSLint å¤ªè¿‡ä¸¥æ ¼ã€‚ä½ å¯ä»¥ç›´æ¥åœ¨ç¼–è¾‘å™¨é‡Œæˆ–æ˜¯é€šè¿‡å‘½ä»¤è¡Œä½¿ç”¨ JSHintï¼Œæœ€ç®€å•çš„ä½“éªŒæ–¹æ³•æ˜¯åœ¨å®ƒçš„ç½‘ç«™ä¸Šè¯•è¯•ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/9b5c8bd8jw1f0zuppot76j20m804w0t8.jpg"></p><p>JSHint ç½‘ç«™ã€‚</p><p>ä¹çœ‹å¯èƒ½ä¸å¤ªæ˜æ˜¾ï¼Œå…¶å®å·¦è¾¹æ˜¯åœ¨ä¸€ä¸ªåœ¨çº¿ä»£ç ç¼–è¾‘å™¨ã€‚å³è¾¹çš„æ˜¯ä¸€ä»½å¯¹å·¦è¾¹ä»£ç çš„æ£€éªŒæŠ¥å‘Šã€‚è¦çœ‹åˆ°æ£€éªŒæ•ˆæœï¼Œæœ€ç®€å•æ–¹å¼æ˜¯åœ¨ä»£ç é‡Œéšä¾¿å†™é”™ç‚¹ä»€ä¹ˆã€‚æˆ‘è¿™é‡ŒæŠŠ <code>main</code> å‡½æ•°åæ”¹æˆäº† <code>main2</code>ã€‚</p><pre><code>function main2() {  return &#39;Hello, World!&#39;;}main();</code></pre><p>é©¬ä¸Šï¼Œç½‘é¡µå°±å¯¹æ­¤ç»™æˆ‘æŠ¥äº†ä¸¤ä¸ªé”™è¯¯ã€‚æ³¨æ„äº†ï¼Œè¿™å¹¶ä¸æ˜¯è¯­æ³•é”™è¯¯ã€‚ä»£ç åœ¨è¯­æ³•ä¸Šæ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯ JSHint å‘ç°äº†ä½ å¯èƒ½å¿½è§†äº†çš„é—®é¢˜æ‰€åœ¨ï¼ˆå½“ç„¶äº†ï¼Œè¿™é‡Œä»£ç åªæœ‰5è¡Œï¼Œä½†æƒ³è±¡ä¸‹ä¸€ä¸ªå¤§æ–‡ä»¶é‡Œå‡½æ•°å®šä¹‰å’Œè°ƒç”¨ä¹‹é—´éš”äº†å¥½å¤šè¡Œçš„æ—¶å€™ï¼‰ã€‚</p><p><img src="http://ww4.sinaimg.cn/large/9b5c8bd8jw1f0zuq1qvjvj209t070wei.jpg"></p><p>JSHint é”™è¯¯ã€‚</p><p>æ¥ä¸ªæ›´çœŸå®çš„ä¾‹å­å¦‚ä½•ï¼Ÿä»¥ä¸‹çš„ä»£ç ï¼ˆå—¯ç°åœ¨æˆ‘_æ˜¯_ç”¨äº† jQueryï¼‰ï¼Œæˆ‘å†™äº†ç‚¹ç®€å•çš„ JavaScript åšè¡¨å•éªŒè¯ã€‚éƒ½æ˜¯äº›é¸¡æ¯›è’œçš®çš„ä¸œè¥¿ï¼Œä¸è¿‡ä»Šå¤©å‡ ä¹ä¸€åŠçš„ JavaScript ä»£ç åšçš„éƒ½æ˜¯è¿™äº›äº‹ï¼ˆå“¦å“¦å½“ç„¶è¿˜æœ‰åˆ›å»ºå¼¹å‡ºæ¡†ç„¶åé—®ä½ è¦ä¸è¦â€œèµâ€è¿™ä¸ªç½‘ç«™ã€‚çœŸç‰¹ä¹ˆçˆ±æ­»è¿™äº›äº†ï¼‰ã€‚è¿™äº›ä»£ç å¯ä»¥åœ¨ demo_jshint æ–‡ä»¶å¤¹çš„ app_orig.js ä¸­æ‰¾åˆ°ã€‚</p><pre><code>function validAge(x) {  return $.isNumeric(x) &amp;&amp; x &gt;= 1;}function invalidEmail(e) {  return e.indexOf(&quot;@&quot;) == -1;}$(document).ready(function() {  $(&quot;#saveForm&quot;).on(&quot;submit&quot;, function(e) {    e.preventDefault();    var name = $(&quot;#name&quot;).val();    var age = $(&quot;#age&quot;).val();    var email = $(&quot;#email&quot;).val();    badForm = false;    if(name == &quot;&quot;) badForm = true;    if(age == &quot;&quot;) badForm = true;    if(!$.isNumeric(age) || age &lt;= 0) badForm = true;    if(email == &quot;&quot;) badForm = true;    if(invalidemail(email)) badForm = true;    console.log(badform);    if (badform) alert(&#39;Bad Form!&#39;);    else {      // do something on good    }  });});</code></pre><p>å¼€å§‹æ˜¯ä¸¤ä¸ªè¾…åŠ©éªŒè¯çš„å‡½æ•°ï¼ˆå¯¹å¹´é¾„å’Œ emailï¼‰ã€‚ç„¶åæ˜¯ <code>document.ready</code> ä»£ç å—é‡Œå¯¹è¡¨å•æäº¤çš„ç›‘å¬ã€‚è·å–è¡¨å•ä¸­ä¸‰ä¸ªå­—æ®µçš„å€¼ï¼Œæ£€æŸ¥æ˜¯å¦ä¸ºç©ºï¼ˆæˆ–æ˜¯æ— æ•ˆè¾“å…¥ï¼‰ï¼Œè‹¥è¡¨å•æ— æ•ˆå°±å¼¹å‡ºè­¦å‘Šï¼Œå¦åˆ™ç»§ç»­ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­é‡Œï¼Œä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿï¼Œè¡¨å•æ²¡å˜åŒ–ï¼‰ã€‚</p><p>æ‰”åˆ° JSHint ä¸Šçœ‹çœ‹å‘ç”Ÿäº†å•¥ï¼š</p><p><img src="http://ww3.sinaimg.cn/large/9b5c8bd8jw1f0zuqkjapdj20b90s5q3x.jpg"></p><p>JSHint å¯¹æˆ‘ä»¬æ ·ä¾‹ä»£ç çš„æŠ¥é”™ã€‚</p><p>å“‡å¡å¥½å¤šä¸œè¥¿ï¼çœ‹èµ·æ¥æ˜¯ç±»ä¼¼çš„é—®é¢˜å‡ºç°äº†å¤šæ¬¡ã€‚æˆ‘å¼€å§‹ç”¨æ£€éªŒå™¨çš„æ—¶å€™è¿™ç§æƒ…å†µæŒºå¸¸è§ã€‚æˆ‘å¹¶æ²¡æœ‰å¼„å‡ºå¾ˆå¤šç§é”™è¯¯ï¼Œè€Œä»…ä»…æ˜¯åŒç§é”™è¯¯çš„é‡å¤ã€‚ç¬¬ä¸€ä¸ªéå¸¸ç®€å•â€”â€” æ£€æŸ¥ç›¸ç­‰æ—¶ä½¿ç”¨ä¸‰ç­‰å·æ›¿ä»£åŒç­‰å·ã€‚ç®€å•æ¥è¯´å°±æ˜¯ç”¨æ›´ä¸¥æ ¼çš„æ ‡å‡†æ£€æµ‹ç©ºå­—ç¬¦ä¸²ã€‚å…ˆä¿®å¤è¿™ä¸ª(demo_jshint/app_mod1.js)ã€‚</p><pre><code>function validAge(x) {  return $.isNumeric(x) &amp;&amp; x &gt;= 1;}function invalidEmail(e) {  return e.indexOf(&quot;@&quot;) == -1;}$(document).ready(function() {  $(&quot;#saveForm&quot;).on(&quot;submit&quot;, function(e) {    e.preventDefault();    var name = $(&quot;#name&quot;).val();    var age = $(&quot;#age&quot;).val();    var email = $(&quot;#email&quot;).val();    badForm = false;    if(name == &quot;&quot;) badForm = true;    if(age == &quot;&quot;) badForm = true;    if(!$.isNumeric(age) || age &lt;= 0) badForm = true;    if(email == &quot;&quot;) badForm = true;    if(invalidemail(email)) badForm = true;    console.log(badform);    if (badform) alert(&#39;Bad Form!&#39;);    else {      // do something on good    }  });});</code></pre><p>JSHint æŠ¥å‘Šå˜æˆäº†:</p><p><img src="http://ww2.sinaimg.cn/large/9b5c8bd8jw1f0zur1n2y4j20am0lb0t8.jpg"></p><p>JSHint å¯¹æˆ‘ä»¬æ ·ä¾‹ä»£ç çš„æŠ¥é”™ã€‚</p><p>ç®—æ˜¯è§£å†³äº†ã€‚ä¸‹ä¸€ä¸ªé”™è¯¯ç±»å‹æ˜¯â€œæœªå£°æ˜å˜é‡â€ã€‚çœ‹ç€æœ‰ç‚¹è¯¡å¼‚ã€‚å¦‚æœä½¿ç”¨ jQuery çš„è¯ï¼Œä½ çŸ¥é“<code>$</code> æ˜¯å­˜åœ¨çš„ã€‚<code>badForm</code> çš„é—®é¢˜å°±æ›´ç®€å•ç‚¹â€”â€”æˆ‘å¿˜è®°ç”¨ <code>var</code> å£°æ˜å®ƒäº†ã€‚é‚£æˆ‘ä»¬æ€ä¹ˆè§£å†³<code>$</code>çš„é—®é¢˜å‘¢ï¼ŸJSHint æä¾›äº†å¯¹ä»£ç è§„åˆ™æ£€éªŒæ–¹æ³•çš„é…ç½®ã€‚åœ¨ä»£ç é‡ŒåŠ ä¸Šä¸€ä¸ªæ³¨é‡Šä»¥åï¼Œæˆ‘ä»¬å‘Šè¯‰ JSHint <code>$</code> å˜é‡æ˜¯ä½œä¸ºå…¨å±€å˜é‡å¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¡¥ä¸Šè¿™ä¸ªæ³¨é‡Šï¼Œå¹¶ä¸”åŠ ä¸Šä¸¢å¤±çš„ <code>var</code> å£°æ˜ï¼ˆdemo_jshint/app_mod2.jsï¼‰ã€‚</p><pre><code>/* globals $ */function validAge(x) {  return $.isNumeric(x) &amp;&amp; x &gt;= 1;}function invalidEmail(e) {  return e.indexOf(&quot;@&quot;) == -1;}$(document).ready(function() {  $(&quot;#saveForm&quot;).on(&quot;submit&quot;, function(e) {    e.preventDefault();    var name = $(&quot;#name&quot;).val();    var age = $(&quot;#age&quot;).val();    var email = $(&quot;#email&quot;).val();    var badForm = false;    if(name == &quot;&quot;) badForm = true;    if(age == &quot;&quot;) badForm = true;    if(!$.isNumeric(age) || age &lt;= 0) badForm = true;    if(email == &quot;&quot;) badForm = true;    if(invalidemail(email)) badForm = true;    console.log(badform);    if (badform) alert(&#39;Bad Form!&#39;);    else {      // do something on good    }  });});</code></pre><p>JSHint æŠ¥å‘Šå˜æˆäº†:</p><p><img src="http://ww4.sinaimg.cn/large/9b5c8bd8jw1f0zurgx350j209204gwed.jpg"></p><p>JSHint å¯¹æˆ‘ä»¬æ ·ä¾‹ä»£ç çš„æŠ¥é”™ã€‚</p><p>å“‡å“¦ï¼å°±å¿«ç»“æŸäº†ï¼æœ€åä¸€ä¸ªé—®é¢˜æ°å¥½çš„å±•ç¤ºäº† JSHint åœ¨æç¤ºæœ€ä½³ä»£ç é£æ ¼å®è·µå’ŒæŒ‡å‡ºé”™è¯¯ä»¥å¤–çš„ç”¨é€”ã€‚è¿™é‡Œæˆ‘å¿˜äº†å†™è¿‡ä¸€ä¸ªå¤„ç†å¹´é¾„éªŒè¯çš„å‡½æ•°ã€‚ä½ çœ‹æˆ‘åˆ›å»ºäº† <code>validAge</code>ï¼Œä½†æ˜¯åœ¨è¡¨å•éªŒè¯ä»£ç åŒºåŸŸæ²¡ä½¿ç”¨å®ƒã€‚ä¹Ÿè®¸æˆ‘è¯¥åˆ äº†è¿™ä¸ªå‡½æ•° â€”â€” åæ­£ä¹Ÿåªæœ‰ä¸€è¡Œï¼Œä½†æˆ‘è§‰å¾—ç•™ä¸‹æ¥æ›´å¥½â€”â€”ä»¥å…ä»¥åéªŒè¯é€»è¾‘è¶Šæ¥è¶Šå¤æ‚ã€‚ä»¥ä¸‹å°±æ˜¯å®Œæ•´çš„ä»£ç äº†(demo_jshint/app.js)ã€‚</p><pre><code>/* globals $ */function validAge(x) {  return $.isNumeric(x) &amp;&amp; x &gt;= 1;}function invalidEmail(e) {  return e.indexOf(&quot;@&quot;) == -1;}$(document).ready(function() {  $(&quot;#saveForm&quot;).on(&quot;submit&quot;, function(e) {    e.preventDefault();    var name = $(&quot;#name&quot;).val();    var age = $(&quot;#age&quot;).val();    var email = $(&quot;#email&quot;).val();    var badForm = false;    if(name === &quot;&quot;) badForm = true;    if(age === &quot;&quot;) badForm = true;    if(!validAge(age)) badForm = true;    if(email === &quot;&quot;) badForm = true;    if(invalidEmail(email)) badForm = true;    console.log(badForm);    if(badForm) alert(&#39;Bad Form!&#39;);    else {      //do something on good    }  });});</code></pre><p>æœ€ç»ˆç‰ˆæœ¬â€œé€šè¿‡â€äº† JSHint çš„æµ‹è¯•ã€‚è™½ç„¶å®é™…ä¸Šå¹¶ä¸å®Œç¾ã€‚æ³¨æ„åˆ°æˆ‘ä¸¤ä¸ªæ£€éªŒå‡½æ•°ä¸€ä¸ªå« <code>validAge</code> ä¸€ä¸ªå« <code>invalidEmail</code> ï¼Œä¸€ä¸ªè¿”å›è‚¯å®šä¸€ä¸ªè¿”å›å¦å®šã€‚æ›´å¥½çš„åšæ³•æ˜¯ä¿æŒè¯­ä¹‰ä¸€è‡´æ€§ã€‚è¿˜æœ‰æ¯æ¬¡è¿™ä¸ªéªŒè¯å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼ŒjQuery éœ€è¦è·å–DOM ä¸­çš„ä¸‰ä¸ªå…ƒç´ ï¼Œå…¶å®å®ƒä»¬åªéœ€è¦è¢«è·å–ä¸€æ¬¡ã€‚æˆ‘åº”è¯¥åœ¨è¡¨å•æäº¤å›è°ƒå‡½æ•°å¤–åˆ›å»ºè¿™äº›å˜é‡ï¼Œæ¯æ¬¡éªŒè¯çš„æ—¶å€™é‡å¤ä½¿ç”¨ã€‚å¦‚æˆ‘æ‰€è¨€ï¼ŒJSHint ä¸æ˜¯å®Œç¾çš„ï¼Œä½†ä»£ç æœ€ç»ˆç‰ˆæœ¬ç»å¯¹æ¯”ç¬¬ä¸€ç‰ˆè¦å¥½å¾ˆå¤šï¼Œæˆ‘çš„ä¿®æ”¹ä¹Ÿæ²¡æœ‰èŠ±å¤šå°‘æ—¶é—´ã€‚</p><p>ä¸åŒç”¨é€”çš„ä»£ç æ£€éªŒå™¨æœ‰ JavaScript(<a href="http://www.jslint.com" target="_blank" rel="noopener">JSLint</a>å’Œ <a href="http://www.jshint.com" target="_blank" rel="noopener">JSHint</a>)ï¼ŒHTML(<a href="http://htmlhint.com/" target="_blank" rel="noopener">HTMLHint</a>å’Œ <a href="https://validator.w3.org/" target="_blank" rel="noopener">W3C Validator</a>)å’ŒCSS (<a href="http://csslint.net/" target="_blank" rel="noopener">CSSLint</a>)ã€‚å¦‚æœç¼–è¾‘å™¨æ”¯æŒï¼Œè€Œä½ è¿˜æ˜¯ä¸ªâ€œå‰ç«¯æ½®äººâ€ï¼Œè¿˜å¯ä»¥ç”¨ Grunt å’Œ Gulp å·¥å…·å¯¹è¿™äº›è¿›è¡Œè‡ªåŠ¨åŒ–ã€‚</p><h2 id="æµ‹è¯•">æµ‹è¯•</h2><p>æˆ‘ä¸å†™æµ‹è¯•ã€‚</p><p>æ²¡é”™ï¼Œæˆ‘è¯å°±æ’‚è¿™å„¿äº†ã€‚ä¸–ç•Œä¸ä¼šåœæ­¢è½¬åŠ¨ã€‚ä¸è¿‡ï¼Œåœ¨å¼€å‘å®¢æˆ·ç«¯é¡¹ç›®æ—¶ï¼Œæˆ‘å…¶å®_æ˜¯_å†™æµ‹è¯•çš„ï¼ˆå¥½å•¦å®é™…æ˜¯æˆ‘_å°è¯•_å»å†™æµ‹è¯•ï¼‰ï¼Œä½†æ˜¯æˆ‘çš„ä¸»è¦å·¥ä½œå†™åšå®¢ï¼Œå’Œå„ç§åŠŸèƒ½çš„æ ·ä¾‹ä»£ç ã€‚è¿™äº›ä»£ç åªä¸ºéªŒè¯æ¦‚å¿µè€ŒéæŠ•å…¥ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œå› æ­¤ä¸å†™æµ‹è¯•æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ã€‚å…¶å®ï¼Œåœ¨æˆ‘æˆä¸ºå¸ƒé“è€…å’Œä¸åšâ€œå®é™…â€å·¥ä½œä¹‹å‰ï¼Œæˆ‘ä¹Ÿæ˜¯æ•¢è¿™ä¹ˆæ”¾è¯çš„ï¼Œä¸å†™æµ‹è¯•çš„å€Ÿå£å’Œä¸ä½¿ç”¨ä»£ç æ£€éªŒå™¨ä¸€æ ·ã€‚ä¸è¿‡ä¸€äº›ç»™æ£€éªŒå™¨åŠ åˆ†çš„å› ç´ æ”¾åœ¨æµ‹è¯•ä¸Šä¹Ÿå¾ˆå¥½ç”¨ã€‚</p><p>é¦–å…ˆâ€”â€”è®¸å¤šç¼–è¾‘å™¨ä¼šä¸ºä½ è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚ä¾‹å¦‚åœ¨ Brackets ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/dschaffe/brackets-xunit" target="_blank" rel="noopener">xunit</a> æ‰©å±•ã€‚å€ŸåŠ©å®ƒä½ åªè¦åœ¨ JavaScript æ–‡ä»¶ä¸Šè°ƒå‡ºå³é”®èœå•å°±èƒ½ç”Ÿæˆæµ‹è¯•ä»£ç ï¼ˆæ”¯æŒå¤šç§æµè¡Œæµ‹è¯•æ¡†æ¶æ ¼å¼ï¼‰ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/9b5c8bd8jw1f0zus4jz8sj20m80hymy4.jpg"></p><p>xunit åˆ›å»ºçš„æµ‹è¯•ã€‚</p><p>è¯¥æ‰©å±•åŸºäºç°å­˜ä»£ç å»ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚ç”Ÿæˆçš„æµ‹è¯•ä»£ç åªæ˜¯ä¸ªæ¨¡æ¿ï¼Œä½ éœ€è¦è‡ªå·±å»å¡«å†™å…·ä½“å†…å®¹ï¼Œè¿™é¿å…äº†ä¸€äº›æ— èŠçš„é‡å¤åŠ³åŠ¨ã€‚</p><p><img src="http://ww2.sinaimg.cn/large/9b5c8bd8jw1f0zuthjkyxj20m80hxjtd.jpg"></p><p>xunit åˆ›å»ºçš„æµ‹è¯•ã€‚</p><p>å®Œæˆäº†æµ‹è¯•ç»†èŠ‚çš„å¡«å……åï¼Œè¯¥æ‰©å±•ä¼šå¸®ä½ è‡ªåŠ¨æ‰§è¡Œæµ‹è¯•ã€‚éƒ½åˆ°äº†è¿™ä»½ä¸Šäº†ï¼Œä¸å†™ä»£ç åŸºæœ¬ä¸Šå°±åªæ˜¯æ‡’äº†ã€‚</p><p><img src="http://ww2.sinaimg.cn/large/9b5c8bd8jw1f0zutuzzmij20m80l50we.jpg"></p><p>æµ‹è¯•æŠ¥å‘Šã€‚</p><p>ä½ ä¹Ÿè®¸å¬è¿‡ TDD (æµ‹è¯•é©±åŠ¨å¼€å‘)ã€‚è¯´çš„æ˜¯åœ¨å†™å…·ä½“ä»£ç ä¹‹å‰å…ˆæŠŠå•å…ƒæµ‹è¯•å†™å¥½ã€‚æœ¬è´¨ä¸Šæ˜¯æµ‹è¯•ä¸»å¯¼ä½ çš„å¼€å‘ã€‚å†™ä¸‹ä»£ç å¹¶çœ‹å®ƒé€šè¿‡æµ‹è¯•çš„æ—¶å€™ï¼Œè¿™äº›é€šè¿‡çš„æµ‹è¯•èƒ½è®©ä½ ç¡®ä¿è‡ªå·±æ²¡æœ‰èµ°é”™è·¯ã€‚</p><p>æˆ‘è§‰å¾—è¿™ä¸ªæƒ³æ³•ä¸é”™ï¼Œä¸è¿‡è®©æ‰€æœ‰äººéƒ½è¿™ä¹ˆåšçš„ç¡®æ˜¯æœ‰ç‚¹å›°éš¾ã€‚æˆ‘ä»¬å¹²è„†å…ˆä»ç®€å•ç‚¹çš„å¼€å§‹ã€‚æƒ³è±¡ä¸‹ä½ æ‰‹ä¸Šæœ‰ä¸€äº›æ®ä½ æ‰€çŸ¥åŠŸèƒ½æ­£å¸¸çš„ä»£ç ï¼Œç„¶åä½ å‘ç°äº†ä¸ª bugã€‚åœ¨ä¿®å¤å®ƒä¹‹å‰ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæµ‹è¯•å»æ£€éªŒå‡ºæ­¤ bugï¼Œä¿®å¤ bugï¼Œç„¶åè·‘è·‘æµ‹è¯•ï¼Œç¡®ä¿æ­¤åç›¸åŒçš„ bug _ä¸ä¼š_å†æ¬¡å‡ºç°ã€‚å¦‚æˆ‘æ‰€è¨€ï¼Œè¿™ä¸æ˜¯æœ€ç†æƒ³çš„å®è·µï¼Œä½†ä¹Ÿèƒ½ç®—æ˜¯æœç€ä»¥ååœ¨å¼€å‘æ‰€æœ‰é˜¶æ®µå®è·µæµ‹è¯•çš„ä¸€ä¸ªè¿‡æ¸¡ã€‚</p><p>æˆ‘ç”¨æˆ‘å†™çš„ä¸€ä¸ªç²¾ç®€æ•°å­—æ˜¾ç¤ºçš„å‡½æ•°ä½œä¸º bug çš„ä¾‹å­ã€‚109203å¯ä»¥ç²¾ç®€ä¸º109Kã€‚æ›´å¤§çš„ä¾‹å¦‚2190290è¿™æ ·çš„æ•°å¯ç²¾ç®€ä¸º2Mã€‚çœ‹ä¸‹ä»£ç ç„¶åæˆ‘ä¼šè¯´è¯´ bugã€‚</p><pre><code>var formatterModule = (function() {  function fnum(x) {    if(isNaN(x)) return x;    if(x &lt; 9999) {      return x;    }    if(x &lt; 1000000) {      return Math.round(x/1000) + &quot;K&quot;;    }    if(x &lt; 10000000) {      return (x/1000000).toFixed(2) + &quot;M&quot;;    }    if(x &lt; 1000000000) {      return Math.round((x/1000000)) + &quot;M&quot;;    }    if(x &lt; 1000000000000) {      return Math.round((x/1000000000)) + &quot;B&quot;;    }    return &quot;1T+&quot;;  }  return {    fnum:fnum  }}());</code></pre><p>ä½ é©¬ä¸Šçœ‹å‡ºé—®é¢˜äº†ï¼Ÿè¿˜æ˜¯æ”¾å¼ƒäº†ï¼Ÿå½“è¾“å…¥9999çš„æ—¶å€™ï¼Œä¼šè¿”å›10Kã€‚å°½ç®¡æ­¤ç²¾ç®€å¯èƒ½æœ‰ç”¨ï¼Œä½†ä»£ç å¯¹äºæ‰€æœ‰å°äº10Kçš„æ•°å­—åº”è¯¥ä¸€è§†åŒä»ï¼Œéƒ½è¿”å›å®ƒä»¬çš„åŸå§‹å€¼ã€‚è¿™ä¸ªä¿®æ­£å¾ˆç®€å•ï¼Œæˆ‘ä»¬æ­£å¥½å½“ä½œæ·»åŠ æµ‹è¯•çš„æœºä¼šã€‚å…³äºæµ‹è¯•æ¡†æ¶æˆ‘é€‰æ‹© <a href="http://jasmine.github.io/" target="_blank" rel="noopener">Jasmine</a>ã€‚Jasmine çš„æµ‹è¯•æ˜“äºç¼–å†™å’Œè¿è¡Œã€‚æœ€å¿«çš„ä½¿ç”¨æ–¹æ³•æ˜¯ä¸‹è½½è¿™ä¸ªåº“ã€‚è§£å‹åä½ ä¼šå‘ç° SpecRunner.html æ–‡ä»¶ã€‚æ­¤æ–‡ä»¶è´Ÿè´£å¼•å…¥æˆ‘ä»¬çš„ä»£ç ï¼Œå¼•å…¥æµ‹è¯•ï¼Œè€Œåè¿è¡Œæµ‹è¯•å’Œç”Ÿæˆæ¼‚äº®çš„æŠ¥å‘Šã€‚å®ƒä¾èµ–äºå‹ç¼©åŒ…ä¸­çš„ lib æ–‡ä»¶å¤¹ï¼Œä½ ä¸€å¼€å§‹å¯ä»¥æŠŠ SpecRunner å’Œ lib æ–‡ä»¶å¤¹ä¸€èµ·å¤åˆ¶åˆ°ä½ çš„æœåŠ¡å™¨æŸå¤„ã€‚</p><p>æ‰“å¼€ SpecRunner.html ä½ ä¼šçœ‹åˆ°ã€‚</p><pre><code>&lt;!-- include source files here... --&gt;script tags here...&lt;!-- include spec files here... --&gt;more script tags here...</code></pre><p>åœ¨ç¬¬ä¸€ä¸ªæ³¨é‡Šä¸‹ä½ éœ€è¦åˆ é™¤å·²æœ‰çš„ä»£ç ç„¶ååŠ ä¸Šä¸€ä¸ª script æ ‡ç­¾å¼•å…¥ä½ çš„ä»£ç ã€‚å¦‚æœä¸‹è½½äº†æ­¤æ–‡çš„ä»£ç ï¼Œä½ å¯ä»¥åœ¨ demo4 æ–‡ä»¶å¤¹é‡Œæ‰¾åˆ° formatter.js æ–‡ä»¶ã€‚ä¹‹åä½ è¦åŠ ä¸€ä¸ª script æ ‡ç­¾å¼•å…¥æµ‹è¯•ä»£ç ã€‚ä½ å¯èƒ½ä¹‹å‰æ²¡è§è¿‡ Jasmineï¼Œä½†ä½ çœ‹çœ‹è¿™ä¸ªæµ‹è¯•ä»£ç ï¼Œ_éå¸¸_æ˜“è¯»ï¼Œæ–°æ‰‹ä¹Ÿèƒ½æ‡‚ã€‚</p><pre><code>describe(&quot;It can format numbers nicely&quot;, function() {  it(&quot;takes 9999 and returns 9999&quot;, function() {    expect(9999).toBe(formatterModule.fnum(9999));  });});</code></pre><p>æˆ‘çš„æµ‹è¯•è¯´çš„æ˜¯å½“9999ä½œä¸ºè¾“å…¥æ—¶åº”è¯¥è¿”å›9999ã€‚åœ¨æµè§ˆå™¨é‡Œæ‰“å¼€ SpecRunner.html ä½ å°±èƒ½çœ‹åˆ°é”™è¯¯æŠ¥å‘Šã€‚</p><p><img src="http://ww4.sinaimg.cn/large/9b5c8bd8jw1f0zuu5bbhaj20m80e1q61.jpg"></p><p>æµ‹è¯•å¤±è´¥çš„æŠ¥å‘Šã€‚</p><p>ä¿®å¤èµ·æ¥å¾ˆç®€å•ã€‚æŠŠæ¡ä»¶é‡Œçš„æ•°å­—ä»9999å¢åˆ°10000:</p><pre><code>if(x &lt; 10000) {  return x;}</code></pre><p>ä¸è®ºä½•æ—¶å†è·‘æµ‹è¯•ä½ èƒ½çœ‹åˆ°ä¸€ç‰‡æ¬¢ä¹ã€‚</p><p><img src="http://ww2.sinaimg.cn/large/9b5c8bd8jw1f0zuuh4xj8j20m804y74k.jpg"></p><p>æµ‹è¯•æˆåŠŸçš„æŠ¥å‘Šã€‚</p><p>ä½ ä¼°è®¡èƒ½æƒ³å‡ºä¸€äº›ç›¸å…³æµ‹è¯•å®Œå–„è¿™å¥—æµ‹è¯•ã€‚é€šå¸¸æ¥è¯´ï¼Œç§¯æåœ°æ·»åŠ æµ‹è¯•ä»¥è¦†ç›–ä½ ä»£ç çš„å„ç§å¯èƒ½ä½¿ç”¨åœºæ™¯æ²¡æœ‰ä»»ä½•ä¸å¦¥ã€‚å…³äºæ—¥æœŸå’Œæ—¶é—´çš„ç‰›åº“ <a href="http://momentjs.com/" target="_blank" rel="noopener">Moment.js</a>ï¼Œä¸æ˜¯æˆ‘éª—ä½ ï¼Œæœ‰è¶…è¿‡äº”ä¸‡ä¸ƒåƒå¤šä¸ªæµ‹è¯•ã€‚ä½ çœŸæ²¡çœ‹é”™ï¼Œå°±æ˜¯å‡ ä¸‡ä¸ªã€‚</p><p>JavaScript æµ‹è¯•æ¡†æ¶çš„å…¶ä»–é€‰æ‹©æœ‰ <a href="https://qunitjs.com/" target="_blank" rel="noopener">QUnit</a>å’Œ <a href="http://mochajs.org/" target="_blank" rel="noopener">Mocha</a>ã€‚å’Œä»£ç æ£€éªŒä¸€æ ·ï¼Œä½ èƒ½ä½¿ç”¨ Grunt ä¹‹ç±»çš„å·¥å…·è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç”šè‡³å¯ä»¥å¾€å…¨æ ˆé ä¸€ç‚¹ï¼Œä½¿ç”¨ <a href="http://www.seleniumhq.org/" target="_blank" rel="noopener">Selenium</a> æµ‹è¯•æµè§ˆå™¨ã€‚</p><h2 id="æµè§ˆå™¨å¼€å‘è€…å·¥å…·">æµè§ˆå™¨å¼€å‘è€…å·¥å…·</h2><p>æˆ‘æåˆ°çš„æœ€åä¸€ä¸ªå·¥å…·åœ¨æµè§ˆå™¨é‡Œâ€”â€”å¼€å‘è€…å·¥å…·ã€‚ä½ èƒ½æ‰¾åˆ°è®¸å¤šå…³äºæ­¤çš„æ–‡ç« ã€æ¼”è®²å’Œè§†é¢‘ï¼Œæˆ‘äº¦ä¸éœ€èµ˜è¨€ã€‚åœ¨ä»Šå¤©æ‰€è¯´çš„æ‰€æœ‰å†…å®¹ä¸­ï¼Œè¿™ä¸€æ¡æˆ‘è®¤ä¸ºåº”è¯¥æ˜¯ web å¼€å‘è€…çš„<strong>å¿…éœ€çŸ¥è¯†</strong>ã€‚ä½ å¯ä»¥å†™å‡ºä¸èƒ½ç”¨çš„ä»£ç ï¼Œå¯ä»¥ä¸æ˜¯ä»€ä¹ˆéƒ½æ‡‚ï¼Œä½†èµ·ç è¿˜æœ‰å¼€å‘è€…å·¥å…·å¸®ä½ æ‰¾å‡ºé”™è¯¯æ‰€åœ¨ï¼Œç„¶åä½ åªéœ€è¦ google ä¸€ä¸‹é—®é¢˜å°±èƒ½è§£å†³äº†ã€‚</p><p>å†å¤šæä¸€ä¸ªå»ºè®®ï¼Œä½ ä¸è¯¥æŠŠè‡ªå·±åŠåœ¨ä¸€ä¸ªæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ä¸Šã€‚å‡ å¹´å‰æˆ‘åœ¨é¼“æ£ App Cache ï¼ˆæ²¡é”™æˆ‘å°±æ˜¯çˆ±è‡ªè™ï¼‰ï¼Œç¢°ä¸Šäº†ä¸ªåªåœ¨ Chrome ä¸‹å‡ºç°çš„é—®é¢˜ã€‚å½“æ—¶å¼€ç€å¼€å‘è€…å·¥å…·ï¼Œä½†æ˜¯æ²¡å•¥ç”¨ã€‚æˆ‘çµæœºä¸€åŠ¨ç”¨ Firefox æ‰“å¼€æˆ‘çš„ä»£ç ï¼Œä½¿ç”¨å®ƒçš„å·¥å…·è°ƒè¯•ï¼Œç„¶åæˆ‘<strong>ç«‹åˆ»</strong>å°±å‘ç°äº†é—®é¢˜æ‰€åœ¨ã€‚Firefox åˆ—å‡ºçš„å…³äºè¯·æ±‚çš„ä¿¡æ¯æ¯” Chrome å¤šã€‚æˆ‘ç”¨äº†ä¸€æ¬¡è¿™ä¸ªå·¥å…·ç«‹é©¬è§£å†³äº†é—®é¢˜ï¼ˆå¥½å§å…¶å®è¿™æ˜¯èƒ¡è¯Œçš„ï¼ŒFirefox çš„ç¡®æ˜¾å‡ºé—®é¢˜æ‰€åœ¨ä¸è¿‡æˆ‘ä¿®å¤é—®é¢˜ä¹Ÿç”¨äº†å¥½äº›æ—¶é—´ï¼‰ã€‚å¦‚æœä½ å¡åœ¨æŸä¸ªé—®é¢˜ä¸Šï¼Œä¸å¦‚è¯•è¯•æ‰“å¼€å…¶ä»–æµè§ˆå™¨çœ‹çœ‹é”™è¯¯æŠ¥å‘Šæœ‰æ²¡æœ‰å¤šè¯´äº›ä»€ä¹ˆã€‚</p><p>ä¸‡ä¸€ä¸‡ä¸€ä½ çœŸä»æ²¡_è§_è¿‡å¼€å‘è€…å·¥å…·ï¼Œä»¥ä¸‹æœ‰äº›ä¸»æµæµè§ˆå™¨å·¥å…·é˜…è§ˆæŒ‡å—å’Œæå¥½çš„è¯¦ç»†æ•™ç¨‹ã€‚</p><h3 id="google-chrome">Google Chrome</h3><p>ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„æ±‰å ¡èœå•å›¾æ ‡ï¼Œé€‰æ‹©â€œæ›´å¤šå·¥å…·â€ -&gt; â€œå¼€å‘è€…å·¥å…·â€ã€‚ä¹Ÿå¯ä»¥ç”¨é”®ç›˜å¿«æ·é”®æ‰“å¼€ï¼Œä¾‹å¦‚åœ¨ OSX ä¸‹å¿«æ·é”®æ˜¯ <code>CMD+SHIFT+C</code>ã€‚å…³äºè°·æ­Œçš„å¼€å‘è€…å·¥å…·æ–‡æ¡£å¯åˆ° <a href="https://developer.chrome.com/devtools" target="_blank" rel="noopener">Chrome å¼€å‘è€…å·¥å…·çºµè§ˆ</a>å¯»æ‰¾ã€‚</p><h3 id="mozilla-firefox">Mozilla Firefox</h3><p>åœ¨ä¸»èœå•çš„â€œå·¥å…·â€æ é‡Œï¼Œé€‰æ‹© â€œWeb å¼€å‘è€…â€ -&gt; â€œåˆ‡æ¢å·¥å…·ç®±â€ã€‚Firefox å·¥å…·æ å¾ˆé…·ï¼Œåœ¨åŒä¸€èœå•ä¸‹ï¼Œæœ‰è®¸å¤šå¿«é€Ÿæ‰“å¼€å¼€å‘è€…å·¥å…·å‘½ä»¤ã€‚è¯¦æƒ…è¯·è§ <a href="https://developer.mozilla.org/en-US/docs/Tools" target="_blank" rel="noopener">Firefox å¼€å‘è€…å·¥å…·</a></p><h3 id="apple-safari-ä¼ è¯´ä¸­ç”¨æ¥çœ‹-apple-keynotes-çš„æµè§ˆå™¨">Apple Safari (ä¼ è¯´ä¸­ç”¨æ¥çœ‹ Apple keynotes çš„æµè§ˆå™¨)</h3><p>ä½ å¾—å…ˆå¼€å¯â€œå¼€å‘â€èœå•æ‰èƒ½ä½¿ç”¨å¼€å‘è€…å·¥å…·ã€‚è¿›å…¥ Safari åå¥½è®¾ç½®ï¼Œé€‰æ‹©â€œé«˜çº§â€ï¼Œé€‰ä¸­â€œåœ¨èœå•æ ä¸­æ˜¾ç¤ºâ€™å¼€å‘â€™èœå•â€ã€‚ç„¶åå°±èƒ½ä»â€œå¼€å‘èœå•â€é‡Œé€šè¿‡â€œæ˜¾ç¤º Web æ£€æŸ¥å™¨â€ï¼ˆæˆ–è€…å…¶ä¸‹çš„å…¶ä»–ä¸‰ä¸ªèœå•é¡¹ï¼‰æ‰“å¼€å·¥å…·ã€‚è¯¦æƒ…è§<a href="https://developer.apple.com/library/safari/documentation/AppleApplications/Conceptual/Safari_Developer_Guide/Introduction/Introduction.html" target="_blank" rel="noopener">å…³äº Safari Web æ£€æŸ¥å™¨</a>ã€‚</p><h3 id="internet-explorer">Internet Explorer</h3><p>ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„è®¾ç½®æŒ‰é’®æˆ–æŒ‰ä¸‹é”®ç›˜ F12é”®æ‰“å¼€å¼€å‘è€…å·¥å…·ã€‚è¯¦æƒ…è§<a href="https://msdn.microsoft.com/library/bg182326%28v=vs.85%29" target="_blank" rel="noopener">ä½¿ç”¨ F12 å¼€å‘è€…å·¥å…·</a>ã€‚</p><h2 id="æ›´å¤šå­¦ä¹ ">æ›´å¤šå­¦ä¹ </h2><p>æœ‰æ—¶å€™æ„Ÿè§‰åƒæˆ‘ä»¬è¿™äº›åšå¼€å‘çš„ï¼Œå·¥ä½œå°±ä»æ¥æ²¡æœ‰å®Œæˆçš„æ—¶å€™ã€‚ä½ çŸ¥é“åœ¨è¿™ç¯‡æ–‡ç« å†™ä½œæœŸé—´æœ‰13ä¸ªæ–°çš„ JavaScript æ¡†æ¶å‘å¸ƒäº†ä¹ˆï¼Ÿè®²çœŸï¼ä»¥ä¸‹æ˜¯æœ€åå‡ ä¸ªè®©ä½ å­¦ä¹ å¹¶ä¸”è·Ÿä¸Šæ½®æµçš„å»ºè®®ï¼Œå°½é‡è·Ÿä¸Šã€‚</p><p>å­¦ä¹ æ–¹é¢ï¼Œæˆ‘é€‰æ‹©ä¸“æ³¨äº <a href="http://developer.mozilla.org" target="_blank" rel="noopener">Mozilla Developer Network</a>(ä½ è¦æ˜¯å‡†å¤‡ google ä»€ä¹ˆï¼Œæœ€å¥½åŠ ä¸Š â€œmdnâ€ ä½œä¸ºå‰ç¼€)ï¼Œ<a href="http://www.codeschool.com" target="_blank" rel="noopener">CodeSchool</a> (ä¸€ä¸ªå•†ä¸šçš„ç¼–ç¨‹å­¦ä¹ è§†é¢‘ç½‘ç«™ï¼Œå†…å®¹è¿˜ä¸é”™), å’Œ <a href="https://www.khanacademy.org/" target="_blank" rel="noopener">Khan Academy</a>ã€‚ç‰¹åˆ«è¦è¯´ä¸‹ Mozilla å¼€å‘è€…ç½‘ç»œ(MDN)ï¼Œå¤šå¹´æ¥æˆ‘ä»¥ä¸ºå®ƒåªæœ‰ Netscape/Firefox çŸ¥è¯†è€Œå¿½è§†äº†å®ƒï¼Œè ¢æ­»äº†æˆ‘ã€‚</p><p>å¦ä¸€å»ºè®®æ˜¯å¤šè¯»ä»£ç ï¼ä½ ä»¬ä¸­è®¸å¤šäººéƒ½ç”¨è¿‡ jQueryï¼Œä½†ä½ æœ‰æ‰“å¼€å®ƒçš„æºç çœ‹çœ‹å®ƒçš„å®ç°ä¹ˆï¼Ÿè¯»åˆ«äººçš„ä»£ç æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ æŠ€å·§çš„å’Œæ–¹æ³•çš„é€”å¾„ã€‚è¿˜æœ‰ä¸€ä¸ªå¬èµ·æ¥å¯èƒ½æœ‰ç‚¹ææ€–ï¼Œä¸è¿‡æˆ‘çœŸçš„å¼ºçƒˆå»ºè®®ä½ åˆ†äº«è‡ªå·±çš„ä»£ç ã€‚ä¸å…‰æ˜¯å¤šäº†åŒé›ªäº®çš„çœ¼ç›ï¼ˆæˆ–è€…æˆåƒä¸Šä¸‡åŒï¼‰æ¥å®¡è§†ä½ çš„ä»£ç ï¼Œä½ ä¹Ÿè®¸ä¹Ÿèƒ½å¸®åŠ©å…¶ä»–çš„äººã€‚å‡ å¹´å‰æˆ‘çœ‹è§ä¸€ä¸ªåˆçº§ç¨‹åºå‘˜åˆ†äº«ä»–çš„ä»£ç ï¼Œè™½ç„¶é‡Œé¢æœ‰äº›èœé¸Ÿçº§çš„é”™è¯¯ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›è¶…æ£’çš„æŠ€å·§ã€‚</p><p>ä¸ºè·å–æœ€æ–°èµ„è®¯ï¼Œæˆ‘è®¢é˜…äº† <a href="http://cooperpress.com" target="_blank" rel="noopener">Cooper Press</a> å‘è¡Œçš„ä¸€ç³»åˆ—å‘¨æŠ¥ã€‚æœ‰ HTML çš„ï¼ŒJavaScript çš„ï¼ŒNode çš„å’Œç§»åŠ¨å¼€å‘(Mobile) å’Œå…¶ä»–ä¸€ç³»åˆ—ã€‚ä¿¡æ¯å¯èƒ½ä¼šæ·¹æ²¡ä½ ï¼Œå°½ä½ æ‰€èƒ½é˜…è¯»å°±è¡Œã€‚å½“æˆ‘çœ‹åˆ°æŸä¸ªæ–°å‘å¸ƒçš„å·¥å…·æœ‰æˆ‘_å¹¶ä¸_éœ€è¦çš„ XXX åŠŸèƒ½çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿä¸ç”¨å»å­¦å®ƒã€‚æˆ‘åªè¦è®°ä½â€œè¯¶å“Ÿæœ‰ä¸ªå·¥å…·æœ‰ XXX åŠŸèƒ½â€ï¼Œä»¥åæˆ‘éœ€è¦è¿™ä¸ªåŠŸèƒ½çš„æ—¶å€™å†å»å­¦ä¹ ã€‚</p>]]></content>
    
    <summary type="html">
    
      æˆä¸ºä¸€ä¸ªæ›´å¥½çš„ Javascript å¼€å‘è€…ã€‚ä»£ç ç»„ç»‡ï¼ŒLintingï¼Œæµ‹è¯•ã€‚
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Javascript" scheme="http://hikerpig.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>Test FileReader methods</title>
    <link href="http://hikerpig.github.io/2015/07/11/2015-07-11-Test-FileReader-methods/"/>
    <id>http://hikerpig.github.io/2015/07/11/2015-07-11-Test-FileReader-methods/</id>
    <published>2015-07-10T16:00:00.000Z</published>
    <updated>2018-08-26T08:53:15.111Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦ç”¨æµè§ˆå™¨è¯»å–å›¾ç‰‡åœ¨å‰ç«¯ç¼©ç•¥æ˜¾ç¤ºå¹¶ä¸”æ ¹æ®æ–‡ä»¶ä¿¡æ¯æ’åºã€‚</p><p>æœ€è¿‘jsperfæŒ‚äº†, V2è¿˜åœ¨å¼€å‘ä¸å¤ªå¥½ç”¨, ç°åœ¨è¿™é‡Œå­˜ä¸ªæ¡£ã€‚</p><h2 id="ä½¿ç”¨benchmark.jsæµ‹è¯•æ€§èƒ½">ä½¿ç”¨Benchmark.jsæµ‹è¯•æ€§èƒ½</h2><p>å†™ä¸€ä¸ªå°é¡µé¢æµ‹è¯•ä¸¤ç§æ–¹æ³•é€Ÿåº¦:</p><pre><code class="hljs javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-keyword">var</span> suite = <span class="hljs-literal">null</span>;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readFile</span>(<span class="hljs-params">file, method, deferred</span>) </span>&#123;    <span class="hljs-keyword">var</span> fr = <span class="hljs-keyword">new</span> FileReader();    fr[method](file);    fr.onloadend = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;      deferred.resolve();    &#125;  &#125;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runSuite</span>(<span class="hljs-params">file</span>) </span>&#123;    suite = <span class="hljs-keyword">new</span> Benchmark.Suite(&#123;      <span class="hljs-attr">name</span>: <span class="hljs-string">'FileReader perf'</span>    &#125;);    suite      .add(<span class="hljs-string">'FileReader.readAsArrayBuffer'</span>, &#123;        <span class="hljs-attr">defer</span>: <span class="hljs-literal">true</span>,        <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">deferred</span>) </span>&#123;          readFile(file, <span class="hljs-string">'readAsArrayBuffer'</span>, deferred);        &#125;      &#125;)      .add(<span class="hljs-string">'FileReader.readAsDataURL'</span>, &#123;        <span class="hljs-attr">defer</span>: <span class="hljs-literal">true</span>,        <span class="hljs-attr">fn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">deferred</span>) </span>&#123;          readFile(file, <span class="hljs-string">'readAsDataURL'</span>, deferred);        &#125;      &#125;)      .on(<span class="hljs-string">'complete'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>&#123;        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'completed'</span>);        <span class="hljs-keyword">this</span>.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bench</span>) </span>&#123;          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Bench: '</span>, bench.name);          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Hz: '</span>, bench.hz);        &#125;);      &#125;)      .run();  &#125;  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onFileChage</span>(<span class="hljs-params">e</span>) </span>&#123;    <span class="hljs-keyword">var</span> file = e.target.files[<span class="hljs-number">0</span>];    runSuite(file);  &#125;  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'fileinput'</span>).addEventListener(<span class="hljs-string">'change'</span>, onFileChage);&#125;)();</code></pre><h2 id="ç»“æœ">ç»“æœ</h2><p>åœ¨æˆ‘çš„MBPä¸Šæµ‹è¯•:</p><pre><code class="hljs text">== Firefox 39.0 ==&quot;Bench: &quot; &quot;FileReader.readAsArrayBuffer&quot;&quot;Hz: &quot; 2852.075550774104&quot;Bench: &quot; &quot;FileReader.readAsDataURL&quot;&quot;Hz: &quot; 967.485735798381== Chrome 43.0 ==Bench:  FileReader.readAsArrayBufferHz:  221.9625071172418Bench:  FileReader.readAsDataURLHz:  206.2738933937363</code></pre>]]></content>
    
    <summary type="html">
    
      æµ‹è¯•FileReaderä¸¤ä¸ªæ–¹æ³•çš„é€Ÿåº¦
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Test" scheme="http://hikerpig.github.io/tags/Test/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨pythonç¼–å†™vimè„šæœ¬ å¯¹é½èµ‹å€¼è¯­å¥</title>
    <link href="http://hikerpig.github.io/2015/04/16/2015-04-16-Align-your-assignment-sentence-using-Python-in-Vim/"/>
    <id>http://hikerpig.github.io/2015/04/16/2015-04-16-Align-your-assignment-sentence-using-Python-in-Vim/</id>
    <published>2015-04-15T16:00:00.000Z</published>
    <updated>2018-08-26T08:53:25.243Z</updated>
    
    <content type="html"><![CDATA[<p>JSerä»¬ï¼Œä¸ç®¡æ˜¯å‰åç«¯ï¼Œæ–‡ä»¶å¤´çš„dependencyéƒ¨åˆ†å †ç§¯äº†ä¸€ç¾¤çŠ¬ç‰™äº¤é”™çš„requireè¯­å¥çš„æ—¶å€™ï¼Œå†…å¿ƒæœ‰æ²¡æœ‰è¿‡ä¸€ä¸ªå†²åŠ¨æŠŠå®ƒä»¬å…¨éƒ½æ‹ä¸€éå…¨å¯¹é½äº†ï¼å„ç§foramtterç»™å¹³æ—¥çš„çœ¼å‡€å¿ƒé™è´¡çŒ®äº†ä¸å°‘åŠ›é‡ï¼Œä¸è¿‡æˆ‘å°è±¡ä¸­ST,VIM,Webstormå¥½åƒéƒ½æ²¡æœ‰è¿™ä¹ˆä¸ªæ’ä»¶ï¼Œå¹²è„†è‡ªå·±å†™ä¸€ä¸ªå§ã€‚</p><h3 id="éœ€æ±‚">éœ€æ±‚</h3><ul><li>ä»¥ç­‰å·å¯¹é½requireè¯­å¥</li></ul><h3 id="é™„åŠ éœ€æ±‚">é™„åŠ éœ€æ±‚</h3><ul><li>ä»¥ç­‰å·æˆ–å†’å·å¯¹é½è¯­å¥</li></ul><p>å¹³æ—¶VIMç”¨çš„æ¯”è¾ƒå¤šï¼Œå…ˆä¸‹æ‰‹è¿™ä¸ªã€‚</p><p>VIMæœ‰è‡ªå·±å¼ºå¤§çš„DSLæ’ä»¶è¯­è¨€vimscriptï¼Œ ä¸è¿‡å„ç§ä¸œè¥¿çš„å­¦ä¹ æ›²çº¿çœŸçš„æ˜¯â€¦ ( %&gt;_&lt;% )ï¼ŒæŠ˜è…¾äº†ä¸€ä¸‹å‘ç°æœ€å…³é”®çš„æ­£åˆ™æ¨¡å—æˆ‘æ²¡ææ¸…æ¥šã€‚</p><p>æƒ³æƒ³è¿™ä¸ªéœ€æ±‚å¾ˆç®€å•ï¼Œä¹Ÿä¸éœ€è¦è·Ÿç¼–è¾‘å™¨åšå¾ˆå¤šäº¤äº’ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨ä¸€ä¸ªé¡ºæ‰‹çš„è¯­è¨€å®ç°å§ã€‚</p><p>VIMå…·æœ‰lua, tcl, perl, ruby, pythonçš„ç¼–ç¨‹æ¥å£ï¼Œæˆ‘å°±å†³å®šç”¨pythonäº†ï¼Œå…·ä½“æ¥å£å†…å®¹å¯ä»¥çœ‹æ–‡æ¡£:</p><pre><code class="hljs vim">:<span class="hljs-keyword">help</span> if_pyth.txt</code></pre><p>æ¯”è¾ƒå…³é”®çš„å‡ ä¸ªå¯¹è±¡æ˜¯:</p><ul><li><code>vim.current.buffer</code> å½“å‰ç¼“å†²åŒº(ä¹Ÿå¯ä»¥ç†è§£æ˜¯å­˜åœ¨å†…å­˜é‡Œçš„å½“å‰ç¼–è¾‘æ–‡ä»¶å†…å®¹)</li><li><code>vim.current.buffer.mark</code> è·å–å½“å‰ç¼“å†²åŒºçš„æŸä¸ªmarkä¿¡æ¯, ä¸‹é¢æˆ‘ä½¿ç”¨çš„mark(â€˜&lt;â€™)å’Œmark(â€˜&gt;â€™)æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„,ä¸Šä¸€æ¬¡visual selectionçš„èµ·æ­¢ä½ç½®</li><li><code>vim.current.window.cursor</code> å½“å‰çª—å£ä¸‹è¾“å…¥å…‰æ ‡æ‰€åœ¨ä½ç½®</li></ul><pre><code class="hljs python">if exists("g:loaded_require_formatter")  finishendiflet g:loaded_require_formatter = 1"Function: :format"Desc: align the require statement"func! s:format()python &lt;&lt; EOFimport vimimport re# preparebuffer = vim.current.bufferrequire_pattern = re.compile(r'(?P&lt;left&gt;\s*[\w\d_]+\s?)=\s*require(?P&lt;right&gt;[\w\d\"\'\s\(\)\-\/]+)')assign_pattern = re.compile(r'(?P&lt;left&gt;\s*[\w\d_]+\s?)[=:]\s*(?P&lt;right&gt;[\w\d\"\'\s\(\)\-\/]+)')g_pattern = require_patterng_matches = []g_seperator = '='vst = 0vend = 0start_mark = buffer.mark('&lt;')end_mark = buffer.mark('&gt;')if start_mark:  vst = start_mark[0] - 1if end_mark:  vst = end_mark[0]cursor = vim.current.window.cursorcend = cursor[0]lines = buffer[0:]g_start_line = 0if vst and vend:  if vend == cend:    lines = buffer[vst:vend]    g_start_line = vst    g_pattern = assign_pattern    g_seperator = re.compile('[=:]')    #print 'vstart is', vst    #print 'vend is', vend    #print linesdef get_formated_line(text, left_len, seperator='='):    """    :text: &#123;str&#125;    :left_len: &#123;int&#125;    :returns: &#123;str&#125;    """    if hasattr(seperator, 'match'):      match = seperator.search(text)      if match:        epos = match.start()      else:        return text    else:      epos = text.find(seperator)    left_str = text[0:epos]    remained = text[epos:]    short_of_len = left_len - len(left_str)    if short_of_len &gt; 0:        to_append = []        for i in range(0, short_of_len):            to_append.append(' ')        to_append = ''.join(to_append)        text = left_str + to_append + remained    return textdef start(lines):    max_left_len = 0    matched_linenos = []    for i, line in enumerate(lines):        matches = g_pattern.match(line)        if matches:            matched_linenos.append(i)            g_matches.append(matches)            gp_dict = matches.groupdict()            left = gp_dict.get('left')            if not left[-1] == ' ':              left += ' '            left_len = len(left)            max_left_len = max(max_left_len, left_len)    for i in matched_linenos:        line = lines[i]        fl = get_formated_line(line, max_left_len, seperator=g_seperator)        #print "formed_line is ", fl        # replace the line        real_lineno = i + g_start_line        del buffer[real_lineno]        buffer.append(fl, real_lineno)# starttry:  start(lines)except Exception as exp:  print expEOFendfunc" change this map if it conflicts with othersmap &lt;C-e&gt; :echo &lt;SID&gt;format()&lt;CR&gt;" å¤„äºvisualæ¨¡å¼çš„æ—¶å€™ä¼šæŠ¥range not allowedçš„é”™," vmapçš„æ—¶å€™å…ˆé€€å‡ºvæ¨¡å¼"vmap &lt;C-e&gt; &lt;Esc&gt;:echo &lt;SID&gt;format()&lt;CR&gt;</code></pre><p>è¿™æ ·åœ¨normalå’Œvisualæ¨¡å¼ä¸‹éƒ½å¯ä»¥è½»æ¾å¯¹é½äº†ã€‚</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="http://hi.baidu.com/bluebanboom/item/439c23626237072769105b29" target="_blank" rel="noopener">Python in Vim</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;JSerä»¬ï¼Œä¸ç®¡æ˜¯å‰åç«¯ï¼Œæ–‡ä»¶å¤´çš„dependencyéƒ¨åˆ†å †ç§¯äº†ä¸€ç¾¤çŠ¬ç‰™äº¤é”™çš„requireè¯­å¥çš„æ—¶å€™ï¼Œå†…å¿ƒæœ‰æ²¡æœ‰è¿‡ä¸€ä¸ªå†²åŠ¨æŠŠå®ƒä»¬å…¨éƒ½æ‹ä¸€éå…¨å¯¹é½äº†ï¼å„ç§foramtterç»™å¹³æ—¥çš„çœ¼å‡€å¿ƒé™è´¡çŒ®äº†ä¸å°‘åŠ›é‡ï¼Œä¸è¿‡æˆ‘å°è±¡ä¸­ST,VIM,Webstormå¥½åƒéƒ½æ²¡æœ‰è¿™ä¹ˆä¸ªæ’ä»¶ï¼Œå¹²è„†è‡ª
      
    
    </summary>
    
      <category term="ç©å…·" scheme="http://hikerpig.github.io/categories/%E7%8E%A9%E5%85%B7/"/>
    
    
      <category term="VIM" scheme="http://hikerpig.github.io/tags/VIM/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨Tagbaråœ¨VIMä¸­æŸ¥çœ‹scssæ–‡ä»¶ä»£ç ç»“æ„</title>
    <link href="http://hikerpig.github.io/2015/02/05/2015-02-05-show-scss-code-outline-with-Tagbar/"/>
    <id>http://hikerpig.github.io/2015/02/05/2015-02-05-show-scss-code-outline-with-Tagbar/</id>
    <published>2015-02-04T16:00:00.000Z</published>
    <updated>2018-08-26T08:53:32.420Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<code>~/.ctags</code>é‡ŒåŠ ä¸Šè¿™å‡ è¡Œå®šä¹‰ä¸‹scssæ–‡ä»¶çš„è§„åˆ™:</p><pre><code class="hljs text">--langdef=scss--langmap=scss:.scss--regex-scss=/^[ \t]*([^\t &#123;&#125;][^&#123;&#125;]&#123;1,100&#125;)(\t| )*\&#123;/| \1/d,definition/--regex-scss=/^[@]mixin ([^ ()]+).*/\1/m,mixin/--regex-scss=/^[@]function ([^ ()]+).*/\1/f,function/&#125;--regex-scss=/^\$([A-Za-z0-9._-]+)\s?:.*/\1/v,variable/&#125;</code></pre><p>åœ¨<code>~/.vimrc</code>é‡ŒåŠ ä¸Šè¿™å‡ è¡Œ(å‰ææ˜¯VIMæœ‰å®‰è£…Tagbaræ’ä»¶å“¦)</p><pre><code class="hljs vim"><span class="hljs-keyword">let</span> <span class="hljs-variable">g:tagbar_type_scss</span> = &#123;  \ <span class="hljs-string">'ctagsbin'</span>     : <span class="hljs-string">'ctags'</span>,  \ <span class="hljs-string">'ctagstype'</span>     : <span class="hljs-string">'scss'</span>,  \ <span class="hljs-string">'kinds'</span>     : [      \ <span class="hljs-string">'d:definition'</span>,      \ <span class="hljs-string">'f:functions'</span>,      \ <span class="hljs-string">'m:mixins'</span>,      \ <span class="hljs-string">'v:variables'</span>,  \ ],\ &#125;</code></pre><p>å†™æ­£åˆ™çœŸæ˜¯è¶Šæ¥è¶Šå¥½ç©äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨&lt;code&gt;~/.ctags&lt;/code&gt;é‡ŒåŠ ä¸Šè¿™å‡ è¡Œå®šä¹‰ä¸‹scssæ–‡ä»¶çš„è§„åˆ™:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs text&quot;&gt;--langdef=scss
--langmap=scss:.scss
--regex-scss=/^[ \t]*([^\t
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="CSS" scheme="http://hikerpig.github.io/tags/CSS/"/>
    
      <category term="VIM" scheme="http://hikerpig.github.io/tags/VIM/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ JS å†™ç®€å•çš„ CSS Parser</title>
    <link href="http://hikerpig.github.io/2015/02/02/2015-02-02-simple-css-parser-with-js/"/>
    <id>http://hikerpig.github.io/2015/02/02/2015-02-02-simple-css-parser-with-js/</id>
    <published>2015-02-01T16:00:00.000Z</published>
    <updated>2018-09-11T05:18:33.305Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–è§„åˆ™">ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–è§„åˆ™</h2><p><a href="https://medium.com/jotform-form-builder/writing-a-css-parser-in-javascript-3ecaa1719a43" target="_blank" rel="noopener">JotFormå›¢é˜Ÿçš„ä¸€ç¯‡æ–‡ç« </a></p><pre><code class="hljs js">([\\s\\S]*?)&#123;([\\s\\S]*?)&#125;</code></pre><p>åˆ†è§£ä¸€ä¸‹</p><pre><code class="hljs js">([\\s\\S]*?) =&gt; any string <span class="hljs-keyword">as</span> selector&#123; =&gt; then an opening bracket([\\s\\S]*?) =&gt; any string <span class="hljs-keyword">as</span> CSS rules&#125; =&gt; then a closing bracket</code></pre><p>è¾“å…¥è¿™ä¸ªcssæ–‡æœ¬:</p><pre><code class="hljs css"><span class="hljs-selector-class">.someClass</span> &#123;  <span class="hljs-attribute">margin </span>: <span class="hljs-number">20px</span>;&#125;</code></pre><p>å¾—åˆ°ç»“æœæ˜¯è¿™æ ·:</p><pre><code class="hljs js">[  &#123;    <span class="hljs-string">"selector"</span> : <span class="hljs-string">".someClass"</span>,    <span class="hljs-string">"rules"</span> : [      &#123;        <span class="hljs-string">"directive"</span> : <span class="hljs-string">"margin"</span>,        <span class="hljs-string">"value"</span> : <span class="hljs-string">"20px"</span>      &#125;    ]  &#125;]</code></pre><p>å¥½å§å…¶å®æ²¡é‚£ä¹ˆå®¹æ˜“, ä¾‹å¦‚Media Queryå°±æ²¡è€ƒè™‘åˆ°å§</p><pre><code class="hljs js">((\\s*?@media[\\s\\S]*?)&#123;([\\s\\S]*?)&#125;\\s*?))|(([\\s\\S]*?)&#123;([\\s\\S]*?)&#125;)</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–è§„åˆ™&quot;&gt;ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–è§„åˆ™&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.com/jotform-form-builder/writing-a-css-parser-in-javascript-3ecaa1719a43&quot; tar
      
    
    </summary>
    
      <category term="å‰ç«¯" scheme="http://hikerpig.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="CSS" scheme="http://hikerpig.github.io/tags/CSS/"/>
    
  </entry>
  
</feed>
